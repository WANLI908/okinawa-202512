<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2025 æ²–ç¹© ğŸŒº</title>
    
    <!-- LINE/FB åˆ†äº«è¨­å®š -->
    <meta property="og:title" content="2025 æ²–ç¹© ğŸŒº" />
    <meta property="og:description" content="12/25 - 12/29 äº”å¤©å››å¤œè¡Œç¨‹è¡¨ã€å¿…è²·æ¸…å–®èˆ‡è¨˜å¸³åˆ†å¸³å…¨æ”»ç•¥ï¼" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://cdn.zekkei-japan.jp/datas/images/2024/04/30/c03f51ed4ebc5e578df0cbe7501f1a9ee742df4e.jpg" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- â˜… ä¿®æ­£ï¼šFont Awesome Icons (æœ€æ–°ç‰ˆ) â˜… -->
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        /* ... (æ‚¨çš„ CSS æ¨£å¼ä¿æŒä¸è®Š) ... */
        body { font-family: 'M PLUS Rounded 1c', sans-serif; background-color: #FFF8E1; -webkit-tap-highlight-color: transparent; }
        /* ... */
    </style>

    <style>
        body { font-family: 'M PLUS Rounded 1c', sans-serif; background-color: #FFF8E1; -webkit-tap-highlight-color: transparent; }
        
        /* UI Components */
        .shisa-header { background: linear-gradient(135deg, #FFAB91 0%, #FFCC80 100%); border-radius: 0 0 30px 30px; box-shadow: 0 4px 15px rgba(255, 167, 38, 0.3); }
        .card { background: white; border-radius: 20px; border: 2px solid #FFE0B2; transition: all 0.3s; overflow: hidden; position: relative; z-index: 10; }
        .card:active { transform: scale(0.98); }
        .card-active { border-color: #FF7043; box-shadow: 0 8px 20px rgba(255, 112, 67, 0.2); transform: scale(1.01); }
        
        /* Tags */
        .tag-eat { background: #FFECB3; color: #E65100; } .tag-spot { background: #B2EBF2; color: #006064; } .tag-trans { background: #E1BEE7; color: #4A148C; } .tag-hotel { background: #DCEDC8; color: #33691E; } .tag-prep { background: #F3E5F5; color: #7B1FA2; }
        
        /* Navigation & FAB */
        .bottom-nav { background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border-top: 1px solid #FFE0B2; }
        .nav-item.active { color: #FF7043; transform: translateY(-2px); }
        .nav-item { color: #90A4AE; transition: all 0.2s; }
        .fab-btn { position: fixed; bottom: 100px; right: 20px; width: 56px; height: 56px; background-color: #4CAF50; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.3); z-index: 40; transition: transform 0.2s; }
        .fab-btn:active { transform: scale(0.9); }

        /* Scroll & Animation */
        .date-scroll, .weather-scroll { overflow-x: auto; white-space: nowrap; -ms-overflow-style: none; scrollbar-width: none; }
        .date-scroll::-webkit-scrollbar, .weather-scroll::-webkit-scrollbar { display: none; }
        .date-tab.active { background: #FF7043; color: white; border-color: #FF7043; }
        .snap-x-mandatory { scroll-snap-type: x mandatory; }
        .snap-center { scroll-snap-align: center; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .details-content { display: none; animation: slideDown 0.3s ease-out; }
        .details-content.show { display: block; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Modals */
        .modal-overlay, .detail-modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 100; display: none; align-items: flex-end; justify-content: center; }
        .detail-modal-overlay { z-index: 200; background: rgba(0,0,0,0.7); backdrop-filter: blur(3px); }
        .modal-overlay.open, .detail-modal-overlay.open { display: flex; }
        .modal-sheet { background: white; width: 100%; border-radius: 20px 20px 0 0; padding: 20px; animation: slideUp 0.3s ease-out; max-height: 90vh; overflow-y: auto; padding-bottom: 40px; }
        .detail-sheet { background: #fff; width: 100%; height: 85vh; border-radius: 24px 24px 0 0; padding: 0; display: flex; flex-direction: column; transform: translateY(100%); transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1); overflow: hidden; }
        .detail-modal-overlay.open .detail-sheet { transform: translateY(0); }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        
        /* Elements */
        .detail-header-img { width: 100%; height: 250px; object-fit: cover; }
       /* 1. ä¿®æ”¹ detail-bodyï¼šæ‹¿æ‰ paddingï¼Œè®“åœ–ç‰‡å¯ä»¥è²¼é‚Š */
        .detail-body { padding: 0; overflow-y: auto; flex: 1; -webkit-overflow-scrolling: touch; /* è®“ iOS æ²å‹•æœ‰æ…£æ€§ */}
       /* 2. æ–°å¢æ–‡å­—å®¹å™¨ï¼šæŠŠåŸæœ¬çš„å…§è·æ¬åˆ°é€™è£¡ï¼Œä¸¦é ç•™åº•éƒ¨ç©ºé–“çµ¦æŒ‰éˆ• */
        .detail-text-container {padding: 24px; padding-bottom: 24px; /* é ç•™åº•éƒ¨ç©ºé–“ï¼Œä»¥å…æœ€å¾Œä¸€è¡Œå­—è¢«ç™½è‰²æŒ‰éˆ•åˆ—æ“‹ä½ */}
        .detail-handle { width: 40px; height: 5px; background: rgba(255,255,255,0.5); border-radius: 100px; position: absolute; top: 12px; left: 50%; transform: translateX(-50%); z-index: 10; box-shadow: 0 1px 3px rgba(0,0,0,0.3); }
        .detail-close-btn { position: absolute; top: 16px; right: 16px; width: 32px; height: 32px; background: rgba(0,0,0,0.5); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; z-index: 500; }
        .ticket-box { background-image: radial-gradient(circle at 0 50%, transparent 10px, #FFF5F5 11px), radial-gradient(circle at 100% 50%, transparent 10px, #FFF5F5 11px); border: 2px dashed #FFCDD2; color: #C62828; padding: 15px 25px; border-radius: 8px; position: relative; }
        .pdf-sheet { 
    /* ...åŸæœ‰æ¨£å¼... */
    padding: 0; /* å»ºè­°æ­¸é›¶ï¼Œç”±å…§éƒ¨å…ƒç´ æ§åˆ¶é–“è· */
    /* ... */
}
.pdf-sheet { 
    background: #fff; 
    width: 100%;
    
    /* â˜… ä¿®æ”¹é€™è£¡ï¼šå¾ 95vh æ”¹æˆ 85vh (è®“è¦–çª—è®ŠçŸ®ä¸€é») */
    height: 85vh; 
    
    border-radius: 16px 16px 0 0; 
    padding: 0; 
    position: absolute; 
    bottom: 0;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    box-shadow: 0 -4px 20px rgba(0,0,0,0.2); 
    z-index: 1001; /* ç¢ºä¿å±¤ç´šå¤ é«˜ */
}


.pdf-close-btn:active {
    transform: scale(0.9);
    background: rgba(0, 0, 0, 0.8);
}
        .pdf-label { font-size: 10px; color: #666; text-transform: uppercase; margin-bottom: 2px; }
        .voucher-card { border-left: 4px solid #FF7043; }
        .sync-status { width: 8px; height: 8px; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .sync-online { background-color: #4CAF50; box-shadow: 0 0 5px #4CAF50; }
        .sync-offline { background-color: #ccc; }
        .qty-btn { width: 40px; height: 40px; background: #f3f4f6; border-radius: 8px; font-weight: bold; color: #4b5563; display: flex; align-items: center; justify-content: center; font-size: 18px; }
        .qty-btn:active { background: #e5e7eb; }
        .shop-img-box { width: 90px; height: 90px; border-radius: 4px; overflow: hidden; background: #6b7280; /* æ·±ç°è‰²é è¨­èƒŒæ™¯ */display: flex; align-items: center; justify-content: center; flex-shrink: 0; border: 1px solid #e5e7eb; position: relative;/* æ–°å¢ï¼šæ»‘é¼ ç§»ä¸Šå»è®Šæˆæ”¾å¤§é¡ */cursor: zoom-in; transition: transform 0.1s; }
        /* é»æ“Šæ™‚çš„å°å‹•ç•« */
        .shop-img-box:active { transform: scale(0.95); }
        /* å¦‚æœæ²’æœ‰åœ–ç‰‡ (åªæœ‰ç°è‰²èƒŒæ™¯)ï¼ŒæŠŠæ»‘é¼ è®Šå›é è¨­ï¼Œé¿å…èª¤æœƒ */
        .shop-img-box.no-image { cursor: default;background: #6b7280; }
        .shop-img-box.no-image:active { transform: none; }
        .shop-img-box img { width: 100%; height: 100%; object-fit: cover; }
        /* ä¿æŒä¸Šæ¬¡è¨­å®šçš„è¼¸å…¥æ¡†å¯¬åº¦ */
        .jp-price-input-clean { border: 1px solid #d1d5db; border-radius: 6px; padding: 2px 4px; width: 70px; font-size: 15px; text-align: center; color: #374151; background: white; outline: none; transition: all 0.2s; }
        .jp-price-input-clean:focus { border-color: #f97316; box-shadow: 0 0 0 2px rgba(249, 115, 22, 0.1); }
        .highlight-time { font-family: 'Courier New', monospace; font-weight: bold; color: #d97706; background: #fef3c7; padding: 2px 6px; border-radius: 4px; }
        .jp-price-input { width: 80px; padding: 4px; border: 1px solid #e5e7eb; border-radius: 4px; font-weight: bold; color: #ea580c; text-align: right; background: white; }
        /* æ–°å¢ï¼šç½®é ‚å®¹å™¨æ¨£å¼ */
.sticky-filters {
    position: sticky;
    /* â˜… é…åˆ Header é«˜åº¦ï¼Œè·Ÿè¡Œç¨‹è¡¨ä¸€æ¨£è¨­ç‚º 80px (æˆ– 84px) */
    top: 80px; 
    z-index: 40;
    
    background-color: rgba(255, 248, 225, 0.95); 
    backdrop-filter: blur(5px);
    
    /* â˜… è¨­å®šå…§è·ï¼šä¸Šä¸‹ 12px, å·¦å³ 16px (è·Ÿæ—¥æœŸé¸å–®ä¸€è‡´) */
    padding: 12px 16px; 
    
    /* â˜… é—œéµï¼šæŠŠåŸæœ¬çš„ margin-left/right è² å€¼æ‹¿æ‰ï¼Œè¨­ç‚º 0 */
    margin: 0;
    
    box-shadow: 0 4px 6px -4px rgba(0, 0, 0, 0.05);
}

/* ä¿®æ”¹ï¼šç§»é™¤åŸæœ¬çš„ marginï¼Œçµ±ä¸€ç”±å¤–å±¤ sticky-filters æ§åˆ¶é–“è· */
.filter-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0; /* æ”¹ç‚º 0 */
    gap: 8px;
}

/* ä¿æŒä¹‹å‰çš„æ¨£å¼ */
.filter-select {
    background: white;
    border: 1px solid #fed7aa;
    color: #4b5563;
    padding: 6px 10px;
    border-radius: 20px;
    font-size: 13px;
    font-weight: bold;
    outline: none;
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23f97316' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 8px center;
    background-size: 14px;
    padding-right: 28px;
    appearance: none;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}

.rate-badge {
    font-size: 12px;
    color: #ea580c;
    background: #fff7ed;
    padding: 4px 8px;
    border-radius: 6px;
    border: 1px dashed #fdba74;
    font-weight: bold;
    white-space: nowrap;
}
/* --- è¨˜å¸³åŠŸèƒ½æ–°å¢æ¨£å¼ START --- */
.split-box {
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    padding: 12px;
    margin-top: 8px;
}
.member-check {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 13px;
    background: white;
    padding: 6px 10px;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
    cursor: pointer;
}
.member-check.active {
    background: #eff6ff;
    border-color: #3b82f6;
    color: #1d4ed8;
    font-weight: bold;
}
.chart-container {
    position: relative; 
    height: 200px; 
    width: 100%;
    margin-bottom: 0px;
}
.person-card {
    background: white;
    border: 1px solid #fed7aa;
    border-radius: 12px;
    padding: 10px;
    text-align: center;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}
/* --- è¨˜å¸³åˆ†é æ¨£å¼ START --- */
.budget-tab-container {
    background: #e2e8f0;
    padding: 4px;
    border-radius: 12px;
    display: flex;
    margin-bottom: 0;
}
.budget-tab-btn {
    flex: 1;
    text-align: center;
    padding: 8px;
    border-radius: 10px;
    font-size: 14px;
    font-weight: bold;
    color: #64748b;
    transition: all 0.2s;
}
.budget-tab-btn.active {
    background: white;
    color: #f97316; /* æ©˜è‰² */
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
/* --- è¨˜å¸³åˆ†é æ¨£å¼ END --- */
/* --- æ–°å¢ï¼šåº•éƒ¨å®‰å…¨å€åŸŸ (é¿é–‹ iPhone æ©«æ¢) --- */
.safe-area-bottom {
    padding-bottom: calc(12px + env(safe-area-inset-bottom));
}

/* åº•éƒ¨å®‰å…¨å€ (å¦‚æœä¹‹å‰æ²’åŠ ï¼Œè«‹åŠ ä¸Š) */
.safe-area-bottom {
    padding-bottom: calc(12px + env(safe-area-inset-bottom));
}
/* --- æ–°å¢ï¼šæ—¥æœŸé¸å–®ç½®é ‚æ¨£å¼ --- */
.sticky-date-bar {
    position: sticky;
    top: 80px; /* é…åˆ Header é«˜åº¦ */
    z-index: 40;
    
    /* èƒŒæ™¯ç‰¹æ•ˆ */
    background-color: rgba(255, 248, 225, 0.95); 
    backdrop-filter: blur(5px);
    
    /* â˜… é€™è£¡è¨­å®šæ—¥æœŸå€å¡Šè‡ªå·±çš„ paddingï¼šä¸Šä¸‹ 12px (py-3), å·¦å³ 16px (px-4) */
    /* æˆ‘å€‘æœƒç›´æ¥å¯«åœ¨ HTML class è£¡ï¼Œæ‰€ä»¥é€™è£¡å¯ä»¥æŠŠ padding ç§»é™¤ï¼Œæˆ–æ˜¯ä¿ç•™ä½œç‚ºå‚™ç”¨ */
    
    /* â˜… é—œéµï¼šç§»é™¤åŸæœ¬æ‰€æœ‰çš„ margin è¨­å®šï¼Œå› ç‚ºæˆ‘å€‘è¦åœ¨å¤–å±¤è™•ç† */
    margin: 0;
    
    box-shadow: 0 4px 6px -4px rgba(0, 0, 0, 0.05);
}
.detail-sticky-header {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 60px; /* é«˜åº¦ */
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 400; /* æ¯”åœ–ç‰‡é«˜ï¼Œä½†æ¯”é—œé–‰æŒ‰éˆ•ä½ (é—œé–‰æŒ‰éˆ•æ˜¯ 500) */
    background-color: transparent;
    transition: all 0.3s ease; /* æ»‘é †éæ¸¡æ•ˆæœ */
    pointer-events: none; /* é è¨­ä¸æ“‹ä½ä¸‹æ–¹çš„é»æ“Š */
}

/* å°è¦½åˆ—é¡¯ç¤ºæ™‚çš„ç‹€æ…‹ (è®Šç™½åº• + é™°å½±) */
.detail-sticky-header.visible {
    background-color: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(5px);
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    pointer-events: auto;
}

/* å°è¦½åˆ—æ–‡å­— (é è¨­éš±è—) */
.detail-sticky-title {
    font-size: 16px;
    font-weight: bold;
    color: #374151;
    opacity: 0;
    transform: translateY(10px); /* ç¨å¾®å¾€ä¸‹ï¼Œä¹‹å¾Œå¾€ä¸Šæµ®ç¾ */
    transition: all 0.3s ease;
    max-width: 70%; /* é¿å…å¤ªé•·æ’åˆ°é—œé–‰æŒ‰éˆ• */
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* æ–‡å­—é¡¯ç¤ºæ™‚çš„ç‹€æ…‹ */
.detail-sticky-header.visible .detail-sticky-title {
    opacity: 1;
    transform: translateY(0);
}
    </style>
</head>
<body class="pb-24">

    <!-- Header -->
    <div class="shisa-header sticky top-0 z-50 p-4 flex justify-between items-center text-white">
        <div>
            <h1 class="text-xl font-bold flex items-center gap-2">
                2025æ²–ç¹© <span id="sync-indicator" class="sync-status sync-offline" title="é€£ç·šç‹€æ…‹"></span>
                <span id="current-role-badge" onclick="clearRole()" class="text-xs bg-white/20 px-2 py-1 rounded cursor-pointer hover:bg-white/40">åˆ‡æ›</span>
            </h1>
            <p id="header-desc" class="text-xs opacity-90 mt-1">12/25 - 12/29</p>
        </div>
        <div class="bg-white/20 backdrop-blur-sm rounded-full w-10 h-10 flex items-center justify-center text-2xl cursor-pointer shadow-sm border border-white/30" onclick="toggleDevMode()" id="header-icon">ğŸ¦</div>
    </div>

    <!-- Role Selector -->
    <div id="role-selector" class="fixed inset-0 bg-[#FFF8E1] z-[60] flex flex-col items-center justify-center p-6 space-y-8 hidden">
        <div class="text-center"><h2 class="text-3xl font-bold text-orange-600 mb-2">ä½ æ˜¯èª°ï¼Ÿ</h2><p class="text-gray-500">é¸æ“‡èº«ä»½ä»¥æä¾›æœ€é©åˆä½ çš„è³‡è¨Š</p></div>
        <div class="grid grid-cols-2 gap-4 w-full max-w-sm">
            <button onclick="selectRole('driver')" class="bg-white p-4 rounded-2xl shadow-lg border-2 border-orange-100 flex flex-col items-center gap-2 hover:bg-orange-50"><div class="text-4xl">ğŸš—</div><div class="font-bold text-gray-700">å¦¹å¦¹ </div></button>
            <button onclick="selectRole('copilot')" class="bg-white p-4 rounded-2xl shadow-lg border-2 border-orange-100 flex flex-col items-center gap-2 hover:bg-orange-50"><div class="text-4xl">ğŸ—ºï¸</div><div class="font-bold text-gray-700">çˆ¸çˆ¸ </div></button>
            <button onclick="selectRole('tourist')" class="bg-white p-4 rounded-2xl shadow-lg border-2 border-orange-100 flex flex-col items-center gap-2 hover:bg-orange-50"><div class="text-4xl">ğŸ“¸</div><div class="font-bold text-gray-700">åª½åª½ </div></button>
            <button onclick="selectRole('admin')" class="bg-white p-4 rounded-2xl shadow-lg border-2 border-orange-100 flex flex-col items-center gap-2 hover:bg-orange-50"><div class="text-4xl">ğŸ“</div><div class="font-bold text-gray-700">å§Šå§Š </div></button>
        </div>
    </div>

    <!-- Main Content -->
    <div id="app" class="p-4 space-y-6"></div>

    <!-- Modals -->
    <div id="modal-detail" class="detail-modal-overlay" onclick="closeDetailModal()"><div id="modal-detail-content" class="detail-sheet" onclick="event.stopPropagation()"></div></div>
    <div id="modal-pdf" class="modal-overlay" style="z-index: 1000;" onclick="closePdfModal()"><div class="pdf-sheet" onclick="event.stopPropagation()"><button onclick="closePdfModal()" class="absolute top-4 right-4 text-2xl text-gray-400 hover:text-black"><i class="fa-solid fa-xmark"></i></button><div id="pdf-content"></div></div></div>

    <!-- Shopping Modal -->
    <div id="modal-shopping" class="modal-overlay" onclick="closeModal('modal-shopping')">
        <div class="modal-sheet space-y-4" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center">
                <h3 class="text-xl font-bold text-gray-700" id="shop-modal-title">æ–°å¢å¿…è²· & æ¯”åƒ¹</h3>
                <button onclick="closeModal('modal-shopping')" class="text-gray-400"><i class="fa-solid fa-xmark text-xl"></i></button>
            </div>
            <input type="hidden" id="in-shop-key">
            <input id="in-shop-img" placeholder="åœ–ç‰‡é€£çµ URL æˆ– æª”å (é¸å¡«)" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200 text-sm">
            <div class="grid grid-cols-3 gap-2">
                <select id="in-shop-cat" class="p-3 bg-white rounded-xl border border-orange-200 font-bold text-gray-700"><option value="è—¥å¦">ğŸ’Š è—¥å¦</option><option value="é›¶é£Ÿ">ğŸª é›¶é£Ÿ</option><option value="é›»å™¨">ğŸ”Œ é›»å™¨</option><option value="è¡£ç‰©">ğŸ‘• è¡£ç‰©</option><option value="é›œè²¨">ğŸ é›œè²¨</option></select>
                <input id="in-shop-store" placeholder="å•†åº— (å¦‚: å¤§åœ‹)" class="col-span-2 p-3 bg-gray-50 rounded-xl border border-gray-200">
            </div>
            <input id="in-shop-item" placeholder="å“å (å¦‚: åˆåˆ©ä»–å‘½)" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200">
            <div class="grid grid-cols-2 gap-3 bg-blue-50 p-3 rounded-xl border border-blue-100">
                <div><label class="text-xs text-gray-500 font-bold">ğŸ‡¹ğŸ‡¼ å°ç£å”®åƒ¹</label><input id="in-shop-tw" type="number" placeholder="NT$" class="w-full p-2 bg-white rounded border border-blue-200 mt-1"></div>
                <div><label class="text-xs text-gray-500 font-bold">ğŸ‡¯ğŸ‡µ æ—¥æœ¬å”®åƒ¹</label><input id="in-shop-jp" type="number" placeholder="Â¥" class="w-full p-2 bg-white rounded border border-blue-200 mt-1"></div>
                <div class="col-span-2 text-center text-xs text-blue-500 pt-1">è¼¸å…¥æ—¥æœ¬åƒ¹æ ¼è‡ªå‹•è¨ˆç®—åŒ¯ç‡ (0.2025)</div>
            </div>
            <button onclick="saveShopItem()" class="w-full bg-pink-500 text-white font-bold py-3 rounded-xl shadow-lg mt-2">å„²å­˜</button>
        </div>
    </div>
    
    <!-- Budget Modal -->
    <div id="modal-budget" class="modal-overlay" onclick="closeModal('modal-budget')">
        <div class="modal-sheet space-y-4" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center"><h3 class="text-xl font-bold text-gray-700">è¨˜ä¸€ç­†æ”¯å‡º</h3><button onclick="closeModal('modal-budget')" class="text-gray-400"><i class="fa-solid fa-xmark text-xl"></i></button></div>
            <div class="bg-gray-50 p-2 rounded-xl border border-gray-200"><label class="text-xs text-gray-500 font-bold ml-1">æ—¥æœŸèˆ‡æ™‚é–“</label><input id="in-ex-time" type="datetime-local" class="w-full bg-transparent font-bold text-gray-700 outline-none mt-1"></div>
            <select id="in-ex-category" class="w-full p-3 bg-white rounded-xl border border-orange-200 text-gray-700 font-bold"><option value="é£Ÿç‰©">ğŸ” é£Ÿç‰©</option><option value="è³¼ç‰©">ğŸ›ï¸ è³¼ç‰©</option><option value="äº¤é€š">ğŸš— äº¤é€š</option><option value="é–€ç¥¨">ğŸ« é–€ç¥¨</option><option value="å…¶ä»–">ğŸ’¸ å…¶ä»–</option></select>
            <input id="in-ex-store" placeholder="å•†åº—/é¤å»³ (é¸å¡«)" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200">
            <input id="in-ex-item" placeholder="å“å/å…§å®¹" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200">
            <div class="grid grid-cols-2 gap-3"><input id="in-ex-price" type="number" placeholder="æ—¥å¹£å–®åƒ¹" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200"><div class="flex items-center gap-2"><button class="qty-btn" onclick="adjustQty(-1)">-</button><input id="in-ex-qty" type="number" value="1" class="w-full p-3 text-center bg-gray-50 rounded-xl border border-gray-200" readonly><button class="qty-btn" onclick="adjustQty(1)">+</button></div></div>
            <select id="in-ex-pay" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200 text-gray-700"><option value="ç¾é‡‘">ğŸ’µ ç¾é‡‘</option><option value="ä¿¡ç”¨å¡">ğŸ’³ ä¿¡ç”¨å¡</option><option value="Suica/ICå¡">ğŸ§ Suica / ICå¡</option></select>
            <div class="bg-orange-50 p-4 rounded-xl text-center border border-orange-100"><div class="text-sm text-gray-500 mb-1">ç¸½é‡‘é¡ (å–®åƒ¹ x æ•¸é‡)</div><div class="text-2xl font-bold text-orange-600">Â¥<span id="calc-total">0</span></div><div class="text-sm font-bold text-blue-500 mt-1">â‰ˆ NT$<span id="calc-twd">0</span></div></div>
            <button onclick="addExpense()" class="w-full bg-orange-500 text-white font-bold py-3 rounded-xl shadow-lg mt-2">å„²å­˜ç´€éŒ„</button>
        </div>
    </div>

   <!-- Order Card Modal (é»é¤å­—å¡) -->
    <div id="modal-order-card" class="fixed inset-0 z-[300] hidden items-center justify-center bg-black/90 backdrop-blur-sm transition-opacity" onclick="closeOrderCard()">
        <div class="bg-white w-[85%] max-w-sm rounded-3xl p-6 text-center relative shadow-2xl transform transition-all scale-100" onclick="event.stopPropagation()">
            <button onclick="closeOrderCard()" class="absolute top-4 right-4 w-8 h-8 bg-gray-100 rounded-full text-gray-500 hover:bg-gray-200 flex items-center justify-center">
                <i class="fa-solid fa-xmark"></i>
            </button>
            
            <div class="mb-2 text-xs text-orange-500 font-bold tracking-widest uppercase">Order This</div>
            
            <!-- æ—¥æ–‡ (è¶…å¤§å­—) -->
            <div id="card-jp" class="text-3xl font-bold text-gray-800 mb-4 leading-tight break-words">
                æ—¥æœ¬èªãƒ¡ãƒ‹ãƒ¥ãƒ¼
            </div>
            
            <!-- åˆ†éš”ç·š -->
            <div class="w-12 h-1 bg-gray-200 mx-auto mb-4 rounded-full"></div>
            
            <!-- ä¸­æ–‡ (è¼”åŠ©) -->
            <div id="card-cn" class="text-lg text-gray-500 font-medium">
                ä¸­æ–‡èœå–®å
            </div>
            
            <div class="mt-6 text-xs text-gray-400 bg-gray-50 py-2 rounded-lg">
                <i class="fa-solid fa-hand-point-up mr-1"></i> è«‹å°‡æ­¤ç•«é¢å‡ºç¤ºçµ¦åº—å“¡
            </div>
        </div>
    </div>

    <!-- Translation Modal -->
    <div id="trans-modal" class="fixed inset-0 bg-black/80 z-[110] hidden flex-col items-center justify-center p-6" onclick="closeTranslation()"><div class="bg-white rounded-2xl p-6 w-full max-w-sm text-center space-y-4" onclick="event.stopPropagation()"><h3 class="font-bold text-xl text-orange-600 border-b pb-2">ğŸ‡¯ğŸ‡µ å¹«æˆ‘èªªæ—¥æ–‡</h3><div class="grid grid-cols-2 gap-3"><div class="bg-gray-50 p-3 rounded-lg border text-left"><div class="text-xs text-gray-400">çµå¸³</div><div class="font-bold text-lg">ãŠä¼šè¨ˆ (Okai-kei)</div></div><div class="bg-gray-50 p-3 rounded-lg border text-left"><div class="text-xs text-gray-400">è¬è¬</div><div class="font-bold text-lg">ã‚ã‚ŠãŒã¨ã† (Arigatou)</div></div><div class="bg-gray-50 p-3 rounded-lg border text-left"><div class="text-xs text-gray-400">å»æ‰€</div><div class="font-bold text-lg">ãƒˆã‚¤ãƒ¬ (Toire)</div></div><div class="bg-gray-50 p-3 rounded-lg border text-left"><div class="text-xs text-gray-400">æ°´</div><div class="font-bold text-lg">ãŠæ°´ (Omizu)</div></div><div class="bg-gray-50 p-3 rounded-lg border text-left col-span-2"><div class="text-xs text-gray-400">ä¸å¥½æ„æ€ / è«‹å•</div><div class="font-bold text-lg">ã™ã¿ã¾ã›ã‚“ (Sumimasen)</div></div></div><button onclick="closeTranslation()" class="bg-gray-200 text-gray-700 px-8 py-3 rounded-full font-bold w-full mt-2">é—œé–‰</button></div></div>

    <!-- Navigation -->
    <div class="bottom-nav fixed bottom-0 w-full h-[80px] bg-white/95 backdrop-blur-md border-t border-orange-100 flex justify-between items-center px-4 pb-2 z-50">
        <div class="flex-1 flex justify-around items-end">
            <button onclick="switchTab('schedule')" id="btn-schedule" class="nav-item flex flex-col items-center p-2 w-14 transition active:scale-95"><i class="fa-regular fa-calendar-days text-xl mb-1"></i><span class="text-[10px] font-bold">è¡Œç¨‹</span></button>
            <button onclick="switchTab('vouchers')" id="btn-vouchers" class="nav-item flex flex-col items-center p-2 w-14 transition active:scale-95"><i class="fa-solid fa-ticket text-xl mb-1"></i><span class="text-[10px] font-bold">æ†‘è­‰</span></button>
        </div>
        <div class="relative w-20 flex justify-center z-10">
            <button onclick="switchTab('home')" id="btn-home" class="absolute -top-10 w-16 h-16 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full shadow-lg shadow-orange-200 border-4 border-[#FFF8E1] text-white flex items-center justify-center transform transition hover:scale-105 active:scale-95"><i class="fa-solid fa-house text-2xl"></i></button>
            <span class="absolute top-8 text-[10px] font-bold text-orange-500">é¦–é </span>
        </div>
        <div class="flex-1 flex justify-around items-end">
            <button onclick="switchTab('shopping')" id="btn-shopping" class="nav-item flex flex-col items-center p-2 w-14 transition active:scale-95"><i class="fa-solid fa-bag-shopping text-xl mb-1"></i><span class="text-[10px] font-bold">å¿…è²·</span></button>
            <button onclick="switchTab('budget')" id="btn-budget" class="nav-item flex flex-col items-center p-2 w-14 transition active:scale-95"><i class="fa-solid fa-wallet text-xl mb-1"></i><span class="text-[10px] font-bold">è¨˜å¸³</span></button>
        </div>
    </div>

    <script>
        // --- 1. å·¥å…·å‡½å¼ ---
        function getDirectImageUrl(url) {
            if (!url) return '';
            if (url.includes('drive.google.com') && url.includes('/file/d/')) {
                try {
                    const id = url.split('/file/d/')[1].split('/')[0].split('?')[0];
                    return `https://lh3.googleusercontent.com/d/${id}`;
                } catch (e) { return url; }
            }
            return url;
        }

        function getDrivePreviewUrl(url) {
            if (!url) return '';
            if (url.includes('drive.google.com') && url.includes('/file/d/')) {
                try {
                    const id = url.split('/file/d/')[1].split('/')[0].split('?')[0];
                    return `https://drive.google.com/file/d/${id}/preview`;
                } catch (e) { return url; }
            }
            return url;
        }

        // --- 2. å…¨åŸŸè®Šæ•¸èˆ‡è¨­å®š ---
        let currentRole = localStorage.getItem('user_role');
        let currentSimulatedDate = null;
        let selectedDateIndex = 0;
        let currentTab = 'home';
        const JPY_RATE = 0.2025;
        
        // è¨˜å¸³ç›¸é—œ
        let currentBudgetTab = 'details';
        let budgetChart = null;
        const FAMILY_MEMBERS = [
            { id: 'driver', name: 'å¦¹å¦¹' },
            { id: 'copilot', name: 'çˆ¸çˆ¸' },
            { id: 'tourist', name: 'åª½åª½' },
            { id: 'admin', name: 'å§Šå§Š' }
        ];

        // è³¼ç‰©ç¯©é¸ç›¸é—œ
        let currentCategoryFilter = 'all';
        let currentStoreFilter = 'all';

        // Keys
        const PACKING_KEY = 'okinawa_packing_v4'; 
        const SHOPPING_KEY = 'okinawa_shop_local_v6'; 
        const EXPENSE_KEY = 'okinawa_expenses_local_v2';

        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyDLahJlYtLuCYrZBgiSYl7FqfOICJkJBd0",
            authDomain: "okinawa-202512.firebaseapp.com",
            databaseURL: "https://okinawa-202512-default-rtdb.firebaseio.com",
            projectId: "okinawa-202512",
            storageBucket: "okinawa-202512.firebasestorage.app",
            messagingSenderId: "932908173572",
            appId: "1:932908173572:web:bad7f92fd5e8e57948e851",
            measurementId: "G-HE116G25W0"
        };

        let db = null;
        try {
            if(firebaseConfig.apiKey) {
                firebase.initializeApp(firebaseConfig);
                db = firebase.database();
                document.getElementById('sync-indicator').classList.remove('sync-offline');
                document.getElementById('sync-indicator').classList.add('sync-online');
            }
        } catch (e) { console.error("Firebase Init Error", e); }

        // --- 3. è³‡æ–™å®šç¾© ---
        const defaultPackingList = 
        [
            { id: 'imp1', text: "è­·ç…§ (æ•ˆæœŸ6å€‹æœˆä»¥ä¸Š)", category: "é‡è¦", done: false },
            { id: 'imp2', text: "æ¨™ç±¤è²¼ (è²¼åœ¨ç™»éŒ„è¨±å¯è­‰é‚£ä¸€é ä¸Š)", category: "é‡è¦", done: false }, 
            { id: 'imp3', text: "é§•ç…§ + ä¸­æ–‡è­¯æœ¬", category: "é‡è¦", done: false }, 
            { id: 'imp4', text: "ç™»æ©Ÿè­‰ (é›»å­/ç´™æœ¬)", category: "é‡è¦", done: false }, 
            { id: 'imp5', text: "éŒ¢åŒ… (å¡/æ—¥å¹£/å°å¹£)", category: "é‡è¦", done: false }, 
            { id: 'imp6', text: "SIM å¡ (4å¼µ)", category: "é‡è¦", done: false }, 
            { id: 'imp7', text: "é‘°åŒ™", category: "é‡è¦", done: false },
            { id: 'imp8', text: "ä¸€å¥—ä¸æ€•é«’çš„è¡£æœï¼ˆåƒçƒ¤è‚‰ç©¿ï¼‰", category: "é‡è¦", done: false },
            { id: 't1', text: "ç‰™åˆ·ã€ç‰™è†ã€ç‰™ç·š", category: "ç›¥æ´—", done: false }, 
            { id: 't2', text: "æ´—æ²è­·é«®ã€æ´—é¢ä¹³", category: "ç›¥æ´—", done: false }, 
            { id: 't3', text: "é«®æ²¹ã€æ¢³å­ã€é¯Šé­šå¤¾", category: "ç›¥æ´—", done: false }, 
            { id: 't4', text: "æ¯›å·¾ã€æµ´å·¾", category: "ç›¥æ´—", done: false }, 
            { id: 't5', text: "åŒ–å¦å“ã€ä¿é¤Šå“", category: "ç›¥æ´—", done: false }, 
            { id: 't6', text: "éš±å½¢çœ¼é¡ã€æ°´ç›’", category: "ç›¥æ´—", done: false },
            { id: 'c1', text: "å¤–å‡ºè¡£æœ (5å¤©)", category: "è¡£ç‰©", done: false }, 
            { id: 'c2', text: "å…§è¡£è¤²ã€è¥ªå­", category: "è¡£ç‰©", done: false }, 
            { id: 'c3', text: "ç¡è¡£ã€æ‹–é‹", category: "è¡£ç‰©", done: false }, 
            { id: 'c4', text: "è–„å¤–å¥—ã€å¸½å­ã€å¢¨é¡", category: "è¡£ç‰©", done: false }, 
            { id: 'e1', text: "å……é›»å™¨ã€ç·šã€è¡Œå……", category: "é›»å­", done: false }, 
            { id: 'e2', text: "å°èˆªæ‰‹æ©Ÿæ¶", category: "é›»å­", done: false }, 
            { id: 'o1', text: "éš¨èº«åŒ…ã€ç’°ä¿è¢‹", category: "é›œé …", done: false }, 
            { id: 'o2', text: "é›¨å‚˜ã€æ°´å£º", category: "é›œé …", done: false }, 
            { id: 'o3', text: "é˜²èšŠæ¶²ã€é˜²æ›¬", category: "é›œé …", done: false }, 
            { id: 'o4', text: "å€‹äººè—¥å“", category: "é›œé …", done: false }, 
            { id: 'o5', text: "è²“æ¢", category: "é›œé …", done: false },
        ];
        
        // --- äº‹å‰æº–å‚™æ¸…å–®è³‡æ–™ ---
const PREP_KEY = 'okinawa_prep_list_v1';
const defaultPrepList = [
    { id: 'p1', text: "ç™»è¨˜ Visit Japan Web", link: "https://www.vjw.digital.go.jp/main/#/vjwplo001", done: false },
    { id: 'p2', text: "æŸ¥çœ‹è­·ç…§æ˜¯å¦éæœŸ", done: false },
    { id: 'p3', text: "æ›æ—¥å¹£ (ç´„ Â¥100,000 ç¾é‡‘ + åˆ·å¡é‡‘)", done: false },
    { id: 'p4', text: "ç¢ºèªä¿¡ç”¨å¡é¸æ“‡åŠé¡åº¦", done: false },
    { id: 'p5', text: "è¡Œæç®±åˆ†é…", done: false }
];

// --- å–å¾—/å„²å­˜ äº‹å‰æº–å‚™æ¸…å–® ---
function getPrepList() {
    const stored = localStorage.getItem(PREP_KEY);
    if (!stored) {
        localStorage.setItem(PREP_KEY, JSON.stringify(defaultPrepList));
        return defaultPrepList;
    }
    return JSON.parse(stored);
}

// --- åˆ‡æ›å‹¾é¸ç‹€æ…‹ ---
function togglePrep(id) {
    const list = getPrepList();
    const item = list.find(i => i.id === id);
    if (item) {
        item.done = !item.done;
        localStorage.setItem(PREP_KEY, JSON.stringify(list));
        // åˆ·æ–°ç•¶å‰é é¢
        if (currentTab === 'home') renderHome();
        if (currentTab === 'vouchers') renderVouchers();
    }
}

// --- ç”Ÿæˆ HTML å…ƒä»¶ ---
function getPrepListHTML() {
    const list = getPrepList();
    const doneCount = list.filter(i => i.done).length;
    const totalCount = list.length;
    const progress = Math.round((doneCount / totalCount) * 100);

    const itemsHtml = list.map(item => {
        // å¦‚æœæœ‰é€£çµï¼Œé¡¯ç¤ºé€£çµæŒ‰éˆ•
        const linkHtml = item.link 
            ? `<a href="${item.link}" target="_blank" class="ml-2 text-xs bg-purple-100 text-purple-600 px-2 py-0.5 rounded border border-purple-200 hover:bg-purple-200 transition inline-block" onclick="event.stopPropagation()"><i class="fa-solid fa-arrow-up-right-from-square"></i> é€£çµ</a>` 
            : '';

        return `
            <div class="flex items-center gap-3 p-2 rounded hover:bg-purple-50 transition cursor-pointer border-b border-gray-50 last:border-0" onclick="togglePrep('${item.id}')">
                <div class="w-5 h-5 flex-shrink-0 rounded border-2 border-purple-400 flex items-center justify-center ${item.done ? 'bg-purple-400' : 'bg-white'}">
                    ${item.done ? '<i class="fa-solid fa-check text-white text-xs"></i>' : ''}
                </div>
                <div class="flex-1 leading-tight">
                    <span class="text-sm ${item.done ? 'text-gray-400 line-through' : 'text-gray-700 font-medium'}">${item.text}</span>
                    ${linkHtml}
                </div>
            </div>`;
    }).join('');

    return `
        <div class="card p-5 mb-4 border-l-4 border-purple-500 shadow-lg bg-white">
            <div class="flex justify-between items-end mb-2">
                <h3 class="font-bold text-purple-700"><i class="fa-solid fa-clipboard-check mr-2"></i>äº‹å‰æº–å‚™</h3>
                <span class="text-xs font-bold text-purple-600">${doneCount}/${totalCount} (${progress}%)</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2 mb-3">
                <div class="bg-purple-500 h-2 rounded-full transition-all duration-500" style="width: ${progress}%"></div>
            </div>
            <div class="grid grid-cols-1 gap-1">
                ${itemsHtml}
            </div>
        </div>`;
}

        const defaultShoppingList = [
            { id: 's1', category: 'é›œè²¨', store: 'é‚£éœ¸æ©Ÿå ´/å–®è»Œ', item: 'OKIKA äº¤é€šå¡', priceJp: 2000, priceTw: 440, done: false },
            { id: 's2', category: 'é›»å™¨', store: 'ä¾¿åˆ©å•†åº—/è¶…å¸‚', item: 'æ‹ç«‹å¾— (Instant Camera)', priceJp: 15000, priceTw: 3300, done: false },
            { id: 's3', category: 'è¡£ç‰©', store: 'ç¾åœ‹æ‘ American Depot', item: 'å¤è‘— (Vintage)', priceJp: 3500, priceTw: 770, done: false }
        ];

        const okinawaEvents = [
            { title: "æ±å—æ¤ç‰©æ¨‚åœ’ ç‡ˆå…‰ç§€", date: "10/25 - 5/25", loc: "æ²–ç¹©å¸‚", img: "https://ohh.okinawa/wpdir/wp-content/uploads/2018/12/8cf8043b599f740cb0b21538e343a2eb-e1545957807732.jpg", link: "https://www.southeast-botanical.jp/tw/illumination/" },
            { title: "ç³¸æ»¿å’Œå¹³ç‡ˆé£¾", date: "12/13 - 1/03", loc: "ç³¸æ»¿å¸‚", img: "https://www.okinawastory.jp/feature/illumination/images/spot04_img01.jpg", link: "https://www.google.com/maps/search/Itoman+Peaceful+Illumination" },
            { title: "ç‰çƒç‡ˆæœƒ (èª­è°·)", date: "12/01 - 3/31", loc: "è®€è°·æ‘", img: "https://lantan.ryukyu/wp-content/uploads/2023/10/img_main_sp.jpg", link: "https://www.google.com/maps/search/Murasaki+Mura+Ryukyu+Kingdom+Theme+Park" },
            { title: "å…’ç«¥ç‹åœ‹ è–èª•å¤¢å¹»", date: "12/20 - 1/05", loc: "æ²–ç¹©å¸‚", img: "https://www.xmas-fantasy.com/images/main_sp.jpg", link: "https://www.google.com/maps/search/Okinawa+Zoo+Museum" },
            { title: "ç¾åœ‹æ‘ è–èª•ç‡ˆé£¾", date: "11/15 - 3/14", loc: "åŒ—è°·ç”º", img: "https://www.okinawastory.jp/feature/illumination/images/spot02_img01.jpg", link: "https://www.google.com/maps/search/American+Village+Okinawa" }
        ];

        const tripData = [
    {
        date: "12/25", fullDate: "2025/12/25", day: "é€±å››", weather: "â˜ï¸ 20Â°C",
        events: [
            { time: "14:50", title: "Uber å‡ºç™¼åŒ—è»Š", type: "trans", guide: "è­·ç…§ã€æ‰‹æ©Ÿã€éŒ¢åŒ…å¸¶äº†å—ï¼Ÿ", appLink: { url: "https://m.uber.com/ul", text: "é–‹å•Ÿ Uber", icon: "fa-brands fa-uber" }, travel: { mode: 'train', time: '40åˆ†' } },
            { 
                time: "15:20", title: "æ©Ÿæ·å¾€æ©Ÿå ´ (ç›´é”è»Š)", type: "trans", guide: "A1 å°åŒ—è»Šç«™ -> A13 ç¬¬ä¸€èˆªå»ˆ", frequency: "ç´„ 15 åˆ†é˜ä¸€ç­", 
                timetableUrl: "https://drive.google.com/file/d/1bjilGkFMFByfquV08NsIrChKnPxn572e/view?usp=drive_link" 
            },
            { 
                time: "16:30", title: "æ©Ÿå ´ Check-in", type: "trans", title_detail: "æ¨‚æ¡ƒ MM930", 
                bookingInfo: { 
                    code: "1616324336315022", 
                    note: "Trip.com è¨‚å–®", 
                    extra: "æ¡ƒåœ’åœ‹éš›æ©Ÿå ´ T1 | 20kg è¨—é‹ / 7kg æ‰‹æ", 
                    driveLink: "https://drive.google.com/file/d/1iScNq9RHqi_l-JYoXhKnhk8Btu-4gTaG/view?usp=drive_link"
                }, 
                guide: "18:20 èµ·é£› -> 20:50 æŠµé” (D)ã€‚",
            },
            { 
                time: "18:20", title: "æ¨‚æ¡ƒ MM930 èµ·é£›", type: "trans",
                guide: "18:20 èµ·é£› -> 20:50 æŠµé” (D)ã€‚",
                travel: { mode: 'plane', time: '1h 30m' }
            },
             { 
                time: "20:50", title: "æŠµé” é‚£éœ¸æ©Ÿå ´ D", type: "trans",
                guide: "18:20 èµ·é£› -> 20:50 æŠµé” (D)ã€‚",
            },
            { 
                time: "21:30", title: "å–®è»Œåˆ—è»Šå¾€å¸‚å€", type: "trans", guide: "é‚£éœ¸æ©Ÿå ´ç«™ -(7ç«™ç´„14åˆ†)> ç¾æ¦®æ©‹ç«™ 1è™Ÿå‡ºå£ã€‚", frequency: "ç´„ 10-12 åˆ†é˜ä¸€ç­", 
                timetableUrl: "https://drive.google.com/file/d/1brg7uYoSb6vgqMZXRK4oGMJARYow6M79/view?usp=drive_link", 
                travel: { mode: 'walk', time: '5åˆ†' } 
            },
            { 
                time: "22:00",leaveTime: "22:20",  title: "æ±æ©«INN ç¾æ¦®æ©‹", type: "hotel", 
                bookingInfo: { 
                    code: "5892799 / 5892800", 
                    note: "æœƒå“¡å¡ Check-in (ç¾å ´ä»˜)",
                    driveLink: "https://drive.google.com/file/d/1LxppScaTh2hwfZVWykidQtgDm9UagXeQ/view?usp=drive_link"
                },
                travel: { mode: 'walk', time: '10åˆ†' }, 
            },
            { 
                time: "22:30", leaveTime:"23:30", title: "æ™šé¤äºŒé¸ä¸€", type: "choice", 
                choices: [ 
                    { 
                        title: "è¦æ¹¯æ‹‰éºµ", 
                        type: "eat", 
                        imgUrl: "https://tblg.k-img.com/restaurant/images/Rvw/306129/640x640_rect_1c59d40469eed39e39ca6f832061d5dd.jpg",
                        guide: "éš±è—å··å¼„çš„æ¿ƒéƒè¦æ¹¯ï¼Œæ·±å¤œé£Ÿå ‚æ°›åœã€‚", 
                        // â˜… äº¤é€šæ™‚é–“
                        travelTime: "æ­¥è¡Œ 10åˆ†",
                        navLink: "https://maps.app.goo.gl/4C2URtcJCK8evziz8",
                        // â˜… Google è©•è«–ç”¨é€£çµ
                        reviewLink: "https://maps.app.goo.gl/HEYTrTrB5RyKFYBx5",
                        link: "https://tabelog.com/tw/okinawa/A4701/A470101/47002685/",
                        detailInfo: { 
                            desc: `é€™å®¶åº—ä¸åœ¨åœ‹éš›é€šå¤§è¡—ä¸Šï¼Œè€Œæ˜¯éš±è—åœ¨æ¾å±±å··å¼„è£¡ï¼Œæ˜¯ç•¶åœ°äººä¸‹ç­å–é…’å¾Œçš„ã€Œæ”¶å°¾æ‹‰éºµã€ã€‚<br><br><b>ğŸ¦ éˆé­‚æ¹¯é ­ï¼š</b><br>è¦å‘³çš„æš´åŠ›ç¾å­¸ï¼ä½¿ç”¨å¤§é‡ç”œè¦ã€è»Šæµ·è€ç†¬ç…®ï¼Œä¸æ˜¯æ·¡æ·¡æ¸…é¦™ï¼Œè€Œæ˜¯<b>ã€Œæ¿ƒç¸®çš„è¡æ“Šã€</b>ï¼å…¥å£é®®ç”œç›´è¡é¼»è…”ã€‚<br><br><b>âš ï¸ é‡è¦æé†’ï¼šåº—å…§å…¨é¢ä¸ç¦è¸</b>ï¼Œä»‹æ„è¸å‘³è€…è«‹æ–Ÿé…Œã€‚<br><br><b>ğŸ“œ èœå–®åƒè€ƒ (é»åœ–æ”¾å¤§)ï¼š</b><br><img src="https://lh3.googleusercontent.com/d/1Q_2GLXEa984f6cUZx8dyCdou2hytIKwJ" class="w-full rounded-lg shadow-md mt-2 cursor-pointer hover:opacity-90 transition" onclick="openVoucherImage(this.src)" loading="lazy">`, 
                            tags: ["æ‹‰éºµ", "å®µå¤œ", "é‡å£å‘³", "å¸è¸å¯"], 
                            highlights: [
                                "ğŸ‘‘ é¦–é¸ï¼šæµ·è€å‘³å™Œæ‹‰éºµ (æ¿ƒéƒçˆ½åº¦)",
                                "ğŸ¥ˆ æ¸…çˆ½æ´¾ï¼šæµ·è€é¹½å‘³æ‹‰éºµ (é®®ç”œ)",
                                "ğŸ¥Ÿ é…è§’ï¼šä¸€å£é¤ƒå­ (çš®è–„é¤¡å¤š)",
                                "æ°›åœï¼šè¥¿è£å¤§å”çš„æ·±å¤œé£Ÿå ‚"
                            ],
                            menu:[
                                {n:"æµ·è€å‘³å™Œæ‹‰éºµ", j:"æ²–ç¸„ã‚¨ãƒ“ã¿ã", p:"Â¥1,200"},
                                {n:"æµ·è€é¹½å‘³æ‹‰éºµ", j:"æ²–ç¸„ã‚¨ãƒ“ã—ãŠ", p:"Â¥1,100"},
                                {n:"ç†±é¨°é¨°çš„é¤ƒå­(6é¡†)", j:"ç†±ã€…é¤ƒå­(6å…¥)", p:"Â¥450"}
                            ] 
                        } 
                    }, 
                    { 
                        title: "ç‰çƒä¸­è¯ è›™å½", 
                        type: "eat", 
                        // â˜… å°é¢ç…§ç‰‡
                        imgUrl: "https://tblg.k-img.com/resize/660x370c/restaurant/images/Rvw/198123/29193b52eb9c59bf138115b14443726a.jpg?token=df157a4&api=v2",
                        // â˜… ç°¡çŸ­èªªæ˜
                        guide: "éœ“è™¹æ¸¯é¢¨ x æ²–ç¹©è€å®…ï¼Œåœ¨åœ°å¹´è¼•äººèšé›†çš„æ½®åº—ã€‚", 
                        // â˜… äº¤é€šæ™‚é–“
                        travelTime: "æ­¥è¡Œ 12åˆ†",
                        // â˜… å°èˆª
                        navLink: "https://maps.app.goo.gl/uxpRiSDsBC5r8D78A",
                        // â˜… Google è©•è«–é€£çµ
                        reviewLink: "https://maps.app.goo.gl/GogoMVRZ79Bem3N97", 
                        // â˜…Tabelogã€å®˜ç¶²ã€IG
                        link: "https://tabelog.com/tw/okinawa/A4701/A470101/47029564/", 
                        detailInfo: { 
                            // â˜… è©³ç´°ä»‹ç´¹
                            desc: `é€™å®¶åº—èµ°çš„æ˜¯<b>ã€Œéœ“è™¹æ¸¯é¢¨ x æ²–ç¹©è€å®…ã€</b>è·¯ç·šï¼Œè¢«ç¨±ç‚ºã€Œæ–°æ´¾ä¸­è¯ (Neo Chinese)ã€ã€‚<br><br><b>ğŸ® æ°›åœï¼šç‹å®¶è¡›é›»å½±æ„Ÿ</b><br>åº—å…§å……æ»¿ç´…è‰²èˆ‡ç¶ è‰²éœ“è™¹ç‡ˆï¼Œå¾ˆæœ‰ Cyberpunk (è³½åšé¾å…‹) æ„Ÿï¼Œåƒé›»å½±ã€Šå¢®è½å¤©ä½¿ã€‹çš„å ´æ™¯ï¼Œéš¨ä¾¿æ‹éƒ½åƒç¶²ç¾ç…§ã€‚<br><br><b>âš ï¸ æ²–ç¹©è¶…äººæé†’ï¼š</b><br>1. <b>è¸å‘³è­¦å ±</b>ï¼š23:00 å¾Œé€šå¸¸å…¨é¢é–‹æ”¾å¸è¸ã€‚<br>2. <b>è²»ç”¨ç´°ç¯€</b>ï¼šæœ‰åº§å¸­è²» (Otoshi) ç´„ Â¥330/äººï¼Œä¸”æ¯äººä½æ¶ˆä¸€æ¯é£²æ–™ã€‚<br><br><b>ğŸ“œ èœå–®åƒè€ƒ (é»åœ–æ”¾å¤§)ï¼š</b><br><img src="https://lh3.googleusercontent.com/d/17PkYEaYV4tlEtUtuAJOQCpzK1lRbNaCc" class="w-full rounded-lg shadow-md mt-2 cursor-pointer hover:opacity-90 transition" onclick="openVoucherImage(this.src)" loading="lazy">`, 
                            tags: ["æ–°ä¸­è¯","éœ“è™¹æ¸¯é¢¨","æ·±å¤œç‡Ÿæ¥­","ç¶²ç¾"], 
                            highlights: [
                                "ğŸ“¸ è¦–è¦ºï¼šç‹å®¶è¡›é›»å½±é¢¨æ ¼ (è¶…å¥½æ‹)",
                                "ğŸ”¥ å¿…é»ï¼šå››å·è—¥è†³éº»å©†è±†è… (èŠ±æ¤’éº»)",
                                "ğŸ¹ æ‰“å¡ï¼šå‡æª¸å¡” (æ•´é¡†æª¸æª¬å †é«˜é«˜)",
                                "ğŸ¥Ÿ é»å¿ƒï¼šæº¢æ±å°ç± åŒ… / ç‡’è³£"
                            ],
                            menu:[
                                {n:"è—¥è†³éº»å©†è±†è…", j:"å››å·è–¬è†³éº»å©†è±†è…", p:"Â¥980"},
                                {n:"è›™å½é»‘ç‚’é£¯", j:"è›™å½ç‚’é£¯BLACK", p:"Â¥1,100"},
                                {n:"å‡æª¸å¡”æ²™ç“¦", j:"å‡çµã‚¿ãƒ¯ãƒ¼ãƒ¬ãƒ¢ãƒ³ã‚µãƒ¯ãƒ¼", p:"Â¥630"},
                                {n:"åº§å¸­è²»(Otoshi)", j:"ãŠé€šã—ä»£", p:"Â¥330"}
                            ] 
                        } 
                    }  
                ] 
            },
            { 
                time: "23:30", title: "å…¶ä»–é»å¿ƒ", type: "choice", 
                choices: [ 
                    { 
                        title: "ç« é­šç‡’", 
                        type: "eat", 
                        imgUrl: "https://ximg.retty.me/crop/s400x400/q80/das/-/retty/img_repo/2l/01/35788265.jpg",
                        guide: "è¶…é«˜CPå€¼ã€Œåƒå…ƒè²·é†‰ã€ï¼Œæ­£å®—å¤§é˜ªç« é­šç‡’ã€‚", 
                        // â˜… äº¤é€šæ™‚é–“
                        travelTime: "æ­¥è¡Œ 10åˆ†",
                        navLink: "https://maps.app.goo.gl/X9wos1NXcCqgYVNx6",
                        // â˜… Google è©•è«–ç”¨é€£çµ
                        reviewLink: "https://maps.app.goo.gl/HEYTrTrB5RyKFYBx5",
                        link: "https://tabelog.com/tw/okinawa/A4701/A470101/47015126//",
                        detailInfo: { 
                            desc: `<b>ğŸ» åƒå…ƒè²·é†‰ (Senbero) è–åœ°ï¼š</b><br>é€™å®¶åº—æœ€å—æ­¡è¿çš„å°±æ˜¯ã€ŒSenbero Setã€ï¼<b>3æ¯é…’ + 1é“ä¸‹é…’èœï¼Œåªè¦ç´„ Â¥1,200ã€‚<br><br><b>ğŸ™ å¿…åƒç²‰ç‰© (æ­£å®—å¤§é˜ªå‘³)ï¼š</b><br>1. <b>ç« é­šç‡’</b>ï¼šå¤–çš®å¾®é…¥ã€å…§é¤¡è»Ÿå«© (Melty)ï¼Œæ¨è–¦ã€Œè”¥èŠ±æ©˜é†‹ã€å£å‘³ã€‚<br>2. <b>èŠ±æç‡’</b>ï¼šéµæ¿å£“çƒ¤ï¼Œå£æ„ŸQå½ˆå……æ»¿è›‹é¦™ã€‚<br><br><b>ğŸ  æ°›åœï¼š</b>åŠé–‹æ”¾å¼è·¯é‚Šåº—ï¼Œæ›è‘—ç´…ç‡ˆç± ï¼Œæ°£æ°›ç†±é¬§éš¨èˆˆï¼Œç™½å¤©å°±æœ‰åœ¨åœ°äººåœ¨å–ã€‚<br><br><b>âš ï¸ é‡è¦æé†’ï¼š</b>é€™é¡åº—å®¶é€šå¸¸ä»¥<b>ç¾é‡‘äº¤æ˜“</b>ç‚ºä¸»ï¼Œè«‹æº–å‚™å¥½é›¶éŒ¢ã€‚`, 
                            tags: ["åƒå…ƒè²·é†‰", "ç« é­šç‡’", "å±…é…’å±‹", "ç¾é‡‘äº¤æ˜“"],  
                            highlights: [
                                "ğŸº å¿…é»ï¼šSenbero Set (3é…’+1èœ)",
                                "ğŸ™ å¿…åƒï¼šç« é­šç‡’ (è”¥èŠ±æ©˜é†‹å£å‘³)",
                                "ğŸ¦‘ æ¨è–¦ï¼šèŠ±æç‡’ (Ikayaki)",
                                "ğŸ•’ ç‡Ÿæ¥­ï¼šä¸‹åˆå°±é–‹å–ï¼Œç›´åˆ°æ·±å¤œ"
                            ],
                            menu:[
                                {n:"åƒå…ƒè²·é†‰å¥—é¤", j:"ã›ã‚“ã¹ã‚ã‚»ãƒƒãƒˆ", p:"Â¥1,100"},
                                {n:"ç« é­šç‡’(6é¡†)", j:"ãŸã“ç„¼ã", p:"Â¥500~"},
                                {n:"èŠ±æç‡’", j:"ã„ã‹ç„¼ã", p:"Â¥400"}
                            ] 
                        } 
                    }, 
                    { 
                        title: "åŠå¤œçš„èˆ’èŠ™è•¾", 
                        type: "eat", 
                        // â˜… å°é¢ç…§ç‰‡
                        imgUrl: "https://sp-ao.shortpixel.ai/client/to_webp,q_glossy,ret_img,w_650,h_488/https://slowlifeinokinawa.com/wp-content/uploads/2024/06/IMG_1221-650x488.jpg",
                        // â˜… ç°¡çŸ­èªªæ˜
                        guide: "åŠå¤œä¹Ÿèƒ½åƒåˆ°çš„è“¬é¬†èˆ’èŠ™è•¾ï¼Œæœ€å¾Œçš„ç”œé»æ•‘è´–ã€‚", 
                        // â˜… äº¤é€šæ™‚é–“
                        travelTime: "æ­¥è¡Œ 12åˆ†",
                        // â˜… å°èˆª
                        navLink: "https://maps.app.goo.gl/uxpRiSDsBC5r8D78A",
                        // â˜… Google è©•è«–é€£çµ
                        reviewLink: "https://maps.app.goo.gl/moC25RCgRjg7yZ677", 
                        // â˜…Tabelogã€å®˜ç¶²ã€IG
                        link: "https://fgblog.fashionguide.com.tw/8433/posts/450077", 
                        detailInfo: { 
                            // â˜… è©³ç´°ä»‹ç´¹
                            desc:  `<b>ğŸŒ™ æ·±å¤œçš„ç½ªæƒ¡æ•‘è´–ï¼š</b><br>é€›å®Œåœ‹éš›é€šå˜´å·´å¯‚å¯ï¼Ÿé€™å®¶åº—é–‹åˆ°å‡Œæ™¨ï¼ä¸»æ‰“<b>ç¾é»ç¾åš</b>çš„èˆ’èŠ™è•¾é¬†é¤…ï¼Œå£æ„Ÿåƒé›²æœµä¸€æ¨£è“¬é¬†æ¿•æ½¤ï¼Œå…¥å£å³åŒ–ã€‚<br><br><b>âš ï¸ é£Ÿç”¨å‰æ³¨æ„ (å¿…çœ‹ï¼)ï¼š</b><br>1. <b>ä½æ¶ˆé™åˆ¶</b>ï¼šå…§ç”¨è¦å®š<b>ã€Œä¸€äººä¸€å“é …ã€</b>(é£²æ–™æˆ–é¬†é¤…çš†å¯)ï¼Œä¸èƒ½å¤šäººåˆ†é£Ÿä¸€ä»½ã€‚<br>2. <b>ç­‰å¾…æ™‚é–“</b>ï¼šç¾åšéœ€ç­‰ <b>20-30 åˆ†é˜</b>ï¼Œè¶•æ™‚é–“è€…è«‹å‹¿å˜—è©¦ã€‚<br>3. <b>æ²¹ç…™å‘³</b>ï¼šé–‹æ”¾å¼å»šæˆ¿ï¼Œèº«ä¸Šå¯èƒ½æœƒæ²¾é»ç”œç”œçš„å‘³é“ã€‚`, 
                            tags: ["èˆ’èŠ™è•¾", "æ·±å¤œç”œé»", "ç¾é»ç¾åš", "ä½æ¶ˆé™åˆ¶"], 
                            highlights: [
                                "ğŸ¥ ç¶“å…¸ï¼šåŸå‘³èˆ’èŠ™è•¾ (è›‹é¦™æ¿ƒéƒ)",
                                "ğŸ’œ é™å®šï¼šæ²–ç¹©ç´…èŠ‹èˆ’èŠ™è•¾ (å¿…æ‹)",
                                "ğŸ¦ é¸é …ï¼šä¸æƒ³ç­‰å¯è²·ç¾©å¼å†°æ·‡æ·‹",
                                "â³ è­¦å‘Šï¼šç¾åšéœ€ç­‰20åˆ†é˜ä»¥ä¸Š"
                            ],
                            menu:[
                                {n:"ç¶“å…¸åŸå‘³èˆ’èŠ™è•¾", j:"ã‚¯ãƒ©ã‚·ãƒƒã‚¯ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­", p:"Â¥1,000"},
                                {n:"æ²–ç¹©ç´«è–¯èˆ’èŠ™è•¾", j:"ç´…èŠ‹ãƒ‘ãƒ³ã‚±ãƒ¼ã‚­", p:"Â¥1,500"},
                                {n:"ç¾©å¼å†°æ·‡æ·‹", j:"ã‚¸ã‚§ãƒ©ãƒ¼ãƒˆãƒ€ãƒ–ãƒ«", p:"Â¥700"}
                            ], 
                        }, 
                    },  
                ],
                travel: { mode: 'walk', time: '15åˆ†' },  
            },
            { 
                time: "00:00", title: "æ±æ©«INN ç¾æ¦®æ©‹", type: "hotel", guide:"æ—©é»ä¼‘æ¯ï¼Œæ˜å¤©ä¹Ÿè¦æ—©èµ·ã€‚",
            },
        ],
    },
    {
        date: "12/26", fullDate: "2025/12/26", day: "é€±äº”", weather: "â˜€ï¸ 21Â°C",
        events: [
            { time: "06:00", title: "èµ·åºŠ & æ—©é¤(6:30 - 9:00)", type: "prep", guide: "é£¯åº—æ—©é¤ã€‚è«‹æº–æ™‚æ•´ç†è¡Œæã€‚", departureTime: "08:00 æº–æ™‚å‡ºç™¼", travel: { mode: 'trans', time: '30åˆ†' } },
            { 
                time: "08:30", title: "OTS ç§Ÿè»Š (è‡¨ç©ºè±å´)", type: "trans", 
                bookingInfo: { 
                    code: "OTS1365405", 
                    note: "é ç´„åï¼šChen Ru Xuan",
                    driveLink: "https://drive.google.com/file/d/1tmm03HWp8HNxlyd9rlX4RjYBaGOsh-OJ/view?usp=drive_link"
                }, 
                guide: "å³é§•å£è¨£ï¼šé å·¦é–‹ï¼Œé›¨åˆ·åœ¨å·¦ï¼Œæ–¹å‘ç‡ˆåœ¨å³ã€‚", travel: { mode: 'drive', time: '30åˆ†' } 
            },
            { 
                time: "10:30",
                leaveTime: "10:40", 
                title: "Once a Week è‚‰æ¡‚æ²", 
                type: "eat", 
                imgUrl: "https://tblg.k-img.com/restaurant/images/Rvw/262352/640x640_rect_b36a9b4580015fb4deb55dafe1237997.jpg", // ç¤ºæ„åœ–
                guide: "å‚³èªªä¸­çš„è‚‰æ¡‚æ²ååº—ï¼Œå»ºè­°è²·äº†è»Šä¸Šåƒã€‚", 
                parkingLink:"https://maps.app.goo.gl/DNT6uo8DPSfSNEwU8",
                
                // 1. å¡ç‰‡å³ä¸Šè§’å°åœ“éˆ• (å°èˆªç”¨)
                navLink: "https://maps.app.goo.gl/JRaZSCn2YMe5Grri7", 
                
                // 2. è©³ç´°è¦–çª—å³é‚Šè—è‰²æŒ‰éˆ• (çœ‹è©•è«–ç”¨)
                reviewLink: "https://maps.app.goo.gl/GFrbHtViTLTuy7BG7",
                
                // 3. è©³ç´°è¦–çª—å·¦é‚ŠæŒ‰éˆ• (å®˜æ–¹ IG)
                link: "https://www.instagram.com/onceaweekcoffee.naha/", 
                
                detailInfo: { 
                    desc: "é€™æ˜¯ä¸€é–“éå¸¸ä½èª¿ä½†äººæ°£è¶…é«˜çš„è‚‰æ¡‚æ²å°ˆè³£åº—ã€‚å¤–çš®é…¥è„†ã€å…§å±¤æ¿•æ½¤ï¼Œè‚‰æ¡‚é¦™æ°£æ¿ƒéƒä½†ä¸åˆºé¼»ï¼Œæ˜¯å¾ˆå¤šæ²–ç¹©é€šå¿ƒä¸­çš„ No.1ã€‚",
                    tags: ["è‚‰æ¡‚æ²", "å¤–å¸¶ç¾é£Ÿ", "ç”œé»"], 
                    highlights: [
                        "æ¯æ—¥é™é‡ï¼Œæ™šä¾†è²·ä¸åˆ°",
                        "å¤šç¨®å£å‘³ï¼šåŸå‘³ã€é»‘ç³–ã€å¥¶æ²¹ä¹³é…ª",
                        "é©åˆç•¶ä½œé–‹è»Šé€”ä¸­çš„é»å¿ƒ"
                    ],
                    menu: [
                        {n: "æ²–ç¹©è‚‰æ¡‚æ²", j:"ãŠããªã‚ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥500"},  
                        {n: "è‡ªå®¶çƒ˜ç„™å’–å•¡", j:"è‡ªå®¶ç„™ç…ãƒ›ãƒƒãƒˆã‚³ãƒ¼ãƒ’ãƒ¼", p: "Â¥500"},
                        {n: "å†°ç¾å¼", j:"ã‚¢ã‚¤ã‚¹ã‚¢ãƒ¡ãƒªã‚«ãƒ¼ãƒ", p: "Â¥500"},
                        {n: "å†·èƒå’–å•¡", j:"æ°´å‡ºã—ã‚¢ã‚¤ã‚¹ã‚³ãƒ¼ãƒ’ãƒ¼", p: "Â¥500"},
                        {n: "å†°æ‹¿éµ", j:"ã‚«ãƒ•ã‚§ãƒ©ãƒ† (ãƒ›ãƒƒãƒˆ/ã‚¢ã‚¤ã‚¹)", p: "Â¥500"},
                    ]
                },
                
                travel: { mode: 'drive', time: '15åˆ†' } 
            },
            { 
                time: "11:00",
                leaveTime: "12:00", 
                title: "æ¸¯å·å¤–äººä½å®…è¡—", 
                type: "spot", 
                parkingLink:"https://maps.app.goo.gl/mAvCnvyugs5og3kP8",

                // å°é¢åœ–ï¼šé¸ç”¨æœ€å…·ä»£è¡¨æ€§çš„ oHacorte å°æœ¨å±‹èˆ‡ç²‰è—è‰²å»ºç¯‰
                imgUrl: "https://b-cat.tw/wp-content/uploads/2019/06/47991552012_1537f2e673_o-1024x682.jpg",
                
                guide: "é¦¬å¡é¾è‰²ç³»çš„ç¾è»å®¿èˆç¾¤ï¼Œç”œé»æˆ°å€ (oHacorte / ã»ã†ãæ˜Ÿ)ã€‚", 
                
                // 1. å°èˆªï¼šè¨­å®šåˆ°å¤–äººä½å®…å€å…¥å£
                navLink: "https://maps.app.goo.gl/xckj2nsiLzFXARiK7", 
                
                // 2. è©•è«–ï¼šé€™è£¡è¨­å®šç‚º Google Maps çš„è©•è«–é é¢
                reviewLink: "https://maps.app.goo.gl/dzMhn2MomSrYvRkh8",
                
                // 3. å®˜ç¶²ï¼šæ¸¯å·å¤–äººä½å®…éƒ¨è½å®¢ä»‹ç´¹
                link: "https://bobbyfun.tw/2024-01-07-2690/", 
                
                detailInfo: { 
                    desc: `é€™è£¡ä»¥å‰æ˜¯ç¾è»çœ·å±¬å®¿èˆï¼Œç¾åœ¨æ˜¯è¶…å¥½æ‹çš„æ–‡é’èšè½ã€‚æ¯æ£Ÿå¹³æˆ¿éƒ½æ¼†æˆå¯æ„›çš„é¦¬å¡é¾è‰²ï¼Œè·¯åä¹Ÿæ˜¯ç”¨ç¾åœ‹å·åå‘½åï¼ˆå¦‚ Nevada St.ï¼‰ï¼Œå……æ»¿ç•°åœ‹é¢¨æƒ…ã€‚<br><br><b>ğŸš— åœè»Šæ”»ç•¥ (é‡è¦ï¼)ï¼š</b><br>é€™è£¡æ˜¯ã€Œè‡ªé§•å°é­”ç‹é—œå¡ã€ï¼Œ<b>è·¯éå¸¸çª„ï¼Œæœƒè»Šå›°é›£ï¼</b>ä¸”åº—å®¶å°ˆå±¬è»Šä½æ¥µå°‘ã€‚<br>ğŸ’¡ <b>å¼·çƒˆå»ºè­°ï¼š</b>ç›´æ¥åœåœ¨å…¥å£è™•æˆ–ä¸­é–“çš„<b>ã€ŒæŠ•å¹£å¼åœè»Šå ´ (Coin Parking)ã€</b>å†èµ°é€²å»é€›ï¼Œæœ€è¼•é¬†çœäº‹ã€‚<br><br><b>ğŸ“¸ å¿…æ‹åœ°åœ–åƒè€ƒï¼š</b><br>
                        <img src="https://lh3.googleusercontent.com/d/1qFmufquzGGsg4mmMSadmLlZKJW4bXMC-" class="w-full rounded-lg shadow-md mt-2 cursor-pointer hover:opacity-90 transition" onclick="openVoucherImage(this.src)" loading="lazy">`, 
                    
                    tags: ["æ–‡é’", "ç”œé»", "æ‹ç…§è–åœ°"], 
                    
                    highlights: [
                        "âš¡ï¸ 1å°æ™‚å¿«é–ƒï¼š11:00 æ‹ç…§ -> 11:30 è²·ç”œé» -> 12:00 é›¢é–‹",
                        "ğŸ›ï¸ å¿…è²·ï¼šã»ã†ãæ˜Ÿ (é»‘ç³–å¯éº—éœ²) - 25è™Ÿ",
                        "ğŸ° å¿…åƒï¼šoHacorte (æ°´æœå¡”) - 18è™Ÿ (é–€å£å¿…æ‹!)",
                    ],
                    
                    // æŠŠåº—å®¶ç•¶ä½œ Menu é¡¯ç¤ºï¼Œæ–¹ä¾¿æŸ¥çœ‹
                    menu: [
                        {n: "[25è™Ÿ] ã»ã†ãæ˜Ÿ å¯éº—éœ²", j:"ã‚«ãƒŒãƒ¬", p: "Â¥880"}, 
                        {n: "[18è™Ÿ] oHacorte æ°´æœå¡”", j:"ãƒ•ãƒ«ãƒ¼ãƒ„ã‚¿ãƒ«ãƒˆ", p: "Â¥734"}, 
                        {n: "[28è™Ÿ] Okinawa Cerrado Coffee", j:"coffee", p: "Â¥570"}
                    ]
                }, 
                
                travel: { mode: 'drive', time: '30åˆ†' } 
            },
            { 
                time: "12:30", 
                leaveTime: "13:30",
                title: "æ™®å¤©æ»¿å®®", 
                type: "spot", 
                imgUrl: "https://cdn.zekkei-japan.jp/datas/images/2024/04/30/c03f51ed4ebc5e578df0cbe7501f1a9ee742df4e.jpg",
                guide: "å®œé‡ç£æœ€å¼·èƒ½é‡æ™¯é»ï¼Œæœ¬æ®¿å¾Œæ–¹è—è‘—ç¥ç§˜é˜ä¹³çŸ³æ´ (âš ï¸éœ€ç™»è¨˜/ç¦æ‹ç…§)ã€‚", 
                mapCode: "33 438 616*33", 
                parkingLink:"https://maps.app.goo.gl/Y6VC5UpqyQQwdehdA",
                // â˜… å°èˆªé€£çµ (å¡ç‰‡å³ä¸Šè§’)
                navLink: "https://maps.app.goo.gl/S4KiRAgGtwoxpJ9dA", 
                // â˜… è©•è«–é€£çµ (è©³ç´°è¦–çª—å³ä¸‹è§’)
                reviewLink: "https://maps.app.goo.gl/7QfHwUZj3ymJeTFm8",
                // â˜… tabelogã€IGã€å®˜ç¶²ã€ä»‹ç´¹
                link: "https://fgblog.fashionguide.com.tw/9283/posts/449985", 
                
                detailInfo: { 
                    desc: `<b>â›©ï¸ å…©å¤§çœ‹é»ï¼š</b><br>1. <b>åœ°åº•ç¥ç§˜ä¸–ç•Œ</b>ï¼šæœ¬æ®¿å¾Œæ–¹è—è‘—å…¨é•· 280å…¬å°ºçš„é˜ä¹³çŸ³æ´ï¼Œæ°£æ°›èŠåš´è‚…ç©†ï¼Œä¾›å¥‰è‘—ã€Œæ™®å¤©æ»¿å¥³ç¥ã€ã€‚<br>2. <b>çµç·£èˆ‡æ±‚å­</b>ï¼šåœ¨åœ°äººå¿ƒä¸­æ±‚ã€Œè‰¯ç·£ (En-musubi)ã€å’Œã€Œå®‰ç”¢ã€éå¸¸éˆé©—ã€‚<br><br><b>âš ï¸ é€²æ´ç©´æ”»ç•¥ (å¿…çœ‹ï¼)ï¼š</b><br>æ´ç©´<b>ä¸æ˜¯è‡ªç”±é€²å‡º</b>çš„ï¼æŠµé”å¾Œè«‹å…ˆå»<b>ã€Œæˆäºˆæ‰€ (è³£å¾¡å®ˆæ«ƒå°)ã€</b>å¡«å¯«ç”³è«‹å–®ç™»è¨˜ã€‚å·«å¥³æœƒå®‰æ’æ¢¯æ¬¡ï¼ˆç´„20-30åˆ†ä¸€æ¢¯ï¼‰ï¼Œåœ¨æ—é‚Šä¼‘æ¯å®¤ç­‰å¾…å¼•å°ã€‚<br><br><b>ğŸš« åš´ç¦æ‹ç…§ï¼š</b>æ´ç©´å…§ç¾åœ¨<b>ã€Œå…¨é¢ç¦æ­¢æ”å½±ã€</b>ï¼Œè«‹å‹™å¿…éµå®ˆè¦å®šï¼Œç”¨å¿ƒæ„Ÿå—å³å¯ã€‚<br><br><b>ğŸš— åœè»Šï¼š</b>æœ‰å…è²»åœè»Šå ´ï¼Œå°±åœ¨é³¥å±…æ—ã€‚`, 
                    tags: ["é˜ä¹³çŸ³æ´", "çµç·£", "èƒ½é‡æ™¯é»"], 
                    highlights: [
                        "âœ¨ å¿…çœ‹ï¼šæœ¬æ®¿å¾Œæ–¹çš„ç¥ç§˜åœ°åº•æ´ç©´",
                        "ğŸ“ æµç¨‹ï¼šå…ˆå»æ«ƒå°ç™»è¨˜ -> ç­‰å¾…å«è™Ÿ",
                        "ğŸš« è­¦å‘Šï¼šæ´ç©´å…§çµ•å°ç¦æ­¢æ‹ç…§ (No Photos)",
                        "ğŸ™ ç¥ˆç¦ï¼šæ±‚è‰¯ç·£ã€å®‰ç”¢ç‰¹åˆ¥éˆé©—"
                    ]
                }, 
                
                travel: { mode: 'drive', time: '20åˆ†' } 
            },
            { 
                time: "14:30", 
                leaveTime: "15:30",
                title: "åˆé¤ï¼šå£½å¸å¸‚å ´ æ³¡ç€¨åº—", 
                type: "eat", 
                
                // â˜… å°é¢ç…§ç‰‡
                imgUrl: "https://www.garnish.tv/page/pimg/thumbnail/20160605073523.jpg",
                
                guide: "åœ¨åœ°äººæ°£è¿´è½‰å£½å¸ï¼Œå¿…åƒè—è‰²é­š(ä¼Šæ‹‰å¸ƒæŸ¥)èˆ‡ç‚¸é­šå¤©å©¦ç¾…ã€‚", 
                
                // â˜… å°èˆªèˆ‡è©•è«–
                mapCode: "33 531 366*44", 
                navLink: "https://maps.app.goo.gl/RV1UCj2pNZPbucAx6",
                reviewLink: "https://maps.app.goo.gl/mhKCecLYWQ96HRCk8",
                link: "https://www.ringring.com.tw/ringring4029/",
                
                detailInfo: { 
                    desc: `
                        <b>ğŸ£ æ²–ç¹©é™å®šå¿…é»ï¼š</b><br>
                        1. <b>ä¼Šæ‹‰å¸ƒæŸ¥ (é’è¡£é­š)</b>ï¼šè—è‰²çš„çš®åƒå¤–æ˜Ÿç”Ÿç‰©ï¼Œä½†è‚‰è³ªQå½ˆæ¸…çˆ½ï¼<br>
                        2. <b>æ²–ç¹©ç¸£ç”¢é®ªé­š</b>ï¼šç”Ÿé®®ç›´é€ç„¡å†·å‡ï¼Œè»Ÿå«©é®®ç”œã€‚<br>
                        3. <b>æµ·è‘¡è„è»è‰¦</b>ï¼šå•µå•µå•µå£æ„Ÿé…é†‹é£¯è¶…é–‹èƒƒã€‚<br>
                        4. <b>ç‚¸é­šå¤©å©¦ç¾…</b>ï¼šåšéºµè¡£åƒé›¶é£Ÿï¼Œæ²¾é¹½å·´åƒè¶…è®šã€‚<br><br>
                        
                        <b>ğŸš— åœè»Šèˆ‡é»é¤ï¼š</b><br>
                        åœè»Šå ´å¤§ä½†è»Šæµå¿«ã€‚é€²åº—è«‹å…ˆæŠ½è™Ÿç¢¼ç‰Œ (Ticket)ã€‚<br>
                        é»é¤ä½¿ç”¨ <b>å¹³æ¿ (Tablet)</b>ï¼Œæœ‰ä¸­æ–‡/è‹±æ–‡ä»‹é¢ï¼Œå…æ“”å¿ƒï¼<br><br>
                        
                        <b>ğŸ å„ªæƒ åˆ¸ (Coupon)ï¼š</b><br>
                        <a href="http://gurumekaiten.com/coupon.pdf" target="_blank" class="inline-block bg-red-50 text-red-600 border border-red-200 px-3 py-2 rounded-lg text-sm font-bold hover:bg-red-100 transition"><i class="fa-solid fa-ticket mr-1"></i> é»æ­¤é–‹å•Ÿ PDF å„ªæƒ åˆ¸</a><br><br>

                        <b>ğŸ“œ å®Œæ•´èœå–® (é»æ“ŠæŸ¥çœ‹)ï¼š</b><br>
                        <div class="flex flex-wrap gap-2 mt-1">
                            <a href="http://gurumekaiten.com/images/menu/2025/big_menu2025.png" target="_blank" class="text-blue-600 underline text-xs">ä¸»èœå–®</a>
                            <a href="http://gurumekaiten.com/images/menu/2025/big_side_menu2025_1.png" target="_blank" class="text-blue-600 underline text-xs">å‰¯é¤1</a>
                            <a href="http://gurumekaiten.com/images/menu/2025/big_side_menu2025_2.png" target="_blank" class="text-blue-600 underline text-xs">å‰¯é¤2</a>
                            <a href="http://gurumekaiten.com/images/menu/2025/big_side_menu2025_3.png" target="_blank" class="text-blue-600 underline text-xs">å‰¯é¤3</a>
                        </div>
                    `, 
                    
                    tags: ["è¿´è½‰å£½å¸", "åœ¨åœ°äººæ°£", "å¹³åƒ¹", "ä¸­æ–‡å¹³æ¿"], 
                    
                    highlights: [
                        "ğŸŸ å¿…åƒï¼šè—è‰²é¸šå“¥é­š (ä¼Šæ‹‰å¸ƒæŸ¥)",
                        "ğŸ£ æ¨è–¦ï¼šæ²–ç¹©ç¸£ç”¢é®ªé­š (æœªå†·å‡)",
                        "ğŸ¤ ç‰¹è‰²ï¼šç‚¸é­šå¤©å©¦ç¾… (åšéºµè¡£)",
                        "ğŸ’¡ æé†’ï¼šé€²åº—å…ˆæŠ½è™Ÿç¢¼ç‰Œ"
                    ],
                }, 
                
                travel: { mode: 'drive', time: '10åˆ†' } 
            },
            { 
                // â˜… åˆå¾Œè¡Œç¨‹äºŒé¸ä¸€ (æ³¡ç€¨æ¼æ¸¯ vs AEON Mall)
                time: "15:50",
                leaveTime: "17:45", 
                title: "è¡Œç¨‹äºŒé¸ä¸€", 
                type: "choice", 
                choices: [
                    {
                        title: "æ³¡ç€¨æ¼æ¸¯",
                        type: "eat",
                        // å°é¢åœ–ï¼šæµ·è†½ç„—çƒ¤é¾è¦
                        imgUrl: "https://tc.tabirai.net/sightseeing/article/img/0001484/kiji1Img.jpg", 
                        guide: "åœ¨åœ°æœ€å¼·ã€Œæµ·è†½ç„—çƒ¤é¾è¦ã€ï¼ŒCPå€¼é«˜ã€‚",
                        travelTime: "é–‹è»Š 5åˆ†",
                        
                        navLink: "https://maps.app.goo.gl/ECF35foo4PgHGe1p8", 
                        reviewLink: "https://maps.app.goo.gl/whLeWZmtP8V5eXga7", 
                        link: "https://mimigo.tw/fish-market-payao/", 
                        
                        detailInfo: {
                            desc: `<b>ğŸ¦ åœ¨åœ°å…¨åï¼šæ³¡ç€¨å¸•äºæ­ç›´å£²åº—</b><br>é€™æ˜¯ä¸€å€‹å……æ»¿åœ¨åœ°æ´»åŠ›çš„æµ·é®®é£Ÿå ‚ï¼ä¸æ˜¯åƒæ°£æ°›çš„ï¼Œæ˜¯åƒ <b>CP å€¼å’Œæ–°é®®åº¦</b>çš„ã€‚å¤§å®¶ååœ¨åŠæˆ¶å¤–ä½å­å¤§å£åƒæµ·é®®ï¼Œéå¸¸æœ‰å°ç£ç†±ç‚’åº—çš„è¦ªåˆ‡æ„Ÿã€‚<br><br><b>ğŸ”¥ å¿…åƒé‡é»ï¼š</b><br>1. <b>æµ·è†½é†¬çƒ¤é¾è¦ (å¿…é»)</b>ï¼šåŠéš»æˆ–æ•´éš»é¾è¦é‹ªæ»¿ç‰¹è£½ã€Œæµ·è†½ç¾ä¹ƒæ»‹é†¬ã€çƒ¤åˆ°é‡‘é»ƒï¼Œå¥¶é¦™çˆ†ç‚¸ï¼Œè¶…ç´šç½ªæƒ¡ï¼<br>2. <b>ç‚¸å¤©å©¦ç¾…</b>ï¼šæ²–ç¹©å¼åšéºµè¡£ï¼Œè»ŸQå£æ„Ÿï¼Œé©åˆç•¶é»å¿ƒã€‚<br><br><b>âš ï¸ é‡è¦æé†’ï¼š</b>é£Ÿå ‚ç‡Ÿæ¥­æ™‚é–“ <b>11:00 - 17:30</b>ï¼Œè«‹å‹™å¿…æ³¨æ„ï¼<br><br><b>ğŸ“œ é£Ÿå ‚èœå–®åƒè€ƒ (é»åœ–æ”¾å¤§)ï¼š</b><br>
                                <img src="https://mimigo.tw/wp-content/uploads/20170810214130_79.jpg" class="w-full rounded-lg shadow-md mt-2 cursor-pointer hover:opacity-90 transition" onclick="openVoucherImage(this.src)" loading="lazy">`,
                            
                            tags: ["æµ·è†½é¾è¦", "åœ¨åœ°é£Ÿå ‚", "é«˜CPå€¼", "åŠæˆ¶å¤–"],
                            
                            highlights: [
                                "ğŸ‘‘ é®åº—ä¹‹å¯¶ï¼šæµ·è†½é†¬çƒ¤é¾è¦ (Uni Sauce Lobster)",
                                "ğŸ¤ é»å¿ƒï¼šæ²–ç¹©å¤©å©¦ç¾… (ç‚¸é­š/èŠ±æ)",
                                "ğŸ’° åƒ¹æ ¼ï¼šå®šé£Ÿç´„ Â¥3,000~Â¥5,000 (æ¯”é¤å»³ä¾¿å®œä¸€åŠ)",
                                "â° è­¦å‘Šï¼š17:30 æœ€å¾Œé»é¤ (Last Order)"
                            ],
                            
                            menu: [
                                {n: "æµ·è†½ç„—çƒ¤é¾è¦(åŠéš»)å®šé£Ÿ", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥2,700"}, 
                                {n: "æµ·è†½ç„—çƒ¤é¾è¦(æ•´éš»)å®šé£Ÿ", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥5,500"},
                            ],
                        },
                    },
                    {
                        title: "AEON Mall æ°¸æ—ºå¤¢æ¨‚åŸ",
                        type: "spot",
                        // å°é¢åœ–
                        imgUrl: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQcwegcPAi6bnlHBiVlQ7wd92lJIVGsYx5DMA&s", 
                        
                        guide: "æ²–ç¹©æœ€å¤§è³¼ç‰©ä¸­å¿ƒï¼Œæœ‰å·¨å¤§æ°´æ—ç®±èˆ‡å¯¶å¯å¤¢ä¸­å¿ƒã€‚",
                        travelTime: "é–‹è»Š 10åˆ†",
                        
                        navLink: "https://maps.app.goo.gl/rKuSJm8HYjJYPn7E7", 
                        reviewLink: "https://maps.app.goo.gl/Qyg8KUK3iyjd2GkF6", 
                        link: "https://okinawarycom-aeonmall.com/", 
                        
                        detailInfo: {
                            desc: `<b>ğŸ¢ æ²–ç¹©æœ€å¤§ï¼š</b>å¥½å¹¾æ£Ÿé€£åœ¨ä¸€èµ·ï¼Œä¸å…ˆåšåŠŸèª²æœƒè¿·è·¯ï¼é©åˆåƒå¤ªé£½ä¾†é€™è£¡ç´”èµ°è·¯é€›è¡—å¹å†·æ°£ã€‚<br><br><b>âœ¨ å¿…é€›é‡é» (æ¨“å±¤æ”»ç•¥)ï¼š</b><br>1. <b>å¯¶å¯å¤¢ä¸­å¿ƒ (1F)</b>ï¼šé–€å£æœ‰å·¨å¤§çš„ã€Œé¢¨é€Ÿç‹—ã€é›•åƒï¼Œå¾ˆå¤šç©¿èŠ±è¥¯è¡«çš„æ²–ç¹©é™å®šçš®å¡ä¸˜ã€‚<br>2. <b>å·¨å¤§æ°´æ—ç®± (1Få¤§å»³)</b>ï¼šè²«ç©¿æ¨“å±¤ï¼Œæœ‰é¯Šé­šå’Œé­Ÿé­šï¼Œå…é–€ç¥¨ï¼<br>3. <b>æ©¡å­å…±å’Œåœ‹ (4F)</b>ï¼šå‰åœåŠ›å°ˆè³£åº—ï¼Œé–€å£æœ‰å¤§é¾è²“ã€‚<br>4. <b>æƒè²¨å€</b>ï¼šBic Camera(é›»å™¨)ã€Uniqlo/GUã€AEON Style è¶…å¸‚(2F è²·æ°´æœé›¶é£Ÿ)ã€‚<br><br><b>ğŸ“ æ²–ç¹©è¶…äººæˆ°ç•¥ï¼š</b><br><b>ğŸš— åœè»Š</b>ï¼šå…è²»ï¼å»ºè­°åœåœ¨<b>ã€Œ1F é è¿‘æ°´æ—ç®±å…¥å£ã€</b>ï¼Œæ¬è²¨æœ€æ–¹ä¾¿ã€‚<br><b>ğŸ’° é€€ç¨…</b>ï¼šè¨˜å¾—å¸¶è­·ç…§ï¼ï¼ˆå¯ä»¥åœ¨ç™»éŒ„è¨±å¯è­‰é‚£ä¸€é è²¼å°è²¼ç´™ï¼‰æœ‰äº›åº—å…§é€€ï¼Œæœ‰äº›è¦å» 1F å…ç¨…æ«ƒå°çµ±é€€ã€‚`,
                            
                            tags: ["å¯¶å¯å¤¢ä¸­å¿ƒ", "æ°´æ—ç®±", "é›¨å¤©å‚™æ¡ˆ", "å…è²»åœè»Š"],
                            
                            highlights: [
                                "âš¡ï¸ 1Fï¼šå¯¶å¯å¤¢ä¸­å¿ƒ (Pokemon Center)",
                                "ğŸ  1Fï¼šRycom Aquarium (å·¨å¤§æ°´æ—ç®±)",
                                "ğŸ¬ 4Fï¼šæ©¡å­å…±å’Œåœ‹ (å‰åœåŠ›)",
                                "ğŸ¥© ç¾é£Ÿï¼šIKINARI ç«‹é£Ÿç‰›æ’ / è è˜¿éºµåŒ…"
                            ],
                        },
                    },
                ],
                travel: { mode: 'drive', time: '10åˆ†' } 
            },
            { 
                time: "18:00", 
                leaveTime:"19:30",
                title: "æ™šé¤ï¼šé˜¿å¤è±¬é‹", 
                type: "eat", 
                title_detail: "Chatan Dining Chaabu", 
                parkingLink:"https://maps.app.goo.gl/WoxXZ6aPqCVvp8hn8",
                
                imgUrl: "https://image.kkday.com/v2/image/get/s1.kkday.com/product_213611/20240924093422_j80Uu/png",
                
                guide: "åœ¨åœ°äººç§æˆ¿ååº—ï¼Œå¿…åƒé˜¿å¤è±¬æ¶®æ¶®é‹æ²¾é¦™æª¸é†‹é†¬ã€‚", 
                
                navLink: "https://maps.app.goo.gl/YtcRzAkFkNEH64Un8",
                reviewLink: "https://maps.app.goo.gl/nfRWvwG4nLVuNUhC6",
                link: "https://tabelog.com/tw/okinawa/A4703/A470304/47029667/",
                mapCode: "33 526 212*25", 
                bookingInfo: { 
                    code: "3JYNWGHFKM", 
                    note: "Tabelog é ç´„", 
                    driveLink: "https://drive.google.com/file/d/1aC-aVfvv4iy578apmaEv9HksOD-rzjOt/view?usp=drive_link"
                }, 
                
                detailInfo: { 
                    desc: `<b>ğŸ· åœ¨åœ°ç§æˆ¿åå–®ï¼š</b><br>æ¯”èµ·è§€å…‰æ’éšŠååº—ï¼Œé€™å®¶æ›´æº«é¦¨ï¼ä¸»æ‰“é˜¿å¤è±¬çš„æ¥µè‡´äº«å—ï¼Œè„‚è‚ªçœ‹èµ·ä¾†è‚¥ä½†åƒèµ·ä¾†æ˜¯<b>è„†å£ä¸”å¸¶æœ‰æ¿ƒæ¿ƒç”œå‘³</b>ï¼Œå®Œå…¨ä¸è†©ã€‚<br><br><b>ğŸ² å¿…é»æ‹›ç‰Œï¼šé˜¿å¤è±¬æ¶®æ¶®é‹</b><br>æ¹¯é ­æ˜¯ç°¡å–®çš„æ˜†å¸ƒ/é°¹é­šæ¸…æ¹¯ï¼Œå› ç‚ºè‚‰è³ªå¤ å¥½ï¼<br><b>ğŸ’¡ å…§è¡Œåƒæ³•ï¼š</b>è‚‰ç‰‡ç²‰ç´…è‰²æ™‚ä¸‹é‹ï¼Œ<b>æ¶® 3-5 ç§’</b>è®Šç™½å°±å¥½ï¼Œæ²¾ç‰¹è£½çš„<b>ã€ŒShikuwasa (æ²–ç¹©é¦™æª¸) é†‹é†¬ã€</b>ï¼Œé…¸ç”œæœé¦™é…ä¸Šæ²¹è„‚ç”œå‘³ï¼Œè¶…ç´šæ­ï¼<br><br><b>ğŸ  æ°›åœï¼š</b>æº«é¦¨æ—¥å¼å®¶åº­é¢¨ï¼Œæœ‰<b>ã€Œå €å¼æš–æ¡Œã€</b>(è…³å¯ä»¥ä¼¸ç›´çš„æ¦»æ¦»ç±³)ï¼Œå¾ˆæ”¾é¬†ã€‚`, 
                    tags: ["é˜¿å¤è±¬", "æ¶®æ¶®é‹", "åœ¨åœ°ç§æˆ¿", "å €å¼æš–æ¡Œ"], 
                    highlights: [
                        "ğŸ‘‘ å¿…åƒï¼šé˜¿å¤è±¬æ¶®æ¶®é‹ (æ¶®3-5ç§’!)",
                        "ğŸ‹ éˆé­‚ï¼šç‰¹è£½é¦™æª¸é†‹é†¬ (è§£è†©ç¥å™¨)",
                        "ğŸ¥¢ åŠ é»ï¼šæµ·è‘¡è„ã€ç‚¸ç´…èŠ‹å¤©å©¦ç¾…"
                    ],
                    menu: [
                        {n: "é˜¿å¤è±¬æ¶®æ¶®é‹(å«å¸¶çš®è±¬äº”èŠ±)", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥3,980"}, 
                        {n: "é˜¿å¤è±¬æ¶®æ¶®é‹(å«å¸¶çš®è±¬äº”èŠ±)", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥2,980"},
                    ] 
                }, 
                
                travel: { mode: 'drive', time: '10åˆ†' } 
            },
            { 
                time: "19:40", leaveTime:"20:00", title: "ç¾æ¿±æ—¥è½åº¦å‡é£¯åº—", type: "hotel", title_detail: "Sunset Resort Mihama", mapCode: "33 525 205*74", guide: "å¯åœè»Šï¼Œå…ˆåˆ°å…ˆå¾—ã€‚",
                bookingInfo: { 
                    code: "1616323760441360", 
                    note: "PIN: 1047", 
                    extra: "å·²ä»˜ Â¥9,424", 
                    driveLink: "https://drive.google.com/file/d/16zfKPiZBPPBFJyARHDH503a85w6vEmJi/view?usp=drive_link"
                },
                travel: { mode: 'walk', time: '10åˆ†' } 
            },
            { 
                time: "20:10", 
                leaveTime: "21:00", 
                title: "ç¾åœ‹æ‘", 
                type: "spot", 
                mapCode: "33 526 450*63", 
                parkingLink:"https://maps.app.goo.gl/HXg3HkHtTyqidARU6",
                // å°é¢åœ–ï¼šç¾åœ‹æ‘å¤œæ™¯
                imgUrl: "https://resize-image.vocus.cc/resize?norotation=true&quality=80&url=https%3A%2F%2Fimages.vocus.cc%2F9076798c-babf-4aa8-a88f-8927b928d9ca.jpg&width=740&sign=_ooLnoqECQhIsOPDKAv4ZkXydOnaMowoba4cUMhMQiI",
                
                guide: "æ‘©å¤©è¼ªæ‹ç…§ã€è—¥å¦åº—è£œè²¨ã€è–èª•ç‡ˆé£¾ã€‚", 
                
                // å°èˆª
                navLink: "https://maps.app.goo.gl/3J3J3J3J3J3J3J3J", 
                // googleè©•è«–
                reviewLink: "https://maps.app.goo.gl/nfRWvwG4nLVuNUhC6",
                // å®˜ç¶²æˆ–ä»‹ç´¹
                link: "https://www.depot-island.co.jp/",
                
                detailInfo: {
                    desc: `<b>ğŸ¡ å……æ»¿ç¾å¼é¢¨æƒ…çš„è³¼ç‰©å€ï¼š</b><br>é€™è£¡æ˜¯ä»¥å‰ç¾è»åŸºåœ°æ”¹å»ºçš„ï¼Œå……æ»¿ç•°åœ‹æƒ…èª¿ã€‚è–èª•ç¯€æœŸé–“ï¼ˆ11æœˆä¸­~3æœˆä¸­ï¼‰æ•´å€‹åœ’å€æœƒæœ‰è¶…ç¾çš„ç‡ˆé£¾ï¼Œéš¨ä¾¿æ‹éƒ½å¥½çœ‹ã€‚<br><br><b>ğŸ›ï¸ å¿…é€›æ”»ç•¥ï¼š</b><br>1. <b>Depot Island</b>ï¼šæœ‰å¾ˆå¤šå€‹æ€§å°åº—ã€å¤è‘—åº—ã€‚<br>2. <b>å¤§åœ‹è—¥å¦ (Daikoku Drug)</b>ï¼šæ‘©å¤©è¼ªä¸‹æ–¹é‚£é–“æ˜¯å…¨æ²–ç¹©æœ€ä¾¿å®œçš„è—¥å¦åº—ä¹‹ä¸€ï¼Œè¦è£œè²¨ä¾†é€™ï¼<br>3. <b>Christmas Land</b>ï¼šå°ˆè³£è–èª•é£¾å“çš„å°åº—ï¼Œä¸€å¹´365å¤©éƒ½åœ¨éè–èª•ã€‚<br><br><b>ğŸ“¸ æ‹ç…§é»ï¼š</b><br>é›–ç„¶æ‘©å¤©è¼ªå·²ç¶“æ‹†é™¤ï¼Œä½†åŸæœ¬çš„ä½ç½®ç¾åœ¨æ˜¯æ–°çš„æ‰“å¡åœ°æ¨™ï¼ŒåŠ ä¸Šé‹æ²³é‚Šçš„å¤œæ™¯éå¸¸æµªæ¼«ã€‚`,
                    
                    tags: ["å¤œæ™¯", "è³¼ç‰©", "è–èª•ç‡ˆé£¾", "å¤§åœ‹è—¥å¦"],
                    
                    highlights: [
                        "ğŸ’Š å¿…è²·ï¼šå¤§åœ‹è—¥å¦ (åƒ¹æ ¼å¾ˆæœ‰ç«¶çˆ­åŠ›)",
                        "ğŸ„ å¿…çœ‹ï¼šå†¬å­£é™å®šè–èª•ç‡ˆé£¾",
                        "ğŸ“¸ å¿…æ‹ï¼šé‹æ²³æ­¥é“å¤œæ™¯",
                        "ğŸ¦ å¿…åƒï¼šBlue Seal å†°æ·‡æ·‹"
                    ],
                    
                },
                travel: { mode: 'walk', time: '5åˆ†' }
            },
            {
                time: "21:00",
                leaveTime:"22:00", 
                title: "AEON åŒ—è°·åº—", 
                type: "spot", 
                parkingLink:"https://maps.app.goo.gl/HXg3HkHtTyqidARU6",
                imgUrl: "https://world.aeon-ryukyu.jp/wp-content/uploads/2019/06/ae99205041fa68889b7e95f1a7c4ab70.jpg", 
                guide: "å°±åœ¨ç¾åœ‹æ‘æ—é‚Šï¼Œè²·å®µå¤œã€æ°´æœã€ä¼´æ‰‹ç¦®ã€‚", 
                navLink: "https://maps.app.goo.gl/P6P6P6P6P6P6P6P6", 
                reviewLink:"https://maps.app.goo.gl/4jveh6ibcN4ccyst8",
                detailInfo: { 
                    desc: "é€™å®¶ AEON è¶…å¸‚å°±åœ¨ç¾åœ‹æ‘æ—é‚Šï¼Œéå¸¸å¤§é–“ä¸”ç‡Ÿæ¥­åˆ°å¾ˆæ™šã€‚å›é£¯åº—å‰ä¸€å®šè¦ä¾†é€™è£¡è²·<b>è‰è“ã€é£²æ–™ã€æ³¡éºµ</b>ç•¶å®µå¤œï¼ç†Ÿé£Ÿå€æ™šä¸Šæœƒæœ‰ç‰¹åƒ¹è²¼ç´™ã€‚", 
                    tags: ["è¶…å¸‚", "å®µå¤œ", "æ°´æœ", "ä¼´æ‰‹ç¦®"], 
                    highlights: ["ğŸ“ å¿…è²·ï¼šæ—¥æœ¬è‰è“/éºé¦™è‘¡è„", "ğŸ± å¿…æ¶ï¼šæ™šé–“ç‰¹åƒ¹ç†Ÿé£Ÿ", "ğŸº å¿…å–ï¼šOrion å•¤é…’", "ğŸ± å¿…è²·ï¼šè²“æ¢", "ğŸ³ å¿…è²·ï¼šéš”å¤©æ—©é¤"]
                },
                travel: { mode: 'walk', time: '10åˆ†' } 
            },
            { 
                time: "22:10",  
                title: "ç¾æ¿±æ—¥è½åº¦å‡é£¯åº—", 
                type: "hotel", 
                guide:"å¥½å¥½ä¼‘æ¯ï¼Œæ˜å¤©ä¹Ÿè¦æ—©èµ·ã€‚",
                navLink:"https://maps.app.goo.gl/L5yYrNiG5n3MxPyt9",
            },
            {
                time: "22:30",
                title: "æ˜å¤©åˆé¤æº–å‚™",
                type: "prep",
                guide: "ä¸‹è¼‰ã€Œå¤å®‡åˆ©è¦è¦é£¯ã€APPï¼Œæ˜å¤©å¯ä»¥é ç´„é»é¤ç¯€çœæ’éšŠæ™‚é–“ã€‚",
                appLink: {
                    url: "https://play.google.com/store/apps/details?id=com.newuplink.chain.tac906564&hl=zh_TW&pli=1",
                    text: "ä¸‹è¼‰ Kouri Shrimp",
                    icon: "fa-brands fa-google-play"
                }
            }
            
        ]
    },
    
    {
        date: "12/27ğŸ†", fullDate: "2025/12/27", day: "é€±å…­", weather: "â›… 22Â°C",
        events: [
            { time: "06:00", title: "èµ·åºŠ", type: "prep", guide: "æ—©é¤å¤–é¢è²·ï¼Œè»Šä¸Šåƒã€‚", departureTime: "07:30 å‡ºç™¼å¾€åŒ—éƒ¨", travel: { mode: 'drive', time: '45åˆ†' } },
            { 
                time: "08:30", 
                leaveTime: "09:30",
                title: "è¨±ç”°ä¼‘æ¯ç«™", 
                type: "spot", 
                parkingLink:"https://maps.app.goo.gl/5Xy34d2gowvcfwb57",
                
                // å°é¢åœ–
                imgUrl: "https://i0.wp.com/roundtripjp.com/wp-content/uploads/2023/03/P1040445.jpg?fit=1598%2C1200&ssl=1",
                
                guide: "å‰å¾€åŒ—éƒ¨çš„ã€Œå‹‡è€…è£œçµ¦ç«™ã€ï¼è²·å„ªæƒ é–€ç¥¨ã€åƒ10å††é¥…é ­ã€‚", 
                
                mapCode: "206 476 706*66", 
                // å°èˆª
                navLink: "https://maps.app.goo.gl/h3Q4S5k6L7P8X9jNA", 
                // google è©•è«–
                reviewLink: "https://maps.app.goo.gl/HRufTamPLLMRXkDr5", 
                // å®˜ç¶²
                link: "https://tisshuang.com/blog/post/yanbaru-b", 
                
                detailInfo: { 
                    desc: `<b>ğŸš— åŒ—éƒ¨è‡ªé§•çš„ RPG è£œçµ¦ç«™ï¼š</b><br>é€£çºŒå¤šå¹´è©•é¸ç‚ºæ—¥æœ¬æœ€å—æ­¡è¿ä¼‘æ¯ç«™ï¼ä¸åªæ˜¯ä¸Šå»æ‰€ï¼Œæ›´æ˜¯è²·è£å‚™(ç¥¨)ã€è£œè¡€(åƒ)çš„åœ°æ–¹ã€‚<br><br><b>ğŸ« çœéŒ¢å¿…æ®ºæŠ€ (åªæ”¶ç¾é‡‘!)ï¼š</b><br>å”®ç¥¨æ«ƒå°è²©å”®ç¾éº—æµ·æ°´æ—é¤¨ã€é³³æ¢¨åœ’ç­‰é–€ç¥¨ï¼Œç´„ä¾¿å®œ 10-20%ã€‚<b>âš ï¸æ³¨æ„ï¼šè²·ç¥¨åªæ”¶ç¾é‡‘ï¼</b><br><br><b>ğŸ¤¤ å¿…åƒä¸‰å¯¶ï¼š</b><br>1. <b>10å††é¥…é ­</b>ï¼šé»‘ç³–å¤–çš®åŒ…ç´…è±†ï¼Œç†±é¨°é¨°ä¸€å£ä¸€å€‹ (é©åˆè»Šä¸Šåƒ)ã€‚<br>2. <b>ä¸‰çŸ¢æœ¬èˆ–</b>ï¼šå¿…è²·<b>ã€Œé»ƒé‡‘çƒ (Dragon Ball)ã€</b>ï¼Œåƒéº»ç³¬æ³¢å ¤ä¸€æ¨£Qå½ˆã€‚<br>3. <b>Oppa å†°æ·‡æ·‹</b>ï¼šæ‰¾å¯æ„›ä¹³ç‰›LOGOï¼Œç‰§å ´ç›´é€è¶…æ¿ƒéƒã€‚<br><br><b>âš ï¸ è€å¸æ©Ÿäº¤é€šæé†’ï¼š</b><br>ä¼‘æ¯ç«™ä½æ–¼<b>å—ä¸‹è»Šé“</b>ã€‚åŒ—ä¸Š(å¾€æ°´æ—é¤¨)æ™‚ï¼Œéœ€<b>å³è½‰è·¨è¶Šå°å‘è»Šé“</b>é€²å…¥ï¼Œè«‹å‹™å¿…æ³¨æ„å®‰å…¨ï¼`, 
                    
                    tags: ["å„ªæƒ é–€ç¥¨", "åªæ”¶ç¾é‡‘", "é»å¿ƒ", "ä¼‘æ¯ç«™"], 
                    
                    highlights: [
                        "ğŸ« è²·ç¥¨ï¼šç¾éº—æµ·é–€ç¥¨ (è¨˜å¾—å¸¶ç¾é‡‘!)",
                        "ğŸ¥¯ å¿…åƒï¼š10å††é¥…é ­ (æƒ æ¯”å£½é¥…é ­)",
                        "ğŸ© ç”œé»ï¼šä¸‰çŸ¢æœ¬èˆ– é»ƒé‡‘çƒ (æ¯æ—¥é™é‡)",
                        "ğŸ¦ å†°å“ï¼šOppa ç‰›å¥¶å†°æ·‡æ·‹ (æ¿ƒéƒ!)ã€é®®å¥¶å¸ƒä¸"
                    ],
                    
                    menu: [
                        {n: "ç¾éº—æµ·é–€ç¥¨(å¤§äºº)", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥1,850"},
                        {n: "10å††é¥…é ­(10å€‹)", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥200~"},
                        {n: "é»ƒé‡‘çƒ(é–‹å£ç¬‘)", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥100"},
                        {n: "Oppaç‰›å¥¶å†°æ·‡æ·‹",j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«",  p: "Â¥100"}
                    ]
                }, 
                
                travel: { mode: 'drive', time: '30åˆ†' } 
            },
            { 
                time: "09:45", 
                leaveTime: "10:15",
                title: "Panchori-na éºµåŒ…åº—", 
                type: "eat", 
                
                // å°é¢åœ–ï¼šå¯æ„›çš„åº—é‹ªå¤–è§€
                imgUrl: "https://pingu.blog/wp-content/uploads/20240729234159_0_33a2c8.jpg",
                guide: "åƒå‰åœåŠ›é›»å½±çš„ç«¥è©±å°å±‹ï¼Œå¿…è²·è˜‘è‡éºµåŒ… (âš ï¸è·¯é‚Šåœè»Šå°å¿ƒ)ã€‚", 
                
                // â˜… é€£çµ
                mapCode: "206 598 724*06", 
                navLink: "hhttps://maps.app.goo.gl/Eu2Uym1Aj1TrwTB67",
                reviewLink: "https://maps.app.goo.gl/GBdpNjWFR12oH4vk9",
                link: "https://www.ningl.tw/panchori-na/", 
                
                detailInfo: { 
                    desc: `<b>ğŸ æ£®æ—è£¡çš„ç«¥è©±å°å±‹ï¼š</b><br>ä½æ–¼58è™Ÿå…¬è·¯æ—çš„å°å±±å¡ï¼Œè¢«ç¶ æ„åŒ…åœã€‚åº—å…§ç©ºé–“æ¥µå°ï¼ˆå€Ÿç‰©å°‘å¥³è‰¾è‰ç·¹æ„Ÿï¼‰ï¼Œå……æ»¿å¥¶æ²¹é¦™èˆ‡å®®å´é§¿å…¬ä»”ã€‚<br><br><b>ğŸ¥– å¿…è²·éºµåŒ…ï¼š</b><br>1. <b>ğŸ„ è˜‘è‡é€ å‹éºµåŒ…</b>ï¼šIG æ‰“å¡ç¥å™¨ï¼è¶…ç™‚ç™’ã€‚<br>2. <b>ğŸ› å’–å“©éºµåŒ…</b>ï¼šåœ¨åœ°äººæ¨ï¼Œå¤–é…¥å…§æ¿ƒã€‚<br>3. <b>ğŸŒ­ æ˜å¤ªå­æ³•åœ‹</b>ï¼šè¶Šåš¼è¶Šé¦™çš„ç¡¬å¼éºµåŒ…ã€‚<br><br><b>â˜• å°ç¢ºå¹¸ï¼š</b>é–€å£æœ‰ä¿æº«å£ºæä¾›<b>å…è²»å’–å•¡</b>ï¼Œè²·å®Œåœ¨é–€å£æ¿å‡³åƒè¶… Chillã€‚<br><br><b>âš ï¸ åœè»Šé™·é˜± (é§•é§›æ³¨æ„)ï¼š</b><br>åœè»Šå ´åœ¨åœ°å‹¢ç•¥æ–œçš„åº—é–€å£ï¼Œé€²å‡º 58 è™Ÿå…¬è·¯è»Šé€Ÿå¿«ï¼Œ<b>è«‹å‹™å¿…å°å¿ƒé§•é§›ï¼</b>åº—å…§ç‹¹çª„ï¼ŒåŒ…åŒ…è«‹èƒŒå‰é¢ã€‚`, 
                    
                    tags: ["å‰åœåŠ›é¢¨", "ç«¥è©±éºµåŒ…", "å…è²»å’–å•¡"], 
                    
                    highlights: [
                        "ğŸ„ å¿…è²·ï¼šè˜‘è‡é€ å‹éºµåŒ… (è¶…å¯æ„›)",
                        "ğŸ› æ¨è–¦ï¼šå’–å“©éºµåŒ… (é…¥è„†æ¿ƒéƒ)",
                        "â˜• ç¦åˆ©ï¼šé–€å£æä¾›å…è²»ç†±/å†°å’–å•¡",
                        "ğŸš— æ³¨æ„ï¼šåœè»Šå ´åœ¨è·¯é‚Šæ–œå¡ï¼Œé€²å‡ºå°å¿ƒ"
                    ],
                }, 
                
                travel: { mode: 'drive', time: '30åˆ†' } 
            },
            { 
                time: "10:45",
                leaveTime:"12:15", 
                title: "åˆé¤ï¼šå¤å®‡åˆ©è¦è¦é£¯", 
                type: "eat", 
                // â˜… å°é¢åœ–ï¼šæ‹›ç‰Œè¦è¦é£¯
                imgUrl: "https://kafu.tw/wp-content/uploads/2025/04/20%E5%8F%A4%E5%AE%87%E5%88%A9%E5%B3%B6%E8%9D%A6%E8%9D%A6%E9%A3%AF.jpg",
                guide: "å¤å®‡åˆ©å³¶å¿…åƒå¤§é­”ç‹ï¼Œå¤§è’œå¥¶æ²¹è¦é…ç„¡æ•µæµ·æ™¯ã€‚", 
                mapCode: "485 692 167*55", 
                // â˜… Google Maps
                navLink: "https://maps.app.goo.gl/V8AyNJUwt6LuoD359",
                reviewLink: "https://maps.app.goo.gl/eQr3Hez91ta9MR9C6",
                link: "https://kouri-shrimp.com/",
                
                detailInfo: { 
                    desc: `<b>ğŸ¤ æ²–ç¹©å¿…åƒå¤§é­”ç‹ï¼š</b><br>æºè‡ªå¤å¨å¤·çš„ç¶“å…¸ç¾é£Ÿï¼ç”¨å¤§é‡<b>å¤§è’œå¥¶æ²¹</b>çˆ†ç‚’é®®è¦ï¼Œé¦™æ°£æ¥µåº¦æ¿ƒéƒã€‚è¦å­å·²è²¼å¿ƒå»èƒŒå»è…¸ï¼Œæ®¼ç‚¸å¾—é…¥è„†ã€‚<br><br><b>ğŸ  ç²‰ç´…å»ºç¯‰ x å¤å®‡åˆ©è—ï¼š</b><br>å¾é¤è»Šé€²åŒ–æˆç²‰ç´…å»ºç¯‰ï¼ä¸€æ¨“é»é¤æ©Ÿé»é¤ï¼ˆæœ‰ä¸­æ–‡ï¼‰ï¼ŒäºŒæ¨“/ä¸‰æ¨“åŠæˆ¶å¤–å€å¯çœºæœ›å¤å®‡åˆ©å¤§æ©‹ç¾æ™¯ã€‚<br><br><b>ğŸ¦¸â€â™‚ï¸ æ²–ç¹©è¶…äººæ”»ç•¥ï¼š</b><br>1. <b>é¿é–‹å°–å³°</b>ï¼šå»ºè­° 11:00 é–‹é–€å°±å»ï¼Œæˆ– 15:00 å¾Œç•¶ä¸‹åˆèŒ¶ã€‚<br>2. <b>åœè»Š</b>ï¼šåœåœ¨åº—æ—çš„<b>å°ˆå±¬åœè»Šå ´</b>ï¼Œä¸è¦äº‚åœè·¯é‚Šã€‚<br>3. <b>å¿…æ‹</b>ï¼šé–€å£çš„ç¶“å…¸é¤è»Šè¨˜å¾—åˆç…§ï¼<br><br><b>ğŸ“œ å®Œæ•´èœå–® (é»åœ–æ”¾å¤§)ï¼š</b><br>
                        <img src="https://lh3.googleusercontent.com/d/1hAtzfM4CwZSfHQlxafMoynPKrtovh85S" class="w-full rounded-lg shadow-md mt-2 cursor-pointer hover:opacity-90 transition" onclick="openVoucherImage(this.src)" loading="lazy">`, 
                    
                    tags: ["å¤å®‡åˆ©å³¶", "æµ·æ™¯", "è¦è¦é£¯", "ä¸­æ–‡é»é¤æ©Ÿ"], 
                    
                    highlights: [
                        "ğŸ¤ ç¶“å…¸ï¼šåŸå‘³è’œé¦™ (å¥¶æ²¹è’œå‘³å¹³è¡¡)",
                        "ğŸŒ¶ï¸ æ¨è–¦ï¼šè¾£å‘³è’œé¦™ (é–‹èƒƒé‡å£å‘³)",
                        "ğŸ¥© è±ªè¯ï¼šè¦ç‰›é›™æ‹¼ (ä¸€æ¬¡æ»¿è¶³)",
                        "ğŸ“¸ æ™¯è‰²ï¼šäºŒæ¨“çœ‹æµ·åº§ä½ & é–€å£é¤è»Š"
                    ], 
                    menu: [
                        {n:"åŸå‘³å¤§è’œè¦é£¯", j:"ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚¬ãƒ¼ãƒªãƒƒã‚¯ã‚·ãƒ¥ãƒªãƒ³ãƒ—", p:"Â¥1,380"},
                        {n:"è¾£å‘³å¤§è’œè¦é£¯", j:"ã‚¹ãƒ‘ã‚¤ã‚·ãƒ¼ã‚¬ãƒ¼ãƒªãƒƒã‚¯ã‚·ãƒ¥ãƒªãƒ³ãƒ—", p:"Â¥1,480"},
                        {n:"åŸå‘³è¦ç‰›é›™æ‹¼çµ„åˆ", j:"ã‚·ãƒ¥ãƒªãƒ³ãƒ—ï¼†ãƒ“ãƒ¼ãƒ•", p:"Â¥2,060"},
                        {n:"è¾£å‘³è¦ç‰›é›™æ‹¼çµ„åˆ", j:"ã‚·ãƒ¥ãƒªãƒ³ãƒ—ï¼†ãƒ“ãƒ¼ãƒ•", p:"Â¥2,160"},
                    ] 
                }, 
                
                travel: { mode: 'drive', time: '15åˆ†' } 
            },
            { 
                time: "12:30",
                leaveTime: "13:00",
                title: "Shinmei Coffee", 
                type: "eat", 
                imgUrl: "https://tblg.k-img.com/restaurant/images/Rvw/304219/640x640_rect_bab2204cdff954349db6e87565d0e183.jpg",
                guide: "éš±è—ç‰ˆè²¨æ«ƒå±‹ï¼å¿…é»ã€Œç¾åˆ¨ç”Ÿé»‘ç³–æ‹¿éµã€ï¼Œç¨ç‰¹å¤§éµé‹çƒ˜è±†ã€‚", 
                navLink: "https://maps.app.goo.gl/8a8a8a8a8a8a", // è«‹æ›¿æ›ç‚ºæ­£ç¢ºé€£çµ
                reviewLink: "https://maps.app.goo.gl/8a8a8a8a8a8a",
                link: "https://tabelog.com/okinawa/A4702/A470202/47018681/",
                detailInfo: { 
                    desc: `
                        <b>ğŸ¥¤ IGçˆ†ç´…ï¼šç¾åˆ¨ç”Ÿé»‘ç³–æ‹¿éµ (Nama Brown Sugar Latte)</b><br>
                        é€™æ¯æ˜¯é®åº—ä¹‹å¯¶ï¼è€é—†æœƒæ‹¿å‡ºä¸€å¡Šç£šé ­èˆ¬çš„<b>ã€Œæ²–ç¹©ç´”é»‘ç³–ã€</b>ï¼Œç›´æ¥åœ¨ä½ é¢å‰<b>ã€Œåˆ·åˆ·åˆ·ã€ç¾åˆ¨</b>ï¼é»‘ç³–ç²‰åƒä¸‹é›ªä¸€æ¨£å †æˆä¸€åº§å°å±±ï¼Œå…‰çœ‹å°±ç™‚ç™’ã€‚<br><br>

                        ğŸ’¡ <b>å…§è¡Œå–æ³•ï¼š</b>å…ˆåˆ¥æ”ªæ‹Œï¼ç¬¬ä¸€å£ç›´æ¥å–ï¼Œæ„Ÿå—ä¸Šå±¤è„†è„†çš„é»‘ç³–ç²’èˆ‡ç¶¿å¯†å¥¶æ³¡ï¼Œä¹‹å¾Œå†æ”ªæ‹Œèå…¥å’–å•¡ã€‚<br><br>

                        <b>â˜• ç¨é–€çµ•æŠ€ï¼šå±±ç¾Šæ¹¯å¤§é‹çƒ˜è±†ï¼Ÿï¼</b><br>
                        åº—å "Shinmei" ä¾†è‡ªæ²–ç¹©æ–¹è¨€çš„ã€Œå¤§éµé‹ã€ã€‚è€é—†ä¸ç”¨æ©Ÿå™¨ï¼Œè€Œæ˜¯ç”¨ç…®å±±ç¾Šæ¹¯çš„å·¨å¤§éµé‹<b>ç›´ç«æ‰‹ç¶²ç…ç„™</b>ï¼Œè®“å’–å•¡è±†å¸¶æœ‰ä¸€ç¨®ç¨ç‰¹çš„ç„¦é¦™èˆ‡åšå¯¦æ„Ÿã€‚<br><br>

                        <b>ğŸšï¸ æ°›åœï¼š</b><br>
                        ä½æ–¼ä»Šæ­¸ä»æ‘é„‰é–“çš„é»‘è‰²è²¨æ«ƒå±‹ï¼Œå‘¨åœç¨®æ»¿æ¤ç‰©ï¼Œå¾ˆæœ‰æ–‡é’æ„Ÿã€‚é©åˆåœ¨å»æ°´æ—é¤¨å‰åœä¸‹ä¾†å……é›»ï¼
                    `, 
                    
                    tags: ["ç¾åˆ¨é»‘ç³–", "éµé‹çƒ˜è±†", "è²¨æ«ƒå±‹", "IGæ‰“å¡"], 
                    
                    highlights: [
                        "ğŸ¥¤ å¿…å–ï¼šç”Ÿé»‘ç³–æ‹¿éµ (è„†è„†é¡†ç²’æ„Ÿ)",
                        "ğŸ¦ æ¨è–¦ï¼šé¦™è‰ç”Ÿé»‘ç³–æ‹¿éµ (åŠ å†°æ·‡æ·‹)",
                        "ğŸ”¥ ç‰¹è‰²ï¼šä½¿ç”¨å·¨å¤§éµé‹ç›´ç«çƒ˜ç„™",
                        "ğŸ“¸ ç•«é¢ï¼šè€é—†ç¾åˆ¨é»‘ç³–çš„ç¬é–“"], 
                    menu: [
                        {n: "ç”Ÿé»‘ç³–æ‹¿éµ", j:"ç”Ÿé»’ç³–ãƒ©ãƒ†", p: "Â¥850"}, 
                        {n: "é¦™è‰ç”Ÿé»‘ç³–æ‹¿éµ", j:"ãƒãƒ‹ãƒ©ãƒ†ç”Ÿé»’ç³–", p: "Â¥750"},
                        {n: "ç”Ÿé»‘ç³–çç å¥¶èŒ¶", j:"", p: "Â¥850"},
                        {n: "æ‰‹æ²–é»‘å’–å•¡", j:"ãƒãƒ³ãƒ‰ãƒ‰ãƒªãƒƒãƒ—", p: "Â¥750"},
                        {n: "å†°æ·‡æ·‹", j:"", p: "Â¥500"},
                        {n: "å¯æœ—èŠ™", j:"", p: "Â¥500"}] 
                }, 
                travel: { mode: 'drive', time: '20åˆ†' } 
            },
            { 
                time: "13:20", 
                leaveTime: "15:55",
                title: "ç¾éº—æµ·æ°´æ—é¤¨", 
                type: "spot", 
                
                // å°é¢åœ–ï¼šé¯¨é¯Šç›´ç«‹é¤µé£Ÿçš„éœ‡æ’¼ç•«é¢
                imgUrl: "https://res.klook.com/images/fl_lossy.progressive,q_65/c_fill,w_1295,h_862/w_80,x_15,y_15,g_south_west,l_Klook_water_br_trans_yhcmh3/activities/qb7m4vacsvuz5zoedkse/%E5%86%B2%E7%BB%B3%E7%BE%8E%E4%B8%BD%E6%B5%B7%E6%B0%B4%E6%97%8F%E9%A6%86%E9%97%A8%E7%A5%A8.jpg",
                
                guide: "å¿…çœ‹15:00é¯¨é¯Šå‚ç›´é¤µé£Ÿç§€ï¼æˆ¶å¤–å¯è¦ªæ‰‹é¤µæµ·è±šã€‚", 
                
                mapCode: "553 075 797*77", 
                
                // å°èˆªèˆ‡é€£çµ
                navLink: "https://maps.app.goo.gl/ChuraumiMapLink", 
                reviewLink: "https://maps.app.goo.gl/ChuraumiReviewLink",
                link: "https://churaumi.okinawa/tc/",
                
                detailInfo: { 
                    desc: `
                        <b>ğŸ‹ 2.5å°æ™‚ç²¾è¯æˆ°ç•¥ (13:20-16:00)</b><br>
                        ç›®æ¨™æ˜¯<b>ã€Œé¯¨é¯Šè¦–è¦ºéœ‡æ’¼ã€+ã€Œæµ·è±šè¦ªå¯†æ¥è§¸ã€</b><br><br>

                        <b>ğŸ—ºï¸ å®Œç¾å‹•ç·šæ”»ç•¥ï¼š</b><br>
                        <b>13:30 å…¥å ´ (3F/4F)</b>ï¼šå…ˆè¡è§¸æ‘¸æ± æ‘¸æµ·æ˜Ÿ(æ´—æ‰‹å°åœ¨æ—é‚Š)ã€‚<br>
                        <b>14:45 å¡ä½ (2F)</b>ï¼šæŠµé”ã€Œé»‘æ½®ä¹‹æµ·ã€å¤§æ°´æ§½å‰ã€‚<br>
                        <span class="text-red-600 font-bold">ğŸ”¥ 15:00 é¯¨é¯Šé¤µé£Ÿç§€ (å¿…çœ‹!)</span>ï¼šé¯¨é¯Šå‚ç›´ç«‹èµ·å¤§å£å¸é£Ÿï¼Œéœ‡æ’¼åº¦ç ´è¡¨ï¼<br>
                        <b>15:15 å¾€æˆ¶å¤–è¡</b>ï¼šçœ‹å®Œç«‹åˆ»ç§»å‹•åˆ°æˆ¶å¤–æµ·é‚Šã€‚<br>
                        <b>15:30 æµ·è±šé¤µé£Ÿ (æµ·è±šæ½Ÿæ¹–)</b>ï¼šè¶•ä¸Šé¤µé£Ÿæ™‚æ®µï¼Œè¦ªæ‰‹é¤µæµ·è±šåƒé­šï¼Œé‚„èƒ½è¶…è¿‘åˆç…§ï¼<br><br>
                        <b>ğŸ¬ æµ·è±šç§€</b><br>
                           åœ°é»ï¼š æˆ¶å¤–çš„ã€Œæµ·è±šåŠ‡å ´ (Okichan Theater)ã€<br>
                           æ™‚é–“ï¼š 10:30 / 11:30 / 13:00 / 15:00 / 17:00 (æ¯å ´ç´„ 20 åˆ†é˜)ã€‚<br>
                           å°æ’‡æ­¥ï¼š èƒŒæ™¯å°±æ˜¯å¤§æµ·ï¼Œæ‹ç…§è¶…ç¾ã€‚å»ºè­°ææ—© 15-20 åˆ†é˜å»ä½”ä½å­ï¼Œä¸ç„¶åªèƒ½ç«™è‘—çœ‹ã€‚<br><br>

                        <b>ğŸ•µï¸ éš±è—ç‰ˆï¼šé»‘æ½®æ¢éšª</b><br>
                        å¦‚æœä¸ç´¯ï¼Œå¯ä»¥æ­å°ˆç”¨é›»æ¢¯åˆ°æ°´æ§½æ­£ä¸Šæ–¹ï¼Œè…³è¸©é€æ˜ç»ç’ƒçœ‹é¯¨é¯Šå¾è…³ä¸‹æ¸¸éï¼(é–‹æ”¾è‡³11:00æˆ–17:30å¾Œï¼Œä¸­é–“ä¼‘æ¯)<br><br>

                        <b>âš ï¸ æ²–ç¹©è¶…äººå°æ’‡æ­¥ï¼š</b><br>
                        <b>åœè»Š</b>ï¼šåœåœ¨ <b>P7 ç«‹é«”åœè»Šå ´</b> é›¢å…¥å£æœ€è¿‘ã€‚<br>
                    `, 
                    
                    tags: ["é¯¨é¯Šé¤µé£Ÿ", "æµ·è±šäº’å‹•", "é»‘æ½®ä¹‹æµ·", "é›¨å¤©å‚™æ¡ˆ"], 
                    
                    highlights: [
                        "ğŸ”¥ 15:00ï¼šé¯¨é¯Šå‚ç›´é¤µé£Ÿç§€ (æ”¾æ£„æµ·è±šç§€ä¹Ÿå€¼å¾—)",
                        "ğŸ¬ 15:30ï¼šè¦ªæ‰‹é¤µæµ·è±šé«”é©— (Dolphin Lagoon)",
                        "ğŸ•µï¸ ç§˜å¢ƒï¼šé»‘æ½®æ¢éšª (æ°´æ§½æ­£ä¸Šæ–¹ä¿¯ç°)",
                        "ğŸ‘ é«”é©—ï¼šè§¸æ‘¸æ±  (æµ·æ˜Ÿ/æµ·åƒ)"
                    ],
                    
                    menu: [
                        {n: "æµ·è±šé¤µé£Ÿé«”é©—", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥500"},
                        {n: "æµ·é¾œé¤µé£Ÿé«”é©—", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥500"},
                    ]
                }, 
                travel: { mode: 'drive', time: '50åˆ†' } 
            },
{ 
                time: "17:00", 
                leaveTime: "18:00",
                title: "æ™šé¤ï¼šObaa no Ya ç‡’è‚‰", 
                type: "eat", 
                title_detail: "Obaa no Ya (åè­·ç‡’è‚‰)", 
                
                // â˜… å°é¢åœ–ï¼šç‚­ç«ä¸ƒè¼ªèˆ‡ç‡’è‚‰
                imgUrl: "https://imgfp.hotp.jp/IMGH/79/14/P034627914/P034627914_238.jpg",
                
                guide: "ç™¾å¹´å¤æ°‘å®¶ç‚­ç«ç‡’è‚‰ï¼Œæœ€æœ‰æ²–ç¹©éˆé­‚çš„åº— (âš ï¸ç…™å¾ˆå¤§)ã€‚", 
                
                // â˜… è£œä¸Šé€£çµ
                mapCode: "206 598 371*14", 
                navLink: "https://maps.app.goo.gl/KjKjKjKjKjKjKjKj", // (ç¤ºæ„é€£çµ)
                reviewLink: "https://maps.app.goo.gl/KjKjKjKjKjKjKjKj",
                link: "https://tabelog.com/okinawa/A4702/A470201/47001327/", 
                
                bookingInfo: { 
                    code: "2QZLY2AV4K", 
                    note: "Tabelog é ç´„", 
                    // æ‚¨çš„ Google Drive æ†‘è­‰é€£çµ
                    driveLink: "https://drive.google.com/file/d/18WY990jEKlkvz1VmGCljkT07xTVBNPle/view?usp=drive_link"
                }, 
                
                detailInfo: { 
                    desc: `<b>ğŸ¡ èµ°é€²æ™‚å…‰éš§é“ï¼š</b><br>é€™æ˜¯æˆ‘å¿ƒç›®ä¸­<b>ã€Œæœ€æœ‰æ²–ç¹©éˆé­‚ã€</b>çš„ç‡’è‚‰åº—ï¼ç™¾å¹´ç´…ç“¦å¤æ°‘å®¶ï¼Œç”¨å‚³çµ±ã€Œä¸ƒè¼ª (ç‚­ç«é™¶çˆ)ã€åœ¨æ¦»æ¦»ç±³ä¸Šçƒ¤è‚‰ï¼Œæ°£æ°›åƒå›é˜¿å¬¤å®¶åƒé£¯ä¸€æ¨£æº«é¦¨ã€‚<br><br><b>ğŸ¥© å¿…åƒæ”»ç•¥ï¼š</b><br>1. <b>é˜¿å¤è±¬ (Agu Pork)</b>ï¼šæ²¹è„‚éå¸¸ç”œï¼çƒ¤åˆ°ç„¦è„†å®Œå…¨ä¸è†©ï¼Œæ²¾é¹½åƒåŸå‘³ã€‚<br>2. <b>é»‘æ¯›å’Œç‰›/æœ¬éƒ¨ç‰›</b>ï¼šç‰›èˆŒåšåˆ‡è¶…é¦™ï¼Œä¸Šç­‰ç‰›äº”èŠ±å¿…é»ã€‚<br>3. <b>æ‡¶äººæ¨è–¦</b>ï¼šç›´æ¥é»ã€ŒObaa no Ya å¥—é¤ã€ä¸€æ¬¡æ»¿è¶³ã€‚<br><br><b>âš ï¸ éœ‡æ’¼æ•™è‚² (å¿…è®€ï¼)ï¼š</b><br>å› ç‚ºæ˜¯è€å®…+ç‚­ç«ï¼Œæ’ç…™æœ‰é™ï¼Œ<b>ç…™éœ§éå¸¸å¤§ (High Smoke)</b>ï¼å…¨èº«100%æœƒæ²¾æ»¿çƒ¤è‚‰å‘³ï¼Œå»ºè­°<b>ä¸è¦ç©¿å¤ªåè²´çš„è¡£æœ</b>ã€‚`, 
                    
                    tags: ["å¤æ°‘å®¶", "ç‚­ç«ç‡’è‚‰", "é˜¿å¤è±¬", "ç…™éœ§ç€°æ¼«"], 
                    
                    highlights: [
                        "ğŸ¡ æ°£æ°›ï¼šç™¾å¹´è€å®… + æ¦»æ¦»ç±³ + ç‚­ç«ä¸ƒè¼ª",
                        "ğŸ· å¿…åƒï¼šé˜¿å¤è±¬æ‹¼ç›¤ (æ²¹è„‚è¶…ç”œ)",
                        "ğŸ® æ¨è–¦ï¼šå’Œç‰›ç‰›èˆŒã€ä¸Šç­‰ç‰›äº”èŠ±",
                        "âš ï¸ è­¦å‘Šï¼šç…™éå¸¸å¤§ï¼è«‹åšå¥½å…¨èº«çƒ¤è‚‰å‘³çš„æº–å‚™"
                    ],
                    
                    menu: [
                        {n: "Obaa no Ya å¥—é¤", p: "Â¥3,500~"},
                        {n: "é˜¿å¤è±¬æ‹¼ç›¤", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥2,800~"},
                        {n: "ä¸Šç­‰ç‰›äº”èŠ±", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥1,800"}
                    ] 
                }, 
                
                travel: { mode: 'drive', time: '40åˆ†' } 
            },
            { 
                time: "20:00", 
                title: "ç¾åœ‹æ‘ç…™ç«", 
                type: "spot", 
                
                // å°é¢åœ–ï¼šç¾éº—çš„ç…™ç«
                imgUrl: "https://visitokinawajapan.com/wp-content/uploads/2021/10/ev195_01_chura-umi-fireworks.jpg",
                
                guide: "é€±å…­é™å®š 3åˆ†é˜ç…™ç«ï¼(âš ï¸18:30 å¿…é ˆå¾ç‡’è‚‰åº—é›¢é–‹)",
                
                // â˜… å°èˆªè¨­å®šï¼šåŒ—è°·å…¬åœ’åœè»Šå ´ (é¿é–‹å¡è»Šå€)
                navLink: "https://maps.app.goo.gl/K9V7V7V7V7V7V7V7", // (ç¤ºæ„é€£çµï¼Œå¯¦éš›é»æ“Šæœƒæœå°‹ Chatan Park Parking)
                
                reviewLink: "https://maps.app.goo.gl/3J3J3J3J3J3J3J3J",
                link: "https://www.okinawa-americanvillage.com/?p=4082",
                
                detailInfo: {
                    desc: `
                        <b>ğŸ”¥ è¶•å ´ç”Ÿæ­»æˆ° (å¿…è®€ï¼)ï¼š</b><br>
                        <b>18:30 æº–æ™‚ä¸Šè»Šï¼Œç™¼å‹•å¼•æ“ï¼</b><br>
                        é€™æ˜¯é—œéµæ­»ç·šï¼Œæ™šäº†å°±åªèƒ½åœ¨è»Šä¸Šçœ‹ç…™ç«äº†ã€‚<br><br>
                        
                        <b>ğŸ›£ï¸ ç§»å‹•è·¯å¾‘ (Route)ï¼š</b><br>
                        1. <b>18:30</b> å¾ç‡’è‚‰åº—å‡ºç™¼ï¼Œå‰å¾€ <b>è¨±ç”° IC</b>ã€‚<br>
                        2. <b>å¿…èµ°é«˜é€Ÿå…¬è·¯ï¼</b> (è¨±ç”° IC â®• æ²–ç¹©å— IC)ã€‚åƒè¬åˆ¥èµ° 58 è™Ÿçœé“ã€‚<br>
                        3. ä¸‹äº¤æµé“å¾Œå¾€åŒ—è°·æ–¹å‘ï¼Œæœ€å¾Œä¸€æ®µè·¯è»Šå¤šè«‹è€å¿ƒã€‚<br><br>

                        <b>ğŸ…¿ï¸ åœè»Šæ”»ç•¥ (ä¸è¦åœ Depot Islandï¼)ï¼š</b><br>
                        åƒè¬ä¸è¦è²ªå¿ƒæƒ³åœå¾ˆè¿‘ï¼Œé‚£æ˜¯å¡è»Šé»‘æ´ï¼<br>
                        æ¨è–¦ <b>P1ï¼šåŒ—è°·å…¬åœ’é§è»Šå ´</b> (é€²å‡ºè¼ƒä¸å¡ï¼Œèµ°5-8åˆ†åˆ°æµ·é‚Š)ã€‚<br>
                        æ¨è–¦ <b>P2ï¼šAEON åŒ—è°·åº—</b> (è²·æ±è¥¿æ–¹ä¾¿ï¼Œèµ°10åˆ†)ã€‚<br><br>

                        <b>ğŸ† Plan B (å¡è»Šå‚™æ¡ˆ)ï¼š</b><br>
                        å¦‚æœ 19:55 é‚„åœ¨è·¯ä¸Šï¼Œåˆ¥æ…Œï¼åœ¨ <b>58 è™Ÿå…¬è·¯</b> æˆ– <b>å®‰è‰¯æ³¢æµ·ç˜</b> é™„è¿‘ï¼Œæ–ä¸‹è»Šçª—å¾€æµ·é‚Šçœ‹ä¹Ÿçœ‹å¾—åˆ°ï¼
                    `,
                    
                    tags: ["ç…™ç«", "é€±å…­é™å®š", "åœè»Šæ”»ç•¥"],
                    
                    highlights: [
                        "â° æ­»ç·šï¼š18:30 æº–æ™‚ç™¼å‹•å¼•æ“",
                        "ğŸ›£ï¸ è·¯ç·šï¼šè¨±ç”° IC â®• æ²–ç¹©å— IC (èµ°é«˜é€Ÿ!)",
                        "ğŸ…¿ï¸ åœè»Šï¼šåŒ—è°·å…¬åœ’é§è»Šå ´ (é¿é–‹å¡è»Šé»‘æ´)",
                        "ğŸ† å‚™æ¡ˆï¼šä¾†ä¸åŠå°±åœ¨ 58è™Ÿå…¬è·¯ä¸Šçœ‹"
                    ],   
                },
                travel: { mode: 'walk', time: '10åˆ†' } 
            },
            {
                time: "21:00",
                leaveTime:"22:00", 
                title: "AEON åŒ—è°·åº—", 
                type: "spot", 
                imgUrl: "https://world.aeon-ryukyu.jp/wp-content/uploads/2019/06/ae99205041fa68889b7e95f1a7c4ab70.jpg", 
                guide: "å°±åœ¨ç¾åœ‹æ‘æ—é‚Šï¼Œè²·å®µå¤œã€æ°´æœã€ä¼´æ‰‹ç¦®ã€‚", 
                navLink: "https://maps.app.goo.gl/P6P6P6P6P6P6P6P6", 
                reviewLink:"https://maps.app.goo.gl/4jveh6ibcN4ccyst8",
                detailInfo: { 
                    desc: "é€™å®¶ AEON è¶…å¸‚å°±åœ¨ç¾åœ‹æ‘æ—é‚Šï¼Œéå¸¸å¤§é–“ä¸”ç‡Ÿæ¥­åˆ°å¾ˆæ™šã€‚å›é£¯åº—å‰ä¸€å®šè¦ä¾†é€™è£¡è²·<b>è‰è“ã€é£²æ–™ã€æ³¡éºµ</b>ç•¶å®µå¤œï¼ç†Ÿé£Ÿå€æ™šä¸Šæœƒæœ‰ç‰¹åƒ¹è²¼ç´™ã€‚", 
                    tags: ["è¶…å¸‚", "å®µå¤œ", "æ°´æœ", "ä¼´æ‰‹ç¦®"], 
                    highlights: ["ğŸ“ å¿…è²·ï¼šæ—¥æœ¬è‰è“/éºé¦™è‘¡è„", "ğŸ± å¿…æ¶ï¼šæ™šé–“ç‰¹åƒ¹ç†Ÿé£Ÿ", "ğŸº å¿…å–ï¼šOrion å•¤é…’", "ğŸ± å¿…è²·ï¼šè²“æ¢", "ğŸ³ å¿…è²·ï¼šéš”å¤©æ—©é¤"]
                },
                travel: { mode: 'walk', time: '10åˆ†' } 
            },
            { 
                time: "22:10",  
                title: "ç¾æ¿±æ—¥è½åº¦å‡é£¯åº—", 
                type: "hotel", 
                guide:"å¥½å¥½ä¼‘æ¯ï¼Œæ˜å¤©ä¹Ÿè¦æ—©èµ·ã€‚",
                navLink:"https://maps.app.goo.gl/L5yYrNiG5n3MxPyt9",
            },
            
        ]
    },
    {
        date: "12/28", fullDate: "2025/12/28", day: "é€±æ—¥", weather: "ğŸŒ§ï¸ 20Â°C",
        events: [
            { time: "06:00", title: "èµ·åºŠ & é€€æˆ¿", type: "prep", guide: "11:00 å‰é€€æˆ¿ã€‚", departureTime: "07:30 å‡ºç™¼", travel: { mode: 'drive', time: '30åˆ†' } },
            { 
                // â˜… è¡Œç¨‹äºŒé¸ä¸€ (A&Wæ¸¯ç‰§åº— vs é”æ‘©å¯º)
                time: "08:00",
                leaveTime: "09:00", 
                title: "è¡Œç¨‹äºŒé¸ä¸€", 
                type: "choice", 
                choices: [
                    {
                        title: "A&W æ¸¯ç‰§åº—",
                        type: "eat",
                        // å°é¢åœ–ï¼šæ›æˆç‰§æ¸¯åº—ç¶“å…¸çš„ Drive-in æ‹›ç‰Œ
                        imgUrl: "https://trip.opqr.info/wp-content/uploads/2022/06/IMG_20220605_163721-1.jpg", 
                        
                        guide: "ç±³æ´¥ç„å¸«MVè–åœ°ï¼ç¾å¼å¾©å¤ Drive-in æ——è‰¦åº—ï¼Œé™„è¨­å…’ç«¥å…¬åœ’ã€‚",
                        travelTime: "é–‹è»Š 30åˆ†",
                        
                        // å°èˆªé€£çµ
                        navLink: "https://maps.app.goo.gl/pQ1J8Q1J8Q1J8Q1J", 
                        reviewLink: "https://maps.app.goo.gl/pQ1J8Q1J8Q1J8Q1J", 
                        link: "https://www.awok.co.jp/shopsearch/makiminato/", 
                        
                        detailInfo: {
                            desc: `
                                <b>ğŸ‡ºğŸ‡¸ æ²–ç¹©æœ€å¼·ç¾å¼æ——è‰¦åº—ï¼š</b><br>
                                é€™ä¸æ˜¯æ™®é€šçš„é€Ÿé£Ÿåº—ï¼Œæ˜¯æ“æœ‰<b>è¶…å¤§è‰çš®èˆ‡éŠæ¨‚å€</b>çš„æ——è‰¦åº—ï¼ä¿ç•™äº† 60 å¹´ä»£ç¶“å…¸çš„<b>ã€ŒDrive-In (è»Šé“é»é¤)ã€</b>æœå‹™ï¼Œè»Šå­åœå°ˆå±¬æ ¼å­ï¼ŒæŒ‰å°è¬›æ©Ÿé»é¤ï¼Œåº—å“¡ç›´é€è»Šé‚Šï¼<br><br>
                                
                                <b>âœ¨ ç‚ºä»€éº¼ä¸€å®šè¦ä¾†é€™é–“ï¼Ÿ</b><br>
                                1. <b>è–åœ°å·¡ç¦®</b>ï¼šç±³æ´¥ç„å¸«ã€Šå†è¦‹ï¼Œæœ‰ä¸€å¤©ï¼ã€‹MV å–æ™¯åœ°ã€‚<br>
                                2. <b>è¦ªå­å¤©å ‚</b>ï¼šæˆ¶å¤–æœ‰æºœæ»‘æ¢¯ã€æ²™å‘ï¼Œå¤§äººåƒæ¼¢å ¡ï¼Œå°å­©æ”¾é›»ã€‚<br>
                                3. <b>æ‰“å¡ç‰†</b>ï¼šæ©˜æ£•è‰²å¾©å¤æ‹›ç‰Œé…ä¸Šéœ“è™¹ç‡ˆï¼Œæ™šä¸Šæ‹èµ·ä¾†è¶…æœ‰æ°£æ°›ã€‚<br><br>
                                
                                <b>ğŸº å…§è¡Œåƒæ³•ï¼š</b><br>
                                å¿…é» <b>Root Beer (éº¥æ ¹æ²™å£«)</b>ï¼Œå…§ç”¨<b>ç„¡é™çºŒæ¯</b>ï¼å‘³é“åƒè²¼å¸ƒ(ç¬‘)ï¼Œæ€•çš„äººå¯ä»¥é»æ¼‚æµ®å£å‘³(åŠ å†°æ·‡æ·‹)ã€‚<br><br>
                                
                                <b>ğŸ”” æº«é¦¨å°ç§˜å¯†ï¼š</b><br>
                                é›¢é–‹å‰è¨˜å¾—æŒ‰é–€å£çš„<b>ã€ŒThank You Bellã€</b>ï¼Œåº—å“¡è½åˆ°æœƒç†±æƒ…è·Ÿä½ èªªå†è¦‹å–”ï¼
                            `,
                            
                            tags: ["ç¾å¼å¾©å¤", "Drive-in", "ç„¡é™çºŒæ¯", "MVè–åœ°"],
                            
                            highlights: [
                                "ğŸ” å¿…åƒï¼šThe A&W Burger (æ–™è¶…å¤š/å«ä¹³é…ª)",
                                "ğŸº å¿…å–ï¼šéº¥æ ¹æ²™å£« (å…§ç”¨ç„¡é™çºŒæ¯)",
                                "ğŸŸ é»å¿ƒï¼šåœˆåœˆè–¯æ¢ (Curly Fries)",
                                "ğŸ“¸ å¿…æ‹ï¼šå¾©å¤éœ“è™¹ç‡ˆæ‹›ç‰Œ & å…’ç«¥å…¬åœ’"
                            ],
                            
                            menu: [
                                {n: "The A&Wæ¼¢å ¡", j:"The A&Wãƒãƒ¼ã‚¬ãƒ¼", p: "Â¥790"},
                                {n: "è«æœ­ç‘æ‹‰èµ·å¸å ¡", j:"ãƒ¢ãƒƒãƒ„ã‚¡ãƒãƒ¼ã‚¬ãƒ¼", p: "Â¥590"},
                                {n: "éº¥æ ¹æ²™å£«(ç„¡é™çºŒ)", j:"ãƒ«ãƒ¼ãƒˆãƒ“ã‚¢", p: "Â¥300"},
                                {n: "åœˆåœˆè–¯æ¢", j:"ã‚«ãƒ¼ãƒªãƒ¼ãƒ•ãƒ©ã‚¤", p: "Â¥350"}
                            ]
                        }
                    },
                    {
                        title: "é”æ‘©å¯º (è¥¿ä¾†é™¢)",
                        type: "spot",
                        // å°é¢åœ–ï¼šæ»¿æ»¿çš„é”æ‘©
                        imgUrl: "https://i0.wp.com/boo2k.com/wp-content/uploads/2025/11/20251027-2K4A9885.jpg", 
                        
                        guide: "éš±è—ç‰ˆç¶²ç¾æ™¯é»ï¼æ»¿æ»¿ç´…è‰²é”æ‘©ç‰† & è¿·ä½ åƒæœ¬é³¥å±…ï¼Œæ–¬æƒ¡ç·£æ±‚è‰¯ç·£ã€‚",
                        travelTime: "é–‹è»Š 30åˆ†", // æˆ– èµ°è·¯ 6åˆ† (è¦–å‰ä¸€å€‹è¡Œç¨‹è€Œå®š)
                        
                        // å°èˆªé€£çµ (è¥¿ä¾†é™¢)
                        navLink: "https://maps.app.goo.gl/WyqQ3Z5Z5Z5Z5Z5Z", 
                        // google è©•è«–
                        reviewLink: "https://maps.app.goo.gl/WyqQ3Z5Z5Z5Z5Z5Z", 
                        // ä»‹ç´¹
                        link: "https://www.naha-contents.com/spot/sairaiin/", 
                        
                        detailInfo: {
                            desc: `
                                <b>â›©ï¸ å……æ»¿å–œæ°£çš„éš±è—ç‰ˆæ™¯é»ï¼š</b><br>
                                é€™è£¡ä¸æ˜¯åš´è‚…çš„å¤§å¯ºå»Ÿï¼Œè€Œæ˜¯å……æ»¿ç´…è‰²é”æ‘©ã€è¶…ç´šå¯æ„›çš„åœ°æ–¹ï¼é›–ç„¶ä¸å¤§ï¼Œä½†æœ€è¿‘åœ¨ç¤¾ç¾¤ä¸Šå¾ˆç´…ï¼Œé©åˆé †è·¯ä¾†æ‹ç¾ç…§ã€æ±‚é‹æ°£ã€‚<br><br>

                                <b>ğŸ“¸ ä¸‰å¤§å¿…æ‹ç‰¹è‰²ï¼š</b><br>
                                1. <b>é”æ‘©ç‰† (Daruma)</b>ï¼šä¸€é€²å»å°±çœ‹åˆ°å¤§å¤§å°å°çš„ç´…è‰²ä¸å€’ç¿ï¼Œéå¸¸å£¯è§€ç™‚ç™’ï¼<br>
                                2. <b>è¿·ä½ åƒæœ¬é³¥å±…</b>ï¼šä¸ç”¨å»äº¬éƒ½ï¼Œé€™è£¡ä¹Ÿæœ‰ä¸€æ’ç´…è‰²é³¥å±…éš§é“ï¼Œé›–ç„¶æ˜¯è¿·ä½ ç‰ˆï¼Œä½†æ‹èµ·ä¾†å»¶ä¼¸æ„Ÿå¾ˆå¥½ã€‚<br>
                                3. <b>æ–¬æƒ¡ç·£ãƒ»çµè‰¯ç·£</b>ï¼šä¾›å¥‰ã€Œä¸å‹•æ˜ç‹ã€ï¼Œæ“šèªªèƒ½æ–¬æ–·çˆ›æ¡ƒèŠ±ã€å£ç¿’æ…£(æˆ’è¸é…’)æˆ–ç–¾ç—…ï¼Œä¸¦æ‹›ä¾†å¥½ç·£åˆ†ã€‚<br><br>
                                
                                <b>ğŸ“ åƒæ‹œå°æ’‡æ­¥ï¼š</b><br>
                                â— <b>è¨±é¡˜é”æ‘©</b>ï¼šè²·å›å®¶å¾Œï¼Œå…ˆç•«å·¦çœ¼è¨±é¡˜ï¼Œå¯¦ç¾å¾Œå†ç•«å³çœ¼(é–‹çœ¼)ã€‚<br>
                                â— <b>é‡è¼•çŸ³</b>ï¼šè¨±é¡˜å¾Œæ¬çŸ³é ­ï¼Œè¦ºå¾—æ¯”æƒ³åƒä¸­<b>è¼•</b>ä»£è¡¨é¡˜æœ›å®¹æ˜“å¯¦ç¾ã€‚<br>
                                â— <b>ç”Ÿè‚–å®ˆè­·</b>ï¼šå±¬<b>å…”ã€ç‹—ã€è±¬</b>çš„äººï¼Œé€™è£¡æ˜¯ä½ çš„æœ¬å‘½å®ˆè­·å¯ºï¼Œè¨˜å¾—ç‰¹åˆ¥æ‹œä¸€ä¸‹ï¼<br><br>

                                <b>ğŸ“ å¯¦ç”¨è³‡è¨Šï¼š</b><br>
                                ä½æ–¼é¦–é‡ŒåŸé™„è¿‘ (å–®è»Œé¦–é‡Œç«™èµ°6åˆ†)ï¼Œ<b>å…é–€ç¥¨</b>ï¼Œæœ‰å…è²»åœè»Šå ´ (ä½†è·¯çª„è«‹å°å¿ƒ)ã€‚
                            `,
                            
                            tags: ["é”æ‘©ç‰†", "è¿·ä½ é³¥å±…", "æ–¬æƒ¡ç·£", "å…é–€ç¥¨",],
                            
                            highlights: [
                                "ğŸ“¸ å¿…æ‹ï¼šæ»¿æ»¿çš„ç´…è‰²é”æ‘©ä¸å€’ç¿",
                                "â›©ï¸ å¿…æ‹ï¼šè¿·ä½ ç‰ˆç´…è‰²åƒæœ¬é³¥å±…",
                                "ğŸ™ ç¥ˆç¦ï¼šæ–·çˆ›æ¡ƒèŠ± / æˆ’å£ç¿’æ…£",
                                "ğŸ° å®ˆè­·ï¼šå…”/ç‹—/è±¬ ç”Ÿè‚–æœ¬å‘½å¯º"
                            ],
                            
                            // æŠŠå¾¡å®ˆç•¶ä½œ Menu é¡¯ç¤º
                            menu: [
                                {n: "é”æ‘©å¾¡å®ˆ", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥500~"},
                                {n: "è¨±é¡˜å°é”æ‘©", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥500"},
                                {n: "å¯«ç¡ƒå°", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥300"},
                                {n: "åƒè§€è²»", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥0 (å…è²»)"}
                            ]
                        }
                    }
                ],
                travel: { mode: 'drive', time: '30åˆ†' } 
            },
            { 
                time: "09:30",
                leaveTime: "11:00", // å»ºè­°åœç•™æ™‚é–“æ‹‰é•·ä¸€é»
                title: "ç€¨é•·å³¶ Umikaji", 
                type: "spot", 
                
                // å°é¢åœ–ï¼šç»å…¸çš„ç™½è‰²éšæ¢¯èˆ‡æµ·æ™¯
                imgUrl: "https://d1grca2t3zpuug.cloudfront.net/2025/07/SenakaIsland_03-870x500-1756279185.webp",
                guide: "æ²–ç¹©å°å¸Œè‡˜ï¼ç´”ç™½éšæ¢¯çœ‹æµ·ã€è¿‘è·é›¢çœ‹é£›æ©Ÿ (âš ï¸æ˜“å¡è»Š)ã€‚", 
                mapCode: "33 002 605*15", 
                
                // é€£çµè¨­å®š
                navLink: "https://maps.app.goo.gl/kX7X7X7X7X7X7X7X", 
                reviewLink: "https://maps.app.goo.gl/kX7X7X7X7X7X7X7X", 
                link: "https://www.umikajiterrace.com/",
                
                detailInfo: { 
                    desc: `
                        <b>ğŸ›ï¸ æ²–ç¹©çš„å°å¸Œè‡˜ (Santorini)ï¼š</b><br>
                        ä¾å±±è€Œå»ºçš„ç´”ç™½å»ºç¯‰ç¾¤é…ä¸Šç„¡æ•µæµ·æ™¯ï¼Œéš¨ä¾¿æ‹éƒ½åƒåœ¨æ­æ´²æ¸¡å‡ï¼é€™è£¡èšé›†äº†40å¤šé–“ç‰¹è‰²å°åº—ï¼Œé‚„æœ‰å¾ˆå¤šåº—å®¶å°ˆé–€ç…§é¡§çš„<b>è¦ªäººæµæµªè²“</b>ï¼Œè²“å¥´å¿…å»ï¼ğŸˆ<br><br>

                        <b>ğŸ¥ çµ•å°ç‹è€…ç¾é£Ÿï¼š</b><br>
                        1. <b>å¹¸ç¦é¬†é¤… (A Happy Pancake)</b>ï¼šå£æ„Ÿåƒé›²æœµï¼<br>
                        <span class="text-red-500 font-bold">âš ï¸ æ”»ç•¥ï¼šç¾å ´æ’è¦1-2å°æ™‚ï¼Œå¼·çƒˆå»ºè­°å…©é€±å‰å®˜ç¶²é ç´„ï¼Œæˆ–å¹³æ—¥ä¸€æ—©è¡ã€‚</span><br>
                        2. <b>æ³›æ¿«æ¼¢å ¡</b>ï¼šè‚‰æ±æ»¿æ»¿çš„å·¨å¤§æ¼¢å ¡ï¼Œé©åˆç”·ç”Ÿã€‚<br>
                        3. <b>Taco Rice Cafe</b>ï¼šæ­å§†è›‹å¡”å¯é£¯é…æµ·æ™¯ã€‚<br><br>

                        <b>âœˆï¸ é£›æ©Ÿè¿·å¤©å ‚ & é¾ç¥ä¹‹æ¹¯ï¼š</b><br>
                        é€™è£¡åœ¨é‚£éœ¸æ©Ÿå ´è·‘é“æ­£å°é¢ï¼Œèƒ½é«”é©—<b>é£›æ©Ÿå¾é ­é ‚å‘¼å˜¯è€Œé</b>çš„éœ‡æ’¼ï¼<br>
                        å±±é ‚é£¯åº—å…§é‚„æœ‰è‘—åçš„<b>ã€Œç«™ç«‹å¼æº«æ³‰ (ç«‹æ¹¯)ã€</b>ï¼Œéä½å®¢ä¹Ÿèƒ½ä»˜è²»é€²å»æ³¡ï¼Œé‚Šæ³¡é‚Šçœ‹å¤•é™½ã€‚<br><br>

                        <b>âš ï¸ æ²–ç¹©è¶…äººç´…è‰²è­¦å ± (äº¤é€š)ï¼š</b><br>
                        ç€¨é•·å³¶<b>åªæœ‰ä¸€æ¢è¯å¤–é“è·¯</b>ï¼å¹³æ—¥å‚æ™šæˆ–é€±æœ«<b>éå¸¸å®¹æ˜“å¡è»Š</b> (å¡åˆ°æ‡·ç–‘äººç”Ÿ)ã€‚<br>
                        ğŸ’¡ <b>è‰¯å¿ƒå»ºè­°ï¼š</b> å¦‚æœè¦è¶•é£›æ©Ÿï¼Œçµ•å°ä¸è¦æŠŠé€™è£¡æ’åœ¨èµ·é£›å‰ 3 å°æ™‚å…§ï¼Œå¾ˆå¯èƒ½è¶•ä¸ä¸Šï¼
                    `, 
                    
                    tags: ["å°å¸Œè‡˜", "çœ‹é£›æ©Ÿ", "è²“å¥´å¤©å ‚", "æ˜“å¡è»Š"], 
                    
                    highlights: [
                        "ğŸ¥ å¿…åƒï¼šå¹¸ç¦é¬†é¤… (å‹™å¿…é ç´„/ææ‹‰ç±³è˜‡å‘³)",
                        "ğŸ“¸ å¿…æ‹ï¼šç™½è‰²éšæ¢¯ x è”šè—å¤§æµ·",
                        "âœˆï¸ é«”é©—ï¼šè¿‘è·é›¢çœ‹é£›æ©Ÿèµ·é™ (å¼•æ“è²éœ‡æ’¼)",
                        "â™¨ï¸ äº«å—ï¼šé¾ç¥ä¹‹æ¹¯ (ç«™è‘—æ³¡æº«æ³‰)",
                        "âš ï¸ è­¦å‘Šï¼šè¯å¤–é“è·¯æ˜“å¡è»Šï¼Œè¶•é£›æ©Ÿæ³¨æ„"
                    ],
                    
                    menu: [
                        {n: "å¹¸ç¦é¬†é¤…", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥1,100~"},
                        {n: "æ³›æ¿«æ¼¢å ¡", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥1,200~"},
                        {n: "é¾ç¥ä¹‹æ¹¯(å¹³æ—¥)", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥1,500"},
                        {n: "èŠ’æœå†°æ²™", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥800"}
                    ]
                }, 
                travel: { mode: 'drive', time: '30åˆ†' } 
            },
            { 
                time: "11:30", title: "åˆé¤äºŒé¸ä¸€", type: "choice", 
                choices: [ 
                    { 
                        title: "å±‹å®œå®¶ (å¤æ°‘å®¶æ²–ç¹©éºµ)", 
                        type: "eat", 
                        
                        // å°é¢åœ–ï¼šå±‹å®œå®¶ç¶“å…¸çš„ç´…ç“¦å±‹é ‚èˆ‡çŸ³ç…å­
                        imgUrl: "https://sillybaby.tw/wp-content/uploads/20170607223955_56.jpg",
                        
                        guide: "åœ¨ã€Œåœ‹å®¶æ–‡åŒ–è²¡ã€è£¡åƒéºµï¼å¿…é»ç¢§ç¶ è‰²æµ·è—»éºµï¼Œæ‡·èˆŠæ°›åœæ»¿åˆ†ã€‚", 
                        
                        travelTime: "é–‹è»Š 40åˆ†",
                        
                        // å°èˆªèˆ‡é€£çµ
                        mapCode: "232 463 459*65",
                        navLink: "https://maps.app.goo.gl/YagiyaLocationLink", // è®“ç³»çµ±è‡ªå‹•æœå°‹
                        reviewLink: "https://maps.app.goo.gl/YagiyaReviewLink",
                        link: "https://www.neos-design.com/yagiya/", // å®˜ç¶²
                        
                        detailInfo: { 
                            desc: `
                                <b>ğŸ¡ åœ¨å¤è¹Ÿè£¡åƒé£¯ï¼š</b><br>
                                é€™ä¸åªæ˜¯ä¸€é–“é¤å»³ï¼Œæ›´æ˜¯ä¸€åº§<b>ã€Œæ—¥æœ¬åœ‹å®¶æœ‰å½¢æ–‡åŒ–è²¡ã€</b>ï¼<br>
                                é€™è£¡æ˜¯å±‹ä¸»çš„ç™¾å¹´ç¥–åï¼Œä¿ç•™äº†æˆ°å¾ŒåˆæœŸçš„ç´…ç“¦å±‹é ‚ã€çŸ³ç‰†(Hinpun)èˆ‡çŸ³ç…å­ã€‚ååœ¨é€šé¢¨è‰¯å¥½çš„æ¦»æ¦»ç±³ä¸Šï¼Œçœ‹è‘—åº­é™¢åƒéºµï¼Œé€™å°±æ˜¯æœ€é“åœ°çš„æ²–ç¹©æ…¢ç”Ÿæ´»ã€‚<br><br>

                                <b>ğŸœ å¿…åƒï¼šæµ·è—»éºµ (Asa Soba)</b><br>
                                é€™æ˜¯é€™è£¡çš„ç¨å®¶æ‹›ç‰Œï¼éºµæ¢æ‰å…¥äº†æ²–ç¹©ç‰¹ç”¢<b>ã€ŒçŸ³è“´ (æµ·è—»)ã€</b>ï¼Œå‘ˆç¾æ·¡æ·¡çš„ç¶ è‰²ï¼Œæ¹¯é ­å……æ»¿å¤§æµ·æ¸…é¦™ã€‚æ¨è–¦é»<b>ã€Œå¥—é¤ (Set)ã€</b>ï¼Œé™„ä»€éŒ¦é£¯(Juicy)å’Œå°èœï¼ŒCPå€¼å¾ˆé«˜ï¼<br><br>
                                
                                <b>ğŸ§ ç”œé»åˆ¥éŒ¯éï¼š</b><br>
                                é£¯å¾Œä¸€å®šè¦ä¾†ä¸€ç¢—<b>ã€Œé»‘ç³–é»ƒè±†ç²‰å–„å“‰ã€</b>(æ²–ç¹©ç´…è±†å†°)ï¼Œæ¶ˆæš‘åˆè§£è†©ã€‚<br><br>

                                <b>ğŸ“ å¯¦ç”¨è³‡è¨Šï¼š</b><br>
                                ä½æ–¼å…«é‡ç€¨ç”ºçš„ç”˜è”—ç”°èšè½è£¡ï¼Œä½ç½®éš±å¯†ã€‚<br>
                                <b>Mapcode: 232 463 459*65</b><br>
                                âš ï¸ <b>æ³¨æ„ï¼š</b>äººæ°£ååº—ï¼Œå°–å³°æ™‚æ®µ(12:00-13:00)éœ€æ’éšŠï¼Œå»ºè­° 11:00 é–‹é–€æˆ– 13:30 å¾Œå†å»ã€‚
                            `, 
                            
                            tags: ["åœ‹å®¶æ–‡åŒ–è²¡", "æµ·è—»éºµ", "å¤æ°‘å®¶", "è¦ªå­å‹å–„"], 
                            
                            highlights: [
                                "ğŸ¡ æ°›åœï¼šç™»éŒ„æœ‰å½¢æ–‡åŒ–è²¡ (ç´…ç“¦å¤å)",
                                "ğŸœ å¿…é»ï¼šæµ·è—»éºµå¥—é¤ (Asa Soba Set)",
                                "ğŸ§ ç”œé»ï¼šé»‘ç³–é»ƒè±†ç²‰å–„å“‰ (ç´…è±†å†°)",
                                "ğŸ¦´ é¸é …ï¼šè±†ä¹³éºµ / æœ¬å®¶æ’éª¨éºµ"
                            ],
                            
                            menu:[
                                {n:"æµ·è—»éºµå¥—é¤", j:"ã‚¢ãƒ¼ã‚µãã°ã‚»ãƒƒãƒˆ", p:"Â¥1,100~"},
                                {n:"æœ¬å®¶æ’éª¨éºµ", j:"æœ¬ã‚½ãƒ¼ã‚­ãã°", p:"Â¥950"},
                                {n:"é»‘ç³–é»ƒè±†ç²‰å–„å“‰", j:"é»’èœœããªç²‰ãœã‚“ã–ã„", p:"Â¥400"}
                            ] 
                        } 
                    }, 
                    { 
                        title: "ç¾©å¤§åˆ©éºµ THE SLOW", 
                        type: "eat", 
                        // å°é¢ç…§ç‰‡ï¼šç”Ÿç¾©å¤§åˆ©éºµèˆ‡è³ªæ„Ÿç©ºé–“
                        imgUrl: "https://tabelog.com/imgview/original?id=r63151313851915",
                        
                        guide: "ç³¸æ»¿æ™‚å°šç¶ æ´²ï¼å¿…åƒQå½ˆç”Ÿç¾©å¤§åˆ©éºµï¼Œé é›¢å¡µå›‚çš„å„ªé›…åˆé¤ã€‚", 
                        
                        travelTime: "é–‹è»Š 20åˆ†", // å¾ç€¨é•·å³¶/Outletéå»å¤§ç´„çš„æ™‚é–“
                        
                        // å°èˆªé€£çµ
                        navLink: "https://maps.app.goo.gl/9Q5Q5Q5Q5Q5Q5Q5Q", // (è«‹ç¢ºèªå¯¦éš›é€£çµ)
                        // google è©•è«–  
                        reviewLink: "https://maps.app.goo.gl/9Q5Q5Q5Q5Q5Q5Q5Q", 
                        // ä»‹ç´¹
                        link: "https://tabelog.com/tw/okinawa/A4704/A470402/47033230/", 
                        
                        detailInfo: { 
                            desc: `
                                <b>ğŸ ç³¸æ»¿å¸‚çš„æ™‚å°šç¶ æ´²ï¼š</b><br>
                                å¦‚æœä½ ç©è†©äº†è§€å…‰å€ï¼Œæƒ³æ‰¾å€‹å„ªé›…çš„åœ°æ–¹å¥½å¥½åƒé£¯ï¼Œé€™è£¡çµ•å°æ˜¯é¦–é¸ï¼<br>
                                åº—å…§å……æ»¿ç¾ä»£è¨­è¨ˆæ„Ÿï¼Œè·Ÿå‘¨é‚Šå‚³çµ±è¡—é“å½¢æˆå¼·çƒˆå°æ¯”ã€‚ä¸€é–‹é–€å°±åƒèµ°é€²å¦ä¸€å€‹ä¸–ç•Œï¼Œæ°›åœéå¸¸æ”¾é¬†ã€‚<br><br>
                                
                                <b>ğŸ½ï¸ å¿…åƒï¼šç”Ÿç¾©å¤§åˆ©éºµ (Fresh Pasta)</b><br>
                                è·Ÿä¸€èˆ¬ä¹¾ç‡¥éºµæ¢ä¸åŒï¼Œé€™è£¡ä¸»æ‰“<b>ã€Œç”Ÿéºµã€</b>ï¼Œå£æ„Ÿéå¸¸ <b>Q å½ˆæœ‰åš¼å‹ (Al Dente)</b>ï¼ä¸»å»šæœƒæ ¹æ“šé†¬æ±ï¼ˆç´…é†¬/ç™½é†¬/æ¸…ç‚’/å’Œé¢¨ï¼‰æ­é…ä¸åŒç²—ç´°å½¢ç‹€çš„éºµæ¢ï¼Œéå¸¸è¬›ç©¶ã€‚<br><br>

                                <b>ğŸ° å®Œç¾å¥é»ï¼š</b><br>
                                åˆé¤å¥—é¤é™„çš„æ²™æ‹‰è‰²å½©ç¹½ç´›ï¼Œæ‹ç…§è¶…ç¾ã€‚é¤å¾Œå¼·çƒˆæ¨è–¦åŠ é»<b>ã€Œææ‹‰ç±³è˜‡ã€</b>ï¼Œé…ä¸Šä¸€æ¯å’–å•¡ï¼Œé€™æ‰æ˜¯åº¦å‡è©²æœ‰çš„æ¨£å­ã€‚<br><br>

                                <b>ğŸ“ å¯¦ç”¨è³‡è¨Šï¼š</b><br>
                                ä½æ–¼å—éƒ¨ç³¸æ»¿å¸‚ï¼Œå¾ˆé©åˆå®‰æ’åœ¨å»<b>ã€ŒDMM æ°´æ—é¤¨ã€</b>ã€<b>ã€Œç‰æ³‰æ´ã€</b>æˆ–<b>ã€ŒOutletã€</b>çš„åŒä¸€å¤©ã€‚<br>
                                âš ï¸ <b>æ³¨æ„ï¼š</b>é€±ä¸€é€šå¸¸å…¬ä¼‘ï¼Œé™„è¿‘æ²’æœ‰å¤§å‹å°ˆç”¨åœè»Šå ´ï¼Œéœ€åœ¨å‘¨é‚Šæ‰¾ä¸€ä¸‹ä»˜è²»æˆ–å…¬å…±è»Šä½ã€‚
                            `, 
                            
                            tags: ["ç”Ÿç¾©å¤§åˆ©éºµ", "è³ªæ„Ÿé¤é…’é¤¨", "ç³¸æ»¿ç¾é£Ÿ",], 
                            
                            highlights: [
                                "ğŸ æ‹›ç‰Œï¼šæ¯æ—¥ç‰¹è£½ç”Ÿç¾©å¤§åˆ©éºµ (Qå½ˆå£æ„Ÿ)",
                                "ğŸ¥— å¥—é¤ï¼šé™„ç¹½ç´›æ²™æ‹‰ (è¦–è¦ºå‘³è¦ºé›™äº«å—)",
                                "ğŸ° ç”œé»ï¼šææ‹‰ç±³è˜‡ (Tiramisu)",
                                "ğŸº æ°›åœï¼šç¾ä»£è¨­è¨ˆæ„Ÿï¼Œé é›¢è§€å…‰å®¢"
                            ],
                            
                            menu:[
                                {n:"åˆé¤ç¾©å¤§åˆ©éºµå¥—é¤", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p:"Â¥1,400~"},
                                {n:"ç¶“å…¸ææ‹‰ç±³è˜‡", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p:"Â¥600"},
                                {n:"å†°å’–å•¡", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p:"Â¥450"}
                            ] 
                        } 
                    }  
                ],
                travel: { mode: 'drive', time: '30åˆ†' } 
            },
            { 
                time: "14:00",
                leaveTime:"16:30", 
                title: "Gangalaä¹‹è°· å°è¦½", 
                type: "spot", 
                
                // å°é¢åœ–ï¼šå·¨å¤§çš„æ¦•æ¨¹ (å¤§ä¸»ç´°è‘‰æ¦•)
                imgUrl: "https://gangala.com/wp-content/uploads/2021/11/main_img_01.jpg",
                
                guide: "åœ¨é˜ä¹³çŸ³æ´å–å’–å•¡ï¼ç©¿è¶Šè¬å¹´åŸå§‹æ£®æ—ï¼Œå¿…çœ‹å·¨å¤§æ¦•æ¨¹ (âš ï¸éœ€æå‰20åˆ†å ±åˆ°)ã€‚", 
                
                mapCode: "232 495 330*28", 
                
                bookingInfo: { 
                    code: "0Y0BGC4I", 
                    note: "Nutmeg é ç´„", 
                    driveLink: "https://drive.google.com/file/d/1INEKGZkeFmle8EsCNkY7BCETvtdZUgpt/view?usp=drive_link"
                }, 
                
                navLink: "https://maps.app.goo.gl/GangalaMapLink", // è®“ç³»çµ±è‡ªå‹•æœå°‹
                link: "https://gangala.com/",
                
                detailInfo: { 
                    desc: `
                        <b>ğŸ¦‡ ç¬¬ä¸€ç«™ï¼šCave Cafe (å ±åˆ°èˆ‡ç­‰å¾…)</b><br>
                        é€™è£¡æ˜¯å°è¦½é›†åˆé»ï¼Œè«‹å‹™å¿…<b>ææ—© 20-30 åˆ†é˜</b>æŠµé”ã€‚å ±åˆ°å¾Œï¼Œå¯ä»¥åæ­£è¨€é †åœ°ååœ¨é˜ä¹³çŸ³æ´è£¡å–å’–å•¡ï¼<br>
                        <b>å¿…é»æ¨è–¦ï¼š</b><br>
                        â˜• <b>35 Coffee (çŠç‘šå’–å•¡)</b>ï¼šæ²–ç¹©é™å®šï¼Œç”¨é¢¨åŒ–çŠç‘šçƒ˜ç„™ï¼Œé †ä¾¿åšå…¬ç›Šã€‚<br>
                        ğŸ¹ <b>æ‰¶æ¡‘èŠ±è˜‡æ‰“</b>ï¼šç´…è‰²çš„æ°£æ³¡é£²ï¼Œåœ¨æ´ç©´è£¡æ‹ç…§è¶…ç¾ã€‚<br><br>

                        <b>ğŸ¦• ç¬¬äºŒç«™ï¼šåœ°å¿ƒæ¢éšª (ç´„1hr 20min)</b><br>
                        å°è¦½å“¡æœƒå¸¶éšŠå‡ºç™¼ï¼Œå¾ç¾ä»£ç¬é–“ç©¿è¶Šåˆ°å¹¾è¬å¹´å‰çš„äºç†±å¸¶æ£®æ—ï¼Œå·¨å¤§çš„ç«¹æ—å’Œå§‘å©†èŠ‹éå¸¸æœ‰<b>ä¾ç¾…ç´€å…¬åœ’</b>çš„æ„Ÿè¦ºã€‚<br>
                        <b>âœ¨ é«˜æ½®äº®é»ï¼šå¤§ä¸»ç´°è‘‰æ¦• (Ufushu Gajumaru)</b><br>
                        é«˜é”20å…¬å°ºçš„å·¨å¤§æ¦•æ¨¹ï¼Œæ°£æ ¹å‚è½åœ°é¢ï¼Œæ°£å ´éå¸¸å¼·å¤§ï¼Œè¨˜å¾—å¤šæ‹å¹¾å¼µç…§ï¼<br><br>

                        <b>âš ï¸ æ²–ç¹©è¶…äººé‡è¦å®åš€ï¼š</b><br>
                        1. <b>å»æ‰€</b>ï¼šå‡ºç™¼å‰ä¸€å®šè¦åœ¨ Cave Cafe ä¸Šå»æ‰€ï¼é€²å…¥å±±è°·å¾Œ<b>å…¨ç¨‹ç„¡å»æ‰€</b>ã€‚<br>
                        2. <b>ç©¿è‘—</b>ï¼šè«‹ç©¿<b>å¥½èµ°çš„é‹å­</b>ï¼Œåƒè¬åˆ¥ç©¿é«˜è·Ÿé‹ã€‚<br>
                        3. <b>é˜²èšŠ</b>ï¼šæ£®æ—èšŠå­å¤šï¼Œå»ºè­°ç©¿è–„é•·è¢–æˆ–è‡ªå‚™é˜²èšŠæ¶²ã€‚<br>
                        4. <b>èªè¨€</b>ï¼šå ±åˆ°æ™‚è¨˜å¾—è·Ÿæ«ƒå°å€Ÿ<b>ã€Œä¸­æ–‡èªéŸ³å°è¦½æ©Ÿã€</b>ã€‚
                    `, 
                    
                    tags: ["é˜ä¹³çŸ³å’–å•¡", "å·¨å¤§æ¦•æ¨¹", "ä¾ç¾…ç´€å…¬åœ’", "ä¸­æ–‡å°è¦½"], 
                    
                    highlights: [
                        "â˜• é«”é©—ï¼šCave Cafe (åœ¨é˜ä¹³çŸ³æ´å–å’–å•¡)",
                        "ğŸŒ³ å¿…æ‹ï¼šå¤§ä¸»ç´°è‘‰æ¦• (æ°£å ´å¼·å¤§)",
                        "ğŸ¦´ æ­·å²ï¼šæ¸¯å·äººè€ƒå¤ç¾å ´",
                        "âš ï¸ æ³¨æ„ï¼šå‡ºç™¼å‰å‹™å¿…å…ˆä¸Šå»æ‰€"
                    ],
                    
                    menu: [
                        {n: "35 Coffee (çŠç‘šå’–å•¡)", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥500"},
                        {n: "æ‰¶æ¡‘èŠ±è˜‡æ‰“", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥500"},
                        {n: "å°è¦½è²»ç”¨(å·²é ç´„)", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥2,500"}
                    ]
                }, 
                travel: { mode: 'drive', time: '20åˆ†' } 
            },
            { 
                time: "17:00", 
                leaveTime: "18:00",
                title: "å¥§æ­¦å³¶", 
                type: "eat", 
                
                // å°é¢åœ–ï¼šå¥§æ­¦å³¶å¤§æ©‹èˆ‡æ¸…æ¾ˆæµ·æ°´
                imgUrl: "https://res.klook.com/images/fl_lossy.progressive,q_65/c_fill,w_1200,h_630/w_80,x_15,y_15,g_south_west,l_klook_water/activities/t7x6x3x3x3x3x3/Okinawa-Oujima-Tempura.jpg", 
                
                guide: "è²“å¥´å¤©å ‚ï¼å¤§å•–éŠ…æ¿åƒ¹å¤©å©¦ç¾…ï¼Œå°å¿ƒè€é·¹æ¶é£Ÿ (âš ï¸ğŸ¦…è­¦å ±)ã€‚", 
                
                mapCode: "232 468 336*41", 
                navLink: "https://maps.app.goo.gl/OuJimaMapLink", 
                
                detailInfo: { 
                    desc: `
                        <b>ğŸ¤ å¤©å©¦ç¾…èˆ‡è²“å’ªä¹‹å³¶ï¼š</b><br>
                        éå€‹æ©‹å°±åˆ°ï¼é€™è£¡åªè¦ç¹ä¸€åœˆ5åˆ†é˜ï¼Œå»æ˜¯å—éƒ¨äººæ°£æœ€é«˜çš„é †éŠé»ã€‚<br>
                        é€™è£¡çš„å¤©å©¦ç¾…éºµè¡£è¼ƒåšã€å£æ„ŸåƒéºµåŒ…è»ŸQï¼Œæœ¬èº«æœ‰èª¿å‘³ä¸ç”¨æ²¾é†¬å°±å¥½åƒï¼<br><br>

                        <b>ğŸ”¥ å…©å¤§ååº—äºŒé¸ä¸€ï¼š</b><br>
                        1. <b>ä¸­æœ¬é®®é­šå¤©å©¦ç¾…</b>ï¼šæ©‹é‚Šå³æ‰‹é‚Šï¼Œæ’éšŠååº—ï¼Œå£å‘³é¸æ“‡è¶…å¤šã€‚<br>
                        2. <b>å¤§åŸå¤©å©¦ç¾…</b>ï¼šå³¶çš„å¦ä¸€å´ï¼Œæœ‰æˆ¶å¤–åº§ä½å¯çœ‹æµ·ï¼Œæ°£æ°›æ‚ é–’ã€‚ï¼ˆç¬¬å››å€‹é€±æ—¥æœªç‡Ÿæ¥­ï¼‰<br><br>

                        <b>ğŸŒŠ å¥§æ­¦è— (Ou Blue)ï¼š</b><br>
                        åˆ¥å…‰é¡§è‘—åƒï¼Œæ©‹ä¸‹çš„æµ·æ°´é€æ˜åº¦è¶…é«˜ï¼å¤å¤©å¸¸æœ‰å°å­©è·³æ°´ã€‚<br><br>

                        <b>ğŸ¦… æ²–ç¹©è¶…äººç”Ÿå­˜è­¦å‘Š (å¿…è®€ï¼)ï¼š</b><br>
                        <span class="text-red-600 font-bold text-lg">å°å¿ƒè€é·¹ (Kites)ï¼ï¼ï¼</span><br>
                        é€™è£¡çš„è€é·¹æœ‰ç·´éã€Œä¿¯è¡æ¶é£Ÿã€ï¼Œ<b>åƒè¬ä¸è¦é‚Šèµ°é‚ŠæŠŠé£Ÿç‰©èˆ‰é«˜</b>ï¼Œç‚¸è¦æœƒç¬é–“è¢«æŠ“èµ°(æ‰‹é‚„æœƒå—å‚·)ï¼<br>
                        ğŸ’¡ <b>å¼·çƒˆå»ºè­°ï¼š</b>èº²åœ¨æœ‰å±‹ç°·çš„åœ°æ–¹åƒï¼Œæˆ–éš¨æ™‚ä¿æŒè­¦æˆ’ã€‚
                    `, 
                    
                    tags: ["éŠ…æ¿ç¾é£Ÿ", "è²“å³¶", "å¥§æ­¦è—", "è€é·¹è­¦å ±"], 
                    
                    highlights: [
                        "ğŸ¤ å¿…åƒï¼šæ²–ç¹©å¤©å©¦ç¾… (ä¸­æœ¬/å¤§åŸ)",
                        "ğŸˆ ç™‚ç™’ï¼šéš¨è™•å¯è¦‹çš„è¦ªäººå³¶è²“",
                        "ğŸ¦… è­¦å‘Šï¼šå°å¿ƒè€é·¹ä¿¯è¡æ¶é£Ÿï¼",
                        "ğŸ“¸ ç¾æ™¯ï¼šæ¸…æ¾ˆè¦‹åº•çš„å¥§æ­¦è—æµ·æ°´"
                    ],
                    
                    menu: [
                        {n: "ç‚¸é­šå¤©å©¦ç¾…", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥100"},
                        {n: "ç‚¸èŠ±æå¤©å©¦ç¾…", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥100"},
                        {n: "ç‚¸ç´…èŠ‹å¤©å©¦ç¾…", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥100"},
                        {n: "ç‚¸æ°´é›²å¤©å©¦ç¾…", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥100"}
                    ]
                }, 
                travel: { mode: 'drive', time: '60åˆ†' } 
            },
            { 
                time: "18:45", title: "æ±æ©«INN é‚£éœ¸æ—­æ©‹", type: "hotel", mapCode: "33 126 733*12",
                bookingInfo: { 
                    code: "5892799 / 5892800", 
                    note: "æœƒå“¡å¡ (ç¾å ´ä»˜)" 
                },
                travel: { mode: 'walk', time: '10åˆ†' }
            },
            { 
                time: "19:00", 
                leaveTime: "21:00", 
                title: "æ™šé¤ï¼šé³¥è²´æ—", 
                type: "eat", 
                
                // å°é¢åœ–ï¼šé³¥è²´æ—ç¶“å…¸çš„é»ƒè‰²æ‹›ç‰Œæˆ–è²´æ—ç‡’
                imgUrl: "https://lh3.googleusercontent.com/p/AF1QipNqW_S5gCNuYJgK4d_WJpW_S5gCNuYJgK4d_WJp=s680-w680-h510", 
                
                guide: "2024æ–°ç™»é™¸ï¼å…¨å“é …Â¥370ï¼Œå¿…é»å·¨ç„¡éœ¸é›è‚‰ä¸² & é‡œé£¯ (âš ï¸å¯ä¸­æ–‡é»é¤)ã€‚", 
                
                // å°èˆªï¼šè¨­å®šæœå°‹é‚£éœ¸é™„è¿‘çš„é³¥è²´æ— (æ—­æ©‹ç«™é™„è¿‘æœ‰ä¸€é–“ï¼Œé›¢ä½ å€‘é£¯åº—å¾ˆè¿‘)
                navLink: "https://www.google.com/maps/search/%E9%B3%A5%E8%B2%B4%E6%97%8F+%E9%82%A3%E8%A0%B8", 
                reviewLink: "https://www.google.com/maps/search/%E9%B3%A5%E8%B2%B4%E6%97%8F+%E9%82%A3%E8%A0%B8", 
                link: "https://www.torikizoku.co.jp/", 
                
                detailInfo: { 
                    desc: `
                        <b>ğŸº 2024 çµ‚æ–¼ç™»é™¸æ²–ç¹©ï¼</b><br>
                        æ—¥æœ¬æœ€å¼·é€£é–å±…é…’å±‹éœ¸ä¸»ï¼ç‰¹è‰²å°±æ˜¯<b>ã€Œç°¡å–®ç²—æš´ã€</b>ï¼Œèœå–®ä¸Šæ‰€æœ‰æ±è¥¿(å«é…’)é€šé€š<b>å‡ä¸€åƒ¹ Â¥370 (å«ç¨…)</b>ã€‚ä¸ç”¨ç®—éŒ¢ç®—åˆ°é ­ç—›ï¼Œé»10æ¨£å°±æ˜¯3700å††ï¼<br><br>

                        <b>ğŸ”¥ å¿…é»ä¸‰ç¥å™¨ (è·Ÿè‘—é»ä¸è¸©é›·)ï¼š</b><br>
                        1. <b>åç‰©ï¼è²´æ—ç‡’ (Kizoku-yaki)</b>ï¼šé®åº—ä¹‹å¯¶ï¼ä¸€ç›¤å…©å¤§ä¸²ï¼Œä»½é‡æ˜¯æ™®é€šçš„3å€ã€‚æ¨è–¦é¸<b>ã€Œé†¬ç‡’ (Tare)ã€</b>å£å‘³ã€‚<br>
                        2. <b>é‡œé£¯ (Kamameshi)</b>ï¼šâš ï¸ <b>é€²åº—ç¬¬ä¸€ä»¶äº‹å…ˆé»ï¼</b>å› ç‚ºç”Ÿç±³ç¾ç…®è¦ç­‰30åˆ†é˜ã€‚æ¹¯é ­é®®ç¾é‚„æœ‰é‹å·´ã€‚<br>
                        3. <b>é«˜éº—èœ (Kyabetsu)</b>ï¼šæ·‹ä¸Šç‰¹è£½é…¸é†¬ï¼Œ<b>ç„¡é™å…è²»çºŒç›¤</b>ï¼è§£è†©ç¥å™¨ã€‚<br><br>

                        <b>ğŸ’° é…’é¬¼æ”»ç•¥ï¼šé» MEGA æ‰åˆ’ç®—ï¼</b><br>
                        æ—¢ç„¶éƒ½ä¸€æ¨£éŒ¢ï¼Œç•¶ç„¶è¦é»å¤§æ¯çš„ï¼èœå–®ä¸Šå¯«<b>ã€ŒMEGA é‡‘éº¥ã€</b>æˆ–<b>ã€ŒMEGA Highballã€</b>å®¹é‡å…©å€å¤§ï¼Œä¸€æ¨£ Â¥370ã€‚<br><br>

                        <b>ğŸ“± é»é¤æ–¹å¼ï¼š</b><br>
                        æ¯æ¡Œéƒ½æœ‰å¹³æ¿ï¼Œæ”¯æ´<b>ç¹é«”ä¸­æ–‡</b>ï¼Œåœ–ç‰‡å¤§åˆæ¸…æ¥šï¼Œä¸ç”¨è·Ÿåº—å“¡è¬›æ—¥æ–‡ï¼Œç¤¾æå‹å–„ï¼
                    `, 
                    
                    tags: ["å…¨å“é …Â¥370", "ä¸­æ–‡å¹³æ¿", "ç„¡é™é«˜éº—èœ"], 
                    
                    highlights: [
                        "ğŸ”¥ å¿…é»ï¼šè²´æ—ç‡’ (å·¨ç„¡éœ¸é›ä¸²/é†¬ç‡’)",
                        "ğŸš å¿…é»ï¼šé‡œé£¯ (å…¥åº§å…ˆé»!éœ€ç­‰30åˆ†)",
                        "ğŸ¥— ç¦åˆ©ï¼šé«˜éº—èœ (ç„¡é™å…è²»çºŒç›¤)",
                        "ğŸº åˆ’ç®—ï¼šMegaé‡‘éº¥/Highball (åŠ é‡ä¸åŠ åƒ¹)"
                    ],
                    
                    menu: [
                        {n: "åç‰©è²´æ—ç‡’(2ä¸²)", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥370"},
                        {n: "é›æ¹¯é‡œé£¯", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥370"},
                        {n: "é«˜éº—èœ(ç„¡é™çºŒ)", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥370"},
                        {n: "Megaé‡‘éº¥å•¤é…’", j:"ã‚·ãƒŠãƒ¢ãƒ³ãƒ­ãƒ¼ãƒ«", p: "Â¥370"}
                    ]
                }, 
                travel: { mode: 'walk', time: '5åˆ†' } 
            },
            { time: "21:10",leaveTime:"23:30", title: "åœ‹éš›é€š", type: "spot", guide: "è³¼ç‰©ã€‚", travel: { mode: 'drive', time: '8åˆ†' } },
            { time: "24:00", title: "æ±æ©«INN é‚£éœ¸æ—­æ©‹", type: "hotel", guide:"æ—©é»ä¼‘æ¯ã€‚"}, 
        ]
    },
    {
        date: "12/29", fullDate: "2025/12/29", day: "é€±ä¸€", weather: "â˜€ï¸ 23Â°C",
        events: [
            { time: "07:00", title: "èµ·åºŠ & æ—©é¤", type: "prep", guide: "é£¯åº—æ—©é¤ã€‚10:00 å‰é€€æˆ¿ã€‚", departureTime: "10:30 å‡ºç™¼", travel: { mode: 'drive', time: '20åˆ†' } },
            { time: "10:30", title: "Ashibinaa Outlet", type: "spot", mapCode: "232 544 452*22", guide: "é‹å‹•å“ç‰Œã€GAP éƒ½å¾ˆä¾¿å®œã€‚", travel: { mode: 'drive', time: '15åˆ†' } },
            { time: "13:30", title: "OTS é‚„è»Š", type: "trans", guide: "åŠ æ»¿æ²¹å†é‚„è»Šï¼æ­æ¥é§è»Šå»æ©Ÿå ´ã€‚", travel: { mode: 'trans', time: '20åˆ†' } },
            { time: "14:30", title: "æ©Ÿå ´åˆé¤", type: "eat", guide: "è±¬è‚‰è›‹é£¯ç³°ã€‚" },
            { 
                time: "16:55", title: "å›ç¨‹é£›æ©Ÿ (FD231)", type: "trans", title_detail: "æ³°åœ‹äºèˆª FD231", 
                bookingInfo: { 
                    code: "1616324336315022", 
                    note: "Trip.com", 
                    extra: "é‚£éœ¸æ©Ÿå ´ I | 20kg è¨—é‹ / 7kg æ‰‹æ",
                    driveLink: "https://drive.google.com/file/d/1iScNq9RHqi_l-JYoXhKnhk8Btu-4gTaG/view?usp=drive_link" 
                }, 
                guide: "é‚£éœ¸ I -> æ¡ƒæ©Ÿ T1ã€‚ææ—© 2.5 å°æ™‚åˆ°ã€‚" 
            }
        ]
    }
];

        // --- 4. æ ¸å¿ƒé‚è¼¯ ---
       function init() {
    if (!currentRole) {
        document.getElementById('role-selector').classList.remove('hidden');
        document.getElementById('role-selector').classList.add('flex');
    } else {
        // --- 1. æ¢å¾©ä¸Šæ¬¡ç€è¦½ç‹€æ…‹ ---
        const lastTab = sessionStorage.getItem('lastTab');
        const lastDateIdx = sessionStorage.getItem('lastDateIdx');
        const lastScrollY = sessionStorage.getItem('lastScrollY');

        // æ¢å¾©æ—¥æœŸé¸æ“‡
        if (lastDateIdx !== null) selectedDateIndex = parseInt(lastDateIdx);
        
        // æ¢å¾©åˆ†é  (å¦‚æœæ²’æœ‰ç´€éŒ„ï¼Œé è¨­ç‚º home)
        if (lastTab) {
            currentTab = lastTab;
            // æ›´æ–°åº•éƒ¨å°èˆªæŒ‰éˆ•æ¨£å¼
            document.querySelectorAll('.nav-item').forEach(btn => { 
                btn.classList.remove('active', 'text-orange-500'); 
                btn.classList.add('text-gray-400'); 
            }); 
            if (currentTab !== 'home') {
                const btn = document.getElementById(`btn-${currentTab}`);
                if(btn) btn.classList.replace('text-gray-400', 'text-orange-500');
            }
        }

        // æ ¹æ“šåˆ†é æ¸²æŸ“å…§å®¹
        if (currentTab === 'schedule') renderSchedule();
        else if (currentTab === 'shopping') renderShopping();
        else if (currentTab === 'budget') renderBudget();
        else if (currentTab === 'vouchers') renderVouchers();
        else renderHome();

        setupRealtimeListeners();

        // --- 2. æ¢å¾©æ²å‹•ä½ç½® (å»¶é²åŸ·è¡Œï¼Œç­‰å¾…ç•«é¢æ¸²æŸ“å®Œç•¢) ---
        if (lastScrollY) {
            setTimeout(() => {
                window.scrollTo(0, parseInt(lastScrollY));
            }, 100); // 100æ¯«ç§’å¾Œæ²å‹•ï¼Œç¢ºä¿å…§å®¹å·²é•·å‡ºä¾†
        }
    }

    // Auto Calc for Budget (ä¿æŒåŸæœ‰é‚è¼¯)
    const exPrice = document.getElementById('in-ex-price');
    const exQty = document.getElementById('in-ex-qty');
    if (exPrice && exQty) {
        function updateExTotal() {
            const p = parseInt(exPrice.value) || 0;
            const q = parseInt(exQty.value) || 1;
            const total = p * q;
            document.getElementById('calc-total').innerText = total.toLocaleString();
            document.getElementById('calc-twd').innerText = Math.round(total * JPY_RATE).toLocaleString();
        }
        exPrice.addEventListener('input', updateExTotal);
        exQty.addEventListener('input', updateExTotal);
    }
}

        function selectRole(role) {
            currentRole = role; localStorage.setItem('user_role', role);
            document.getElementById('role-selector').classList.add('hidden');
            document.getElementById('role-selector').classList.remove('flex');
            renderHome();
            const roleIcons = { driver: 'ğŸš—', copilot: 'ğŸ—ºï¸', tourist: 'ğŸ“¸', admin: 'ğŸ“' };
            document.getElementById('header-icon').innerText = roleIcons[role] || 'ğŸ¦';
        }
        function clearRole() { localStorage.removeItem('user_role'); location.reload(); }
        function setupRealtimeListeners() { if(db) { db.ref('shoppingList').on('value', () => { if(currentTab === 'shopping') renderShopping(); }); db.ref('expenses').on('value', () => { if(currentTab === 'budget') renderBudget(); }); } }

       // --- Render: Home ---
function renderHome() {
    const container = document.getElementById('app');
    const now = currentSimulatedDate ? new Date(currentSimulatedDate) : new Date();
    const todayStr = `${now.getFullYear()}/${now.getMonth()+1}/${now.getDate()}`;
    const tripIndex = tripData.findIndex(d => d.fullDate === todayStr);
    const displayData = tripIndex !== -1 ? tripData[tripIndex] : tripData[0];
    const displayIndex = tripIndex !== -1 ? tripIndex : 0;
    const nextEvent = displayData.events[0];
    const roleIcons = { driver: 'ğŸš—', copilot: 'ğŸ—ºï¸', tourist: 'ğŸ“¸', admin: 'ğŸ“' };
    document.getElementById('header-icon').innerText = roleIcons[currentRole] || 'ğŸ¦';

    // åˆ¤æ–·æ˜¯å¦ç‚ºå‡ºç™¼å‰
    const isBeforeTrip = now < new Date("2025-12-25T00:00:00");
    
    let packingHtml = '';
    let prepHtml = ''; // â˜… æ–°å¢è®Šæ•¸

    if (isBeforeTrip) { 
        prepHtml = getPrepListHTML();     // â˜… ç”Ÿæˆäº‹å‰æº–å‚™ HTML
        packingHtml = getPackingListHTML(); 
    }

    const nextEventHtml = createEventCard(nextEvent, displayIndex, 0);

    container.innerHTML = `
        <div class="card p-4 mb-4 bg-gradient-to-r from-blue-50 to-white"><div class="flex justify-between items-center mb-3"><h3 class="font-bold text-gray-700">â˜€ï¸ ä»Šæ—¥å¤©æ°£ (é‚£éœ¸)</h3><span id="sunset-time" class="text-xs text-orange-600 font-bold"></span></div><div id="weather-scroll" class="weather-scroll flex gap-4"><div class="flex items-center gap-2 text-gray-400 text-sm"><i class="fa-solid fa-spinner fa-spin"></i> è¼‰å…¥ä¸­...</div></div></div>
        
        ${prepHtml}   <!-- â˜… æ’å…¥äº‹å‰æº–å‚™æ¸…å–® -->
        ${packingHtml}
        
        <div class="mb-4 flex justify-between items-center"><h3 class="font-bold text-gray-700">ğŸ“… ä»Šæ—¥æ¦‚è¦½ (${displayData.date})</h3></div>
        ${nextEventHtml}
        <div class="mt-6"><h3 class="font-bold text-gray-700 mb-3">ğŸ†˜ æ±‚ç”Ÿå·¥å…·ç®±</h3><div class="grid grid-cols-4 gap-2 text-center"><a href="https://www.google.com/maps/search/nearby+convenience+store" target="_blank" class="bg-white p-3 rounded-xl shadow-sm border border-gray-100 active:scale-95 transition"><div class="text-2xl mb-1">ğŸª</div><div class="text-[10px] text-gray-600 font-bold">æ‰¾è¶…å•†</div></a><a href="https://www.google.com/maps/search/nearby+toilet" target="_blank" class="bg-white p-3 rounded-xl shadow-sm border border-gray-100 active:scale-95 transition"><div class="text-2xl mb-1">ğŸš½</div><div class="text-[10px] text-gray-600 font-bold">æ‰¾å»æ‰€</div></a><a href="https://www.google.com/maps/search/nearby+gas+station" target="_blank" class="bg-white p-3 rounded-xl shadow-sm border border-gray-100 active:scale-95 transition"><div class="text-2xl mb-1">â›½</div><div class="text-[10px] text-gray-600 font-bold">æ‰¾åŠ æ²¹</div></a><button onclick="openTranslation()" class="bg-white p-3 rounded-xl shadow-sm border border-gray-100 active:scale-95 transition"><div class="text-2xl mb-1">ğŸ—£ï¸</div><div class="text-[10px] text-gray-600 font-bold">æ—¥èªå¡</div></button></div></div>
        <div class="mt-6 mb-20"><h3 class="font-bold text-gray-700 mb-3">ğŸ® 12æœˆé™å®šæ´»å‹•</h3><div class="flex gap-4 overflow-x-auto snap-x-mandatory hide-scrollbar pb-4 px-1">${okinawaEvents.map(ev => `<a href="${ev.link}" target="_blank" class="block min-w-[200px] bg-white rounded-xl border border-orange-100 shadow-sm snap-center active:scale-95 transition overflow-hidden"><div class="h-24 bg-gray-200 bg-cover bg-center" style="background-image: url('${ev.img}')"></div><div class="p-3"><div class="text-xs text-orange-500 font-bold mb-1">${ev.date}</div><div class="font-bold text-gray-800 text-sm truncate">${ev.title}</div><div class="text-xs text-gray-400 mt-1"><i class="fa-solid fa-location-dot"></i> ${ev.loc}</div></div></a>`).join('')}</div></div>
    `;
    document.getElementById('header-desc').innerText = "é¦–é æ¦‚è¦½";
    updateWeatherUI();
}

       // --- Render: Schedule (ä¿®æ­£äº¤é€šæ™‚é–“é¡¯ç¤ºå•é¡Œ) ---
function renderSchedule() {
    const container = document.getElementById('app');
    document.getElementById('header-desc').innerText = "è¡Œç¨‹ç¸½è¦½";
    
    // 1. æº–å‚™æ—¥æœŸé¸å–® HTML
    // â˜… é€™è£¡ç›´æ¥è¨­å®š py-3 (12px)ï¼Œç¢ºä¿ä¸Šä¸‹ä¸€è‡´
    let tabsHtml = `
        <div class="sticky-date-bar flex gap-2 overflow-x-auto hide-scrollbar py-3 px-4">`;
            
    tripData.forEach((d, idx) => { 
        const active = idx === selectedDateIndex ? 'active' : 'bg-white text-gray-500 border border-gray-200'; 
        tabsHtml += `
            <button onclick="changeDate(${idx})" class="date-tab ${active} px-4 py-2 rounded-full min-w-[90px] text-center transition shadow-sm flex-shrink-0">
                <div class="text-xs opacity-80">${d.day}</div>
                <div class="font-bold text-lg leading-tight">${d.date}</div>
            </button>`; 
    });
    tabsHtml += `</div>`;
    
    // 2. æº–å‚™è¡Œç¨‹åˆ—è¡¨ HTML
    // â˜… é—œéµï¼špy-6 (24px) ç¢ºä¿åˆ—è¡¨çš„ã€Œæœ€ä¸Šé¢ã€è·Ÿã€Œæœ€ä¸‹é¢ã€ç•™ç™½ä¸€æ¨£
    // â˜… é—œéµï¼špx-4 (16px) æŠŠå·¦å³é‚Šè·è£œå›ä¾†
    let eventsHtml = `<div class="space-y-4 animation-fade py-6 px-4">`;
    
    const dayData = tripData[selectedDateIndex];
    dayData.events.forEach((event, eIdx) => {
        eventsHtml += createEventCard(event, selectedDateIndex, eIdx);
        
        // äº¤é€šé€£æ¥ç·š
        if (event.travel && eIdx < dayData.events.length - 1) {
            let icon = 'fa-car'; 
            if(event.travel.mode === 'walk') icon = 'fa-person-walking'; 
            if(event.travel.mode === 'train') icon = 'fa-train-subway'; 
            if(event.travel.mode === 'plane') icon = 'fa-plane';
            
            eventsHtml += `
            <div class="flex flex-col items-center -my-3 z-0 relative">
                <div class="h-3 w-0.5 bg-gray-300 border-l border-dashed border-gray-400"></div>
                <div class="bg-white text-gray-500 text-[10px] font-bold px-2 py-0.5 rounded-full border border-gray-200 shadow-sm flex items-center gap-1 z-10">
                    <i class="fa-solid ${icon}"></i> ${event.travel.time}
                </div>
                <div class="h-3 w-0.5 bg-gray-300 border-l border-dashed border-gray-400"></div>
            </div>`;
        }
    });
    eventsHtml += `</div>`;

    // 3. åº•éƒ¨å¢Šé«˜ (é˜²æ­¢è¢«å°è¦½åˆ—æ“‹ä½)
    // å› ç‚ºä¸Šé¢åˆ—è¡¨å·²ç¶“æœ‰ py-6 (24px) çš„åº•éƒ¨ç•™ç™½ï¼Œé€™è£¡åªè¦å–®ç´”æ’é–‹é«˜åº¦å³å¯
    let spacerHtml = `<div class="h-22"></div>`;
    
    // â˜…â˜…â˜… æœ€çµ‚çµ„åˆï¼šä½¿ç”¨ -m-4 å»ºç«‹ç¨ç«‹ç©ºé–“ â˜…â˜…â˜…
    // é€™æœƒæŠµæ¶ˆ #app çš„ p-4 è¨­å®šï¼Œè®“æ—¥æœŸåˆ—å¯ä»¥æ»¿ç‰ˆï¼Œä¸”ä¸å— space-y-6 å¹²æ“¾
    container.innerHTML = `
        <div class="-m-4">
            ${tabsHtml}
            <div class="bg-transparent">
                ${eventsHtml}
                ${spacerHtml}
            </div>
        </div>`;
    
    // 4. è‡ªå‹•æ²å‹•æ—¥æœŸ (ä¿æŒä¸è®Š)
    const scrollContainer = container.querySelector('.sticky-date-bar');
    const activeTab = scrollContainer.children[selectedDateIndex];
    if (scrollContainer && activeTab) {
        const scrollLeft = activeTab.offsetLeft - (scrollContainer.clientWidth / 2) + (activeTab.clientWidth / 2);
        scrollContainer.scrollTo({ left: scrollLeft, behavior: 'auto' });
    }
}

        // --- Render: Vouchers ---
function renderVouchers() {
    document.getElementById('header-desc').innerText = "é ç´„æ†‘è­‰å¤¾";
    const container = document.getElementById('app');
    let infoHtml = `<div class="card p-5 mb-4 border-l-4 border-red-500 bg-red-50"><h3 class="font-bold text-red-700 mb-3"><i class="fa-solid fa-triangle-exclamation"></i> ç·Šæ€¥è¯çµ¡</h3><div class="grid grid-cols-2 gap-3 text-sm"><a href="tel:110" class="bg-white p-2 rounded text-center shadow text-gray-700 font-bold"><i class="fa-solid fa-phone mr-1"></i> å ±è­¦ 110</a><a href="tel:119" class="bg-white p-2 rounded text-center shadow text-gray-700 font-bold"><i class="fa-solid fa-truck-medical mr-1"></i> æ•‘è­· 119</a><div class="col-span-2 bg-white p-2 rounded shadow text-gray-700 text-xs"><div>å¤–äº¤éƒ¨æ—…å¤–æ•‘åŠ©ï¼š+81-80-1009-7179</div></div></div></div>`;
    let vouchersHtml = `<div class="space-y-4">`;
    tripData.forEach(day => {
        day.events.forEach(event => {
            if (event.bookingInfo) {
                let linkBtn = '';
                const fullText = (event.bookingInfo.note + (event.bookingInfo.extra || '')).toLowerCase();
                if (fullText.includes('trip.com')) linkBtn = `<a href="https://trip.com" target="_blank" class="mt-3 block w-full text-center bg-blue-50 text-blue-600 py-2 rounded-lg font-bold text-sm hover:bg-blue-100 transition border border-blue-100"><i class="fa-solid fa-arrow-up-right-from-square mr-1"></i> é–‹å•Ÿ Trip.com </a>`;
                else if (fullText.includes('nutmeg')) linkBtn = `<a href="https://ntmg.jp/" target="_blank" class="mt-3 block w-full text-center bg-green-50 text-green-600 py-2 rounded-lg font-bold text-sm hover:bg-green-100 transition border border-green-100"><i class="fa-solid fa-arrow-up-right-from-square mr-1"></i> é–‹å•Ÿ Nutmeg è¨‚å–®</a>`;
                else if (fullText.includes('tabelog')) linkBtn = `<a href="https://tabelog.com/" target="_blank" class="mt-3 block w-full text-center bg-yellow-50 text-yellow-600 py-2 rounded-lg font-bold text-sm hover:bg-yellow-100 transition border border-yellow-100"><i class="fa-solid fa-arrow-up-right-from-square mr-1"></i> é–‹å•Ÿ Tabelog</a>`;
                
                let voucherBtn = '';
                if (event.bookingInfo.driveLink) {
                    voucherBtn = `<button onclick="openVoucherImage('${event.bookingInfo.driveLink}')" class="mt-2 w-full bg-red-50 text-red-600 py-2 rounded text-xs font-bold border border-red-100 hover:bg-red-100 transition"><i class="fa-solid fa-file-pdf mr-1"></i> æŸ¥çœ‹æ†‘è­‰ (PDF)</button>`;
                } else if (event.bookingInfo.pdfContent) {
                    voucherBtn = `<button onclick="openPdfModal('${encodeURIComponent(event.bookingInfo.pdfContent)}')" class="mt-2 w-full bg-red-50 text-red-600 py-2 rounded text-xs font-bold border border-red-100 hover:bg-red-100 transition"><i class="fa-solid fa-file-lines mr-1"></i> é è¦½æ†‘è­‰å…§å®¹</button>`;
                }

                vouchersHtml += `
                    <div class="card p-5 border-l-4 border-orange-500 shadow-sm bg-white">
                        <div class="flex justify-between items-start mb-2"><h3 class="font-bold text-lg text-gray-800">${event.title}</h3><span class="text-xs bg-gray-100 px-2 py-1 rounded text-gray-500">${day.date}</span></div>
                        <div class="text-sm text-gray-600 mb-3">${event.bookingInfo.note}</div>
                        <div class="bg-gray-50 p-3 rounded border border-gray-200 dashed mb-3 relative group active:bg-orange-50 transition"><div class="text-xs text-gray-400 mb-1">è¨‚å–®ç·¨è™Ÿ / PIN</div><div class="text-xl font-mono font-bold text-gray-800 select-all break-all">${event.bookingInfo.code}</div><div class="absolute right-2 top-2 text-gray-300"><i class="fa-regular fa-copy"></i></div></div>
                        ${event.bookingInfo.extra ? `<div class="text-xs text-orange-600 font-bold text-right mb-3">${event.bookingInfo.extra}</div>` : ''}
                        ${voucherBtn}
                        ${linkBtn}
                    </div>`;
            }
        });
    });
    
    const prepHtml = getPrepListHTML();     // â˜… ç”Ÿæˆäº‹å‰æº–å‚™ HTML
    const packingHtml = getPackingListHTML();
    
    container.innerHTML = infoHtml + 
        `<div class="text-gray-500 text-sm mb-2 px-2">é ç´„æ†‘è­‰</div>` + vouchersHtml + 
        `<div class="mt-8 text-gray-500 text-sm mb-2 px-2">è¡Œå‰æº–å‚™</div>` + prepHtml + 
        `<div class="mt-4 text-gray-500 text-sm mb-2 px-2">éš¨æ™‚æª¢æŸ¥</div>` + packingHtml + 
        `</div>`;
}

        // --- Render: Shopping ---
        function renderShopping() {
    document.getElementById('header-desc').innerText = "è³¼ç‰©æ¸…å–®";
    const container = document.getElementById('app');
    
    // â˜…â˜…â˜… çµæ§‹é‡æ§‹ï¼šä½¿ç”¨ -m-4 å»ºç«‹æ»¿ç‰ˆç©ºé–“ â˜…â˜…â˜…
    container.innerHTML = `
        <div class="-m-4 relative">
            <!-- 1. æ‡¸æµ®æŒ‰éˆ• (FAB) -->
            <button onclick="openEditShopModal()" class="fab-btn"><i class="fa-solid fa-plus"></i></button>
            
            <!-- 2. ç½®é ‚ç¯©é¸å™¨ (Sticky Header) -->
            <!-- å…§å®¹æœƒç”± loadData å‹•æ…‹å¡«å…¥ -->
            <div id="shopping-controls" class="sticky-filters"></div>
            
            <!-- 3. åˆ—è¡¨å…§å®¹ (Content) -->
            <!-- px-4 è£œå›å·¦å³é‚Šè·ï¼Œpb-32 é ç•™åº•éƒ¨ç©ºé–“ -->
            <div id="shopping-list-container" class="space-y-4 px-4 py-4 pb-30">
                <div class="text-center text-gray-400 py-10"><i class="fa-solid fa-spinner fa-spin"></i> è¼‰å…¥ä¸­...</div>
            </div>
        </div>`;

    const loadData = (data) => {
        const contentArea = document.getElementById('budget-content-area');
        
        // 1. åˆå§‹åŒ–è®Šæ•¸
        let catStats = {}; 
        let personalTotal = { 'å¦¹å¦¹': 0, 'çˆ¸çˆ¸': 0, 'åª½åª½': 0, 'å§Šå§Š': 0 }; // æ‡‰ä»˜ (æ¶ˆè²»)
        let paidTotal = { 'å¦¹å¦¹': 0, 'çˆ¸çˆ¸': 0, 'åª½åª½': 0, 'å§Šå§Š': 0 };     // å¯¦ä»˜ (å¢ŠéŒ¢)
        let expenseListHtml = '';
        let grandTotal = 0; 
        
        const hasData = !!data;
        
        if (hasData) {
            const entries = Array.isArray(data) ? data.map((item, i) => [`local_${i}`, item]) : Object.entries(data);
            
            // 2. éæ­·è³‡æ–™
            entries.reverse().forEach(([key, ex]) => {
                const amount = parseInt(ex.amount);
                const amountTwd = ex.currency === 'TWD' ? amount : Math.round(amount * JPY_RATE);
                
                // çµ±è¨ˆé¡åˆ¥
                if (!catStats[ex.category]) catStats[ex.category] = { amount: 0, count: 0 };
                catStats[ex.category].amount += amountTwd;
                catStats[ex.category].count += 1;
                grandTotal += amountTwd;

                // â˜… çµ±è¨ˆå¢Šæ¬¾äºº (Who Paid)
                const payer = ex.payer || 'å§Šå§Š';
                if (paidTotal[payer] !== undefined) paidTotal[payer] += amountTwd;

                // çµ±è¨ˆåˆ†å¸³äºº (Who Should Pay)
                if (ex.splitDetails) {
                    ex.splitDetails.forEach(detail => {
                        if(personalTotal[detail.name] !== undefined) {
                            const splitAmountTwd = ex.currency === 'TWD' ? detail.amount : Math.round(detail.amount * JPY_RATE);
                            personalTotal[detail.name] += splitAmountTwd;
                        }
                    });
                } else {
                    if(personalTotal[payer] !== undefined) personalTotal[payer] += amountTwd;
                }

                // ç”¢ç”Ÿæ˜ç´°åˆ—è¡¨ (ä¿æŒä¸è®Š)
                if (currentBudgetTab === 'details') {
                    let icon = 'ğŸ’¸'; 
                    if(ex.category === 'é£Ÿç‰©') icon = 'ğŸ”'; if(ex.category === 'è³¼ç‰©') icon = 'ğŸ›ï¸'; 
                    if(ex.category === 'äº¤é€š') icon = 'ğŸš—'; if(ex.category === 'é–€ç¥¨') icon = 'ğŸ«';
                    
                    const priceDisplay = ex.currency === 'TWD' ? `NT$${amount.toLocaleString()}` : `Â¥${amount.toLocaleString()}`;
                    const subDisplay = ex.currency === 'TWD' ? '' : `<div class="text-[10px] text-gray-400">â‰ˆ NT$${amountTwd.toLocaleString()}</div>`;
                    
                    const isDrive = ex.receiptUrl && ex.receiptUrl.includes('drive.google.com');
                    const iconClass = isDrive ? 'fa-file-contract' : 'fa-receipt';
                    const receiptIcon = ex.receiptUrl 
                        ? `<button onclick="openVoucherImage('${ex.receiptUrl}')" class="text-blue-500 hover:bg-blue-50 p-1 rounded"><i class="fa-solid ${iconClass}"></i></button>` 
                        : '';

                    expenseListHtml += `
                        <div class="bg-white p-3 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center relative overflow-hidden">
                            <div class="w-1 bg-orange-400 absolute left-0 top-0 bottom-0"></div>
                            <div class="flex-1 ml-2">
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="text-lg">${icon}</span>
                                    <span class="font-bold text-gray-700 text-sm line-clamp-1">${ex.item}</span>
                                    <span class="text-[10px] bg-gray-100 text-gray-500 px-1.5 py-0.5 rounded border border-gray-200">${ex.payer || 'æœªçŸ¥'}</span>
                                </div>
                                <div class="text-xs text-gray-400 flex items-center gap-2">
                                    <span>${ex.fullTime ? ex.fullTime.slice(5, 16).replace('T', ' ') : ex.date}</span>
                                    <span>â€¢ ${ex.payment || 'ç¾é‡‘'}</span>
                                </div>
                            </div>
                            <div class="text-right flex flex-col items-end mr-3 min-w-[70px]">
                                <div class="font-bold text-orange-600">${priceDisplay}</div>
                                ${subDisplay}
                            </div>
                            <div class="flex gap-2 pl-2 border-l border-gray-100">
                                ${receiptIcon}
                                <button onclick="openBudgetModal('${key}')" class="text-gray-400 hover:text-blue-500 p-1"><i class="fa-solid fa-pen"></i></button>
                                <button onclick="deleteExpense('${key}')" class="text-gray-400 hover:text-red-400 p-1"><i class="fa-solid fa-trash"></i></button>
                            </div>
                        </div>`;
                }
            });
        }

        // 3. æ¸²æŸ“å…§å®¹å€
        if (currentBudgetTab === 'details') {
            if (!hasData) {
                contentArea.innerHTML = '<div class="text-center text-gray-400 py-10">ç›®å‰æ²’æœ‰æ”¯å‡ºï¼Œé»æ“Š + è¨˜å¸³</div>';
            } else {
                contentArea.innerHTML = `<div class="space-y-3 animation-fade">${expenseListHtml}</div>`;
            }
        } else {
            if (!hasData) {
                contentArea.innerHTML = '<div class="text-center text-gray-400 py-10">å°šç„¡è³‡æ–™å¯åˆ†æ</div>';
            } else {
                // A. æ¯äººæ‡‰ä»˜ (å¡ç‰‡)
                let personalHtml = '';
                Object.keys(personalTotal).forEach(name => {
                    personalHtml += `
                        <div class="person-card">
                            <div class="text-xs text-gray-500 font-bold mb-1">${name}</div>
                            <div class="text-xl font-bold text-gray-800">
                                <span class="text-xs mr-0.5">$</span>${personalTotal[name].toLocaleString()}
                            </div>
                        </div>`;
                });

                // B. é¡åˆ¥é•·æ¢åœ– (HTML)
                const catConfig = {
                    'é£Ÿç‰©': { icon: 'fa-utensils', color: 'bg-orange-400', iconBg: 'bg-orange-100', text: 'text-orange-600' },
                    'è³¼ç‰©': { icon: 'fa-bag-shopping', color: 'bg-pink-400', iconBg: 'bg-pink-100', text: 'text-pink-600' },
                    'äº¤é€š': { icon: 'fa-car', color: 'bg-blue-400', iconBg: 'bg-blue-100', text: 'text-blue-600' },
                    'é–€ç¥¨': { icon: 'fa-ticket', color: 'bg-green-400', iconBg: 'bg-green-100', text: 'text-green-600' },
                    'å…¶ä»–': { icon: 'fa-shapes', color: 'bg-gray-400', iconBg: 'bg-gray-100', text: 'text-gray-600' }
                };
                const sortedCats = Object.entries(catStats).sort((a, b) => b[1].amount - a[1].amount);
                let catListHtml = `<div class="mt-6 space-y-5 px-1">`;
                let chartDataObj = {}; 
                sortedCats.forEach(([catName, stats]) => {
                    chartDataObj[catName] = stats.amount;
                    const cfg = catConfig[catName] || catConfig['å…¶ä»–'];
                    const percent = grandTotal > 0 ? ((stats.amount / grandTotal) * 100).toFixed(1) : 0;
                    catListHtml += `
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full ${cfg.iconBg} ${cfg.text} flex items-center justify-center text-lg shrink-0"><i class="fa-solid ${cfg.icon}"></i></div>
                            <div class="flex-1 min-w-0">
                                <div class="flex justify-between items-end mb-1">
                                    <div class="flex items-center gap-2"><span class="font-bold text-gray-700">${catName}</span><span class="text-xs text-gray-400 bg-gray-50 px-1.5 py-0.5 rounded">${stats.count} ç­†</span></div>
                                    <div class="font-bold text-gray-800"><span class="text-xs mr-0.5">$</span>${stats.amount.toLocaleString()}</div>
                                </div>
                                <div class="flex items-center gap-3">
                                    <span class="text-xs font-bold w-12 text-right shrink-0 text-gray-500">${percent}%</span>
                                    <div class="flex-1 h-2 bg-gray-100 rounded-full overflow-hidden"><div class="h-full ${cfg.color} rounded-full" style="width: ${percent}%"></div></div>
                                </div>
                            </div>
                        </div>`;
                });
                catListHtml += `</div>`;

                // â˜…â˜…â˜… C. æœ€çµ‚çµç®—æ¼”ç®—æ³• (èª°çµ¦èª°éŒ¢) â˜…â˜…â˜…
                let debtHtml = '';
                let debtors = [];
                let creditors = [];

                // 1. è¨ˆç®—æ·¨é¡ (æ­£=æ”¶éŒ¢, è² =ä»˜éŒ¢)
                Object.keys(personalTotal).forEach(name => {
                    const balance = paidTotal[name] - personalTotal[name];
                    if (balance < -1) debtors.push({ name, amount: balance }); // æ¬ éŒ¢
                    else if (balance > 1) creditors.push({ name, amount: balance }); // æ”¶éŒ¢
                });

                // 2. æ’åº (é‡‘é¡å¤§åˆ°å°)
                debtors.sort((a, b) => a.amount - b.amount); // è² è¶Šå¤šä¹…è¶Šå‰é¢
                creditors.sort((a, b) => b.amount - a.amount); // æ­£è¶Šå¤šè¶Šå‰é¢

                // 3. é…å°çµç®—
                let transactions = [];
                let dIndex = 0, cIndex = 0;
                
                while (dIndex < debtors.length && cIndex < creditors.length) {
                    let debtor = debtors[dIndex];
                    let creditor = creditors[cIndex];
                    
                    // æ‰¾å‡ºäº¤æ˜“é‡‘é¡ (å–å…©è€…çµ•å°å€¼è¼ƒå°è€…)
                    let amount = Math.min(Math.abs(debtor.amount), creditor.amount);
                    
                    if (amount > 0) {
                        transactions.push({ from: debtor.name, to: creditor.name, money: Math.round(amount) });
                    }

                    // èª¿æ•´é¤˜é¡
                    debtor.amount += amount;
                    creditor.amount -= amount;

                    // å¦‚æœæŸæ–¹çµæ¸…ï¼Œç§»å‹•æŒ‡æ¨™
                    if (Math.abs(debtor.amount) < 1) dIndex++;
                    if (creditor.amount < 1) cIndex++;
                }

                // 4. ç”¢ç”Ÿ HTML
                if (transactions.length === 0) {
                    debtHtml = `<div class="text-center text-gray-500 text-sm py-2">ç›®å‰æ²’æœ‰éœ€è¦çµç®—çš„æ¬¾é … ğŸ‰</div>`;
                } else {
                    debtHtml = transactions.map(t => `
                        <div class="flex justify-between items-center bg-white p-3 rounded-xl border border-green-200 shadow-sm">
                            <div class="flex items-center gap-2">
                                <span class="font-bold text-gray-700 bg-gray-100 px-2 py-1 rounded">${t.from}</span>
                                <i class="fa-solid fa-arrow-right text-gray-400 text-xs"></i>
                                <span class="font-bold text-gray-700 bg-gray-100 px-2 py-1 rounded">${t.to}</span>
                            </div>
                            <div class="font-bold text-green-600 text-lg">
                                <span class="text-xs mr-0.5">$</span>${t.money.toLocaleString()}
                            </div>
                        </div>
                    `).join('');
                }

                // D. çµ„åˆ HTML (æ–°å¢çµç®—å¡ç‰‡åœ¨æœ€ä¸‹æ–¹)
                contentArea.innerHTML = `
                    <div class="space-y-4 animation-fade">
                        <!-- åœ“é¤…åœ– -->
                        <div class="card p-5 bg-white">
                            <h3 class="font-bold text-gray-700 mb-2 text-center text-sm">ğŸ“Š æ¶ˆè²»ä½”æ¯”åœ“é¤…åœ–</h3>
                            <div class="chart-container">
                                <canvas id="expenseChart"></canvas>
                            </div>
                        </div>

                        <!-- é¡åˆ¥é•·æ¢åœ– -->
                        <div class="card p-5 bg-white">
                            <h3 class="font-bold text-gray-700 mb-4 text-sm border-b pb-2">æ”¯å‡ºåˆ†é¡è©³æƒ…</h3>
                            ${catListHtml}
                        </div>

                        <!-- æ¯äººæ‡‰ä»˜ -->
                        <div class="card p-4 bg-orange-50 border-orange-200">
                            <h3 class="font-bold text-gray-700 mb-3 text-sm"><i class="fa-solid fa-users-viewfinder mr-2"></i>æ¯äººæ‡‰ä»˜ç¸½é¡ (NT$)</h3>
                            <div class="grid grid-cols-2 gap-3">
                                ${personalHtml}
                            </div>
                        </div>

                        <!-- â˜… æœ€çµ‚çµç®—å»ºè­°å¡ç‰‡ -->
                        <div class="card p-5 bg-green-50 border border-green-200">
                            <h3 class="font-bold text-green-700 mb-4 text-sm flex items-center">
                                <i class="fa-solid fa-money-bill-transfer mr-2"></i>æœ€çµ‚çµç®—å»ºè­°
                            </h3>
                            <div class="space-y-2">
                                ${debtHtml}
                            </div>
                        </div>
                    </div>
                `;
                
                setTimeout(() => { renderChart(chartDataObj); }, 50);
            }
        }
    };

    if(db) { 
        db.ref('shoppingList').once('value').then(snapshot => loadData(snapshot.val())); 
    } else { 
        const localData = JSON.parse(localStorage.getItem(SHOPPING_KEY)) || defaultShoppingList; 
        loadData(localData); 
    }
}

        // --- è£œä¸Šéºå¤±çš„ç¯©é¸åŠŸèƒ½ ---
function updateFilter(type, value) {
    // 1. æ›´æ–°å…¨åŸŸè®Šæ•¸
    if (type === 'category') {
        currentCategoryFilter = value;
    } else if (type === 'store') {
        currentStoreFilter = value;
    }
    
    // 2. é‡æ–°æ¸²æŸ“è³¼ç‰©æ¸…å–® (é€™æ™‚å€™ renderShopping æœƒå»è®€å–æ›´æ–°å¾Œçš„è®Šæ•¸)
    renderShopping();
}

        // 2. åˆ‡æ›åˆ†é å‡½å¼ (é€™å°±æ˜¯æŒ‰éˆ•é»æ“Šå¾Œè¦åŸ·è¡Œçš„åŠŸèƒ½)
function switchBudgetTab(tab) {
    currentBudgetTab = tab;
    renderBudget(); // åˆ‡æ›å¾Œé‡æ–°æ¸²æŸ“ç•«é¢
}


// 3. è¨˜å¸³ä¸»æ¸²æŸ“å‡½å¼
function renderBudget() {
    document.getElementById('header-desc').innerText = "è¨˜å¸³æœ¬ & åˆ†å¸³";
    const container = document.getElementById('app');

    // â˜…â˜…â˜… ä»‹é¢çµæ§‹ï¼šç½®é ‚åˆ†é  + å…§å®¹å€ â˜…â˜…â˜…
    const tabsHtml = `
        <div class="-m-4 relative">
            <button onclick="openBudgetModal()" class="fab-btn"><i class="fa-solid fa-plus"></i></button>

            <!-- Sticky Header -->
            <div class="sticky top-[80px] z-40 bg-[rgba(255,248,225,0.95)] backdrop-blur-sm px-4 py-3 shadow-[0_4px_6px_-4px_rgba(0,0,0,0.05)]">
                <div class="budget-tab-container">
                    <button onclick="switchBudgetTab('details')" class="budget-tab-btn ${currentBudgetTab === 'details' ? 'active' : ''}">
                        <i class="fa-solid fa-list-ul mr-1"></i> æ˜ç´°
                    </button>
                    <button onclick="switchBudgetTab('overview')" class="budget-tab-btn ${currentBudgetTab === 'overview' ? 'active' : ''}">
                        <i class="fa-solid fa-chart-pie mr-1"></i> ç¸½è¦½
                    </button>
                </div>
            </div>

            <!-- å…§å®¹å€ -->
            <div id="budget-content-area" class="px-4 py-4 pb-30">
                <div class="text-center text-gray-400 py-10"><i class="fa-solid fa-spinner fa-spin"></i> è¼‰å…¥ä¸­...</div>
            </div>
        </div>
    `;
    container.innerHTML = tabsHtml;

    const loadData = (data) => {
        const contentArea = document.getElementById('budget-content-area');
        
        // 1. åˆå§‹åŒ–è®Šæ•¸
        let catStats = {}; 
        // æ‡‰ä»˜ (æ¶ˆè²»)ï¼šå¤§å®¶èŠ±äº†å¤šå°‘éŒ¢
        let personalTotal = { 'å¦¹å¦¹': 0, 'çˆ¸çˆ¸': 0, 'åª½åª½': 0, 'å§Šå§Š': 0 }; 
        // â˜… å¯¦ä»˜ (å¢ŠéŒ¢)ï¼šèª°å…ˆæ‹¿éŒ¢å‡ºä¾†
        let paidTotal = { 'å¦¹å¦¹': 0, 'çˆ¸çˆ¸': 0, 'åª½åª½': 0, 'å§Šå§Š': 0 };     
        
        let expenseListHtml = '';
        let grandTotal = 0; 
        
        const hasData = !!data;
        
        if (hasData) {
            const entries = Array.isArray(data) ? data.map((item, i) => [`local_${i}`, item]) : Object.entries(data);
            
            // 2. éæ­·è³‡æ–™é€²è¡Œè¨ˆç®—
            entries.reverse().forEach(([key, ex]) => {
                const amount = parseInt(ex.amount);
                const amountTwd = ex.currency === 'TWD' ? amount : Math.round(amount * JPY_RATE);
                
                // çµ±è¨ˆé¡åˆ¥
                if (!catStats[ex.category]) {
                    catStats[ex.category] = { amount: 0, count: 0 };
                }
                catStats[ex.category].amount += amountTwd;
                catStats[ex.category].count += 1;
                grandTotal += amountTwd;

                // â˜… çµ±è¨ˆå¢Šæ¬¾äºº (Who Paid) - é€™æ˜¯çµç®—çš„é—œéµï¼
                const payer = ex.payer || 'å§Šå§Š';
                if (paidTotal[payer] !== undefined) paidTotal[payer] += amountTwd;

                // çµ±è¨ˆåˆ†å¸³äºº (Who Should Pay)
                if (ex.splitDetails) {
                    ex.splitDetails.forEach(detail => {
                        if(personalTotal[detail.name] !== undefined) {
                            const splitAmountTwd = ex.currency === 'TWD' ? detail.amount : Math.round(detail.amount * JPY_RATE);
                            personalTotal[detail.name] += splitAmountTwd;
                        }
                    });
                } else {
                    if(personalTotal[payer] !== undefined) personalTotal[payer] += amountTwd;
                }

                // ç”¢ç”Ÿæ˜ç´°åˆ—è¡¨ HTML (åƒ…åœ¨æ˜ç´°é ç±¤ä½¿ç”¨)
                if (currentBudgetTab === 'details') {
                    let icon = 'ğŸ’¸'; 
                    if(ex.category === 'é£Ÿç‰©') icon = 'ğŸ”'; if(ex.category === 'è³¼ç‰©') icon = 'ğŸ›ï¸'; 
                    if(ex.category === 'äº¤é€š') icon = 'ğŸš—'; if(ex.category === 'é–€ç¥¨') icon = 'ğŸ«';
                    
                    const priceDisplay = ex.currency === 'TWD' ? `NT$${amount.toLocaleString()}` : `Â¥${amount.toLocaleString()}`;
                    const subDisplay = ex.currency === 'TWD' ? '' : `<div class="text-[10px] text-gray-400">â‰ˆ NT$${amountTwd.toLocaleString()}</div>`;
                    
                    const isDrive = ex.receiptUrl && ex.receiptUrl.includes('drive.google.com');
                    const iconClass = isDrive ? 'fa-file-contract' : 'fa-receipt';
                    const receiptIcon = ex.receiptUrl 
                        ? `<button onclick="openVoucherImage('${ex.receiptUrl}')" class="text-blue-500 hover:bg-blue-50 p-1 rounded"><i class="fa-solid ${iconClass}"></i></button>` 
                        : '';

                    expenseListHtml += `
                        <div class="bg-white p-3 rounded-xl shadow-sm border border-gray-100 flex justify-between items-center relative overflow-hidden">
                            <div class="w-1 bg-orange-400 absolute left-0 top-0 bottom-0"></div>
                            <div class="flex-1 ml-2">
                                <div class="flex items-center gap-2 mb-1">
                                    <span class="text-lg">${icon}</span>
                                    <span class="font-bold text-gray-700 text-sm line-clamp-1">${ex.item}</span>
                                    <span class="text-[10px] bg-gray-100 text-gray-500 px-1.5 py-0.5 rounded border border-gray-200">${ex.payer || 'æœªçŸ¥'}</span>
                                </div>
                                <div class="text-xs text-gray-400 flex items-center gap-2">
                                    <span>${ex.fullTime ? ex.fullTime.slice(5, 16).replace('T', ' ') : ex.date}</span>
                                    <span>â€¢ ${ex.payment || 'ç¾é‡‘'}</span>
                                </div>
                            </div>
                            <div class="text-right flex flex-col items-end mr-3 min-w-[70px]">
                                <div class="font-bold text-orange-600">${priceDisplay}</div>
                                ${subDisplay}
                            </div>
                            <div class="flex gap-2 pl-2 border-l border-gray-100">
                                ${receiptIcon}
                                <button onclick="openBudgetModal('${key}')" class="text-gray-400 hover:text-blue-500 p-1"><i class="fa-solid fa-pen"></i></button>
                                <button onclick="deleteExpense('${key}')" class="text-gray-400 hover:text-red-400 p-1"><i class="fa-solid fa-trash"></i></button>
                            </div>
                        </div>`;
                }
            });
        }

        // 3. æ¸²æŸ“å…§å®¹å€
        if (currentBudgetTab === 'details') {
            // [æ˜ç´°é ]
            if (!hasData) {
                contentArea.innerHTML = '<div class="text-center text-gray-400 py-10">ç›®å‰æ²’æœ‰æ”¯å‡ºï¼Œé»æ“Š + è¨˜å¸³</div>';
            } else {
                contentArea.innerHTML = `<div class="space-y-3 animation-fade">${expenseListHtml}</div>`;
            }
        } else {
            // [ç¸½è¦½é ] Overview
            if (!hasData) {
                contentArea.innerHTML = '<div class="text-center text-gray-400 py-10">å°šç„¡è³‡æ–™å¯åˆ†æ</div>';
            } else {
                // A. æ¯äººæ‡‰ä»˜ (å¡ç‰‡)
                let personalHtml = '';
                Object.keys(personalTotal).forEach(name => {
                    personalHtml += `
                        <div class="person-card">
                            <div class="text-xs text-gray-500 font-bold mb-1">${name}</div>
                            <div class="text-xl font-bold text-gray-800">
                                <span class="text-xs mr-0.5">$</span>${personalTotal[name].toLocaleString()}
                            </div>
                        </div>`;
                });

                // B. é¡åˆ¥é•·æ¢åœ– (HTML)
                const catConfig = {
                    'é£Ÿç‰©': { icon: 'fa-utensils', color: 'bg-orange-400', iconBg: 'bg-orange-100', text: 'text-orange-600' },
                    'è³¼ç‰©': { icon: 'fa-bag-shopping', color: 'bg-pink-400', iconBg: 'bg-pink-100', text: 'text-pink-600' },
                    'äº¤é€š': { icon: 'fa-car', color: 'bg-blue-400', iconBg: 'bg-blue-100', text: 'text-blue-600' },
                    'é–€ç¥¨': { icon: 'fa-ticket', color: 'bg-green-400', iconBg: 'bg-green-100', text: 'text-green-600' },
                    'å…¶ä»–': { icon: 'fa-shapes', color: 'bg-gray-400', iconBg: 'bg-gray-100', text: 'text-gray-600' }
                };

                const sortedCats = Object.entries(catStats).sort((a, b) => b[1].amount - a[1].amount);
                let catListHtml = `<div class="mt-6 space-y-5 px-1">`;
                let chartDataObj = {}; 

                sortedCats.forEach(([catName, stats]) => {
                    chartDataObj[catName] = stats.amount;
                    const cfg = catConfig[catName] || catConfig['å…¶ä»–'];
                    const percent = grandTotal > 0 ? ((stats.amount / grandTotal) * 100).toFixed(1) : 0;
                    
                    catListHtml += `
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-full ${cfg.iconBg} ${cfg.text} flex items-center justify-center text-lg shrink-0">
                                <i class="fa-solid ${cfg.icon}"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <div class="flex justify-between items-end mb-1">
                                    <div class="flex items-center gap-2">
                                        <span class="font-bold text-gray-700">${catName}</span>
                                        <span class="text-xs text-gray-400 bg-gray-50 px-1.5 py-0.5 rounded">${stats.count} ç­†</span>
                                    </div>
                                    <div class="font-bold text-gray-800">
                                        <span class="text-xs mr-0.5">$</span>${stats.amount.toLocaleString()}
                                    </div>
                                </div>
                                <div class="flex items-center gap-3">
                                    <span class="text-xs font-bold w-12 text-right shrink-0 text-gray-500">${percent}%</span>
                                    <div class="flex-1 h-2 bg-gray-100 rounded-full overflow-hidden">
                                        <div class="h-full ${cfg.color} rounded-full" style="width: ${percent}%"></div>
                                    </div>
                                </div>
                            </div>
                        </div>`;
                });
                catListHtml += `</div>`;

                // â˜…â˜…â˜… C. æœ€çµ‚çµç®—æ¼”ç®—æ³• (èª°çµ¦èª°éŒ¢) â˜…â˜…â˜…
                let debtHtml = '';
                let debtors = [];
                let creditors = [];

                // 1. è¨ˆç®—æ·¨é¡ (æ­£=æ”¶éŒ¢, è² =ä»˜éŒ¢)
                Object.keys(personalTotal).forEach(name => {
                    // Balance = å¢Šçš„éŒ¢ - è©²ä»˜çš„éŒ¢
                    const balance = paidTotal[name] - personalTotal[name];
                    if (balance < -1) debtors.push({ name, amount: balance }); // è² æ•¸ä»£è¡¨è¦æ‹¿éŒ¢å‡ºä¾†
                    else if (balance > 1) creditors.push({ name, amount: balance }); // æ­£æ•¸ä»£è¡¨è¦æ”¶éŒ¢
                });

                // 2. æ’åº
                debtors.sort((a, b) => a.amount - b.amount); // è² è¶Šå¤šä¹…è¶Šå‰é¢ (æ¬ æœ€å¤š)
                creditors.sort((a, b) => b.amount - a.amount); // æ­£è¶Šå¤šè¶Šå‰é¢ (æ”¶æœ€å¤š)

                // 3. é…å°çµç®—
                let transactions = [];
                let dIndex = 0, cIndex = 0;
                
                while (dIndex < debtors.length && cIndex < creditors.length) {
                    let debtor = debtors[dIndex];
                    let creditor = creditors[cIndex];
                    
                    // æ‰¾å‡ºäº¤æ˜“é‡‘é¡ (å–çµ•å°å€¼è¼ƒå°è€…)
                    let amount = Math.min(Math.abs(debtor.amount), creditor.amount);
                    
                    if (amount > 0) {
                        transactions.push({ from: debtor.name, to: creditor.name, money: Math.round(amount) });
                    }

                    // èª¿æ•´é¤˜é¡
                    debtor.amount += amount;
                    creditor.amount -= amount;

                    // å¦‚æœæŸæ–¹çµæ¸…ï¼Œç§»å‹•æŒ‡æ¨™
                    if (Math.abs(debtor.amount) < 1) dIndex++;
                    if (creditor.amount < 1) cIndex++;
                }

                // 4. ç”¢ç”Ÿ HTML
                if (transactions.length === 0) {
                    debtHtml = `<div class="text-center text-gray-500 text-sm py-2">ç›®å‰æ”¶æ”¯å¹³è¡¡ï¼Œä¸éœ€è¦çµç®— ğŸ‰</div>`;
                } else {
                    debtHtml = transactions.map(t => `
                        <div class="flex justify-between items-center bg-white p-3 rounded-xl border border-green-200 shadow-sm">
                            <div class="flex items-center gap-2">
                                <span class="font-bold text-gray-700 bg-gray-100 px-2 py-1 rounded">${t.from}</span>
                                <i class="fa-solid fa-arrow-right text-gray-400 text-xs"></i>
                                <span class="font-bold text-gray-700 bg-gray-100 px-2 py-1 rounded">${t.to}</span>
                            </div>
                            <div class="font-bold text-green-600 text-lg">
                                <span class="text-xs mr-0.5">$</span>${t.money.toLocaleString()}
                            </div>
                        </div>
                    `).join('');
                }

                // D. çµ„åˆ HTML (å››å¼µå¡ç‰‡)
                contentArea.innerHTML = `
                    <div class="space-y-4 animation-fade">
                        <!-- å¡ç‰‡ 1: åœ“é¤…åœ– -->
                        <div class="card p-5 bg-white">
                            <h3 class="font-bold text-gray-700 mb-2 text-center text-sm">ğŸ“Š æ¶ˆè²»ä½”æ¯”åœ“é¤…åœ–</h3>
                            <div class="chart-container">
                                <canvas id="expenseChart"></canvas>
                            </div>
                        </div>

                        <!-- å¡ç‰‡ 2: é¡åˆ¥é•·æ¢åœ– -->
                        <div class="card p-5 bg-white">
                            <h3 class="font-bold text-gray-700 mb-4 text-sm border-b pb-2">æ”¯å‡ºåˆ†é¡è©³æƒ…</h3>
                            ${catListHtml}
                        </div>

                        <!-- å¡ç‰‡ 3: æ¯äººæ‡‰ä»˜ -->
                        <div class="card p-4 bg-orange-50 border-orange-200">
                            <h3 class="font-bold text-gray-700 mb-3 text-sm"><i class="fa-solid fa-users-viewfinder mr-2"></i>æ¯äººæ‡‰ä»˜ç¸½é¡ (NT$)</h3>
                            <div class="grid grid-cols-2 gap-3">
                                ${personalHtml}
                            </div>
                        </div>

                        <!-- â˜…â˜…â˜… å¡ç‰‡ 4: æœ€çµ‚çµç®—å»ºè­° (æ–°å¢çš„) â˜…â˜…â˜… -->
                        <div class="card p-5 bg-green-50 border border-green-200">
                            <h3 class="font-bold text-green-700 mb-4 text-sm flex items-center">
                                <i class="fa-solid fa-money-bill-transfer mr-2"></i>æœ€çµ‚çµç®—å»ºè­°
                            </h3>
                            <div class="space-y-2">
                                ${debtHtml}
                            </div>
                            <div class="text-[10px] text-green-600 mt-2 text-center opacity-70">
                                ç³»çµ±è‡ªå‹•è¨ˆç®—æœ€ä½³è½‰å¸³è·¯å¾‘
                            </div>
                        </div>
                    </div>
                `;
                
                setTimeout(() => { renderChart(chartDataObj); }, 50);
            }
        }
    };

    if(db) { 
        db.ref('expenses').once('value').then(snapshot => loadData(snapshot.val())); 
    } else { 
        const localData = JSON.parse(localStorage.getItem(EXPENSE_KEY)) || []; 
        loadData(localData); 
    }
}

// --- åœ–è¡¨ç¹ªè£½å‡½å¼ ---
function renderChart(dataObj) {
    const ctx = document.getElementById('expenseChart');
    if (!ctx) {
        console.warn("ç­‰å¾…åœ–è¡¨è¼‰å…¥..."); 
        return;
    }
    
    // éŠ·æ¯€èˆŠåœ–è¡¨ä»¥é˜²é‡ç–Š
    if (budgetChart) { 
        try {
            budgetChart.destroy();
        } catch(e) { console.log(e); }
    }

    const labels = Object.keys(dataObj);
    const data = Object.values(dataObj);
    const colors = ['#FFAB91', '#FFCC80', '#B2EBF2', '#E1BEE7', '#DCEDC8', '#F8BBD0', '#90CAF9'];

    try {
        budgetChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: labels,
                datasets: [{
                    data: data,
                    backgroundColor: colors,
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'right', labels: { font: { family: "'M PLUS Rounded 1c'" }, boxWidth: 12 } }
                }
            }
        });
    } catch (e) {
        console.error("åœ–è¡¨ç¹ªè£½å¤±æ•—:", e);
        ctx.parentNode.innerHTML = '<div class="text-red-400 text-xs text-center py-4">åœ–è¡¨è¼‰å…¥å¤±æ•—ï¼Œè«‹é‡æ–°æ•´ç†</div>';
    }
}

// --- å»ºç«‹è¡Œç¨‹å¡ç‰‡ HTML (æ”¯æ´è‡ªè¨‚åœè»Šé€£çµç‰ˆ) ---
function createEventCard(event, dayIdx, evtIdx) {
    
    // 1. æ™‚é–“é¡¯ç¤ºè™•ç†
    let timeHtml = `<div class="font-bold text-xl text-gray-700 leading-none tracking-tight">${event.time}</div>`;
    if (event.leaveTime) {
        timeHtml += `<div class="text-[10px] text-red-400 font-bold mt-0.5 whitespace-nowrap">~${event.leaveTime}</div>`;
    }

    // 2. æº–å‚™æ¨™ç±¤æ¨£å¼
    let tagClass = event.type === 'eat' ? 'tag-eat' : event.type === 'spot' ? 'tag-spot' : event.type === 'hotel' ? 'tag-hotel' : 'tag-trans';
    let tagName = event.type === 'eat' ? 'ç¾é£Ÿ' : event.type === 'spot' ? 'æ™¯é»' : event.type === 'hotel' ? 'ä½å®¿' : 'äº¤é€š';

    // 3. ç‰¹æ®Šå¡ç‰‡: æº–å‚™äº‹é … (Prep)
    if (event.type === 'prep') {
        let rightSideHtml = '';
        if (event.departureTime) {
            rightSideHtml = `
                <div class="text-right shrink-0 ml-2">
                    <div class="text-xs text-gray-500">é è¨ˆå‡ºç™¼</div>
                    <div class="text-2xl font-bold text-purple-900">${event.departureTime.split(' ')[0]}</div>
                    <div class="text-xs text-purple-700">æº–æ™‚å‡ºç™¼ ğŸš—</div>
                </div>`;
        } else if (event.appLink) {
            rightSideHtml = `
                <a href="${event.appLink.url}" target="_blank" class="shrink-0 ml-2 flex flex-col items-center text-purple-600 bg-white px-3 py-2 rounded-lg shadow-sm border border-purple-100 active:scale-95 transition">
                    <i class="${event.appLink.icon} text-xl mb-1"></i>
                    <span class="text-[10px] font-bold">${event.appLink.text}</span>
                </a>`;
        }
        return `
            <div class="card p-4 border-l-4 border-purple-400 bg-purple-50 flex justify-between items-center">
                <div class="flex-1">
                    <div class="font-bold text-xl text-purple-800">${event.time}</div>
                    <div class="text-sm text-purple-600 font-bold">${event.title}</div>
                    <div class="text-xs text-purple-500 mt-1 leading-relaxed">${event.guide}</div>
                </div>
                ${rightSideHtml}
            </div>`;
    }

    // 4. ç‰¹æ®Šå¡ç‰‡: äºŒé¸ä¸€ (Choice)
    if (event.type === 'choice') {
        const choicesHtml = event.choices.map((c, cIdx) => {
            const targetUrl = c.navLink || c.link || `https://www.google.com/maps/search/?api=1&query=${c.title}+æ²–ç¹©`;
            
            let travelTimeHtml = '';
            if (c.travelTime) {
                const icon = (c.travelTime.includes('æ­¥') || c.travelTime.includes('èµ°')) ? 'fa-person-walking' : 'fa-car';
                travelTimeHtml = `<span class="text-[10px] bg-gray-100 text-gray-500 px-2 py-1 rounded-full border border-gray-200 shrink-0 flex items-center gap-1"><i class="fa-solid ${icon}"></i> ${c.travelTime}</span>`;
            }
            const choiceTagClass = c.type === 'spot' ? 'tag-spot' : 'tag-eat';
            const choiceTagName = c.type === 'spot' ? 'æ™¯é»' : 'ç¾é£Ÿ';

            // â˜…â˜…â˜… ä¿®æ”¹ï¼šåªæœ‰ç•¶è³‡æ–™æœ‰ parkingLink æ™‚æ‰é¡¯ç¤ºï¼Œå¦å‰‡éš±è— â˜…â˜…â˜…
            let parkingBtn = '';
            // åŠ å…¥ c.parkingLink çš„åˆ¤æ–·
            if (['copilot', 'driver'].includes(currentRole) && c.parkingLink) {
                parkingBtn = `
                    <a href="${c.parkingLink}" target="_blank" class="absolute bottom-3 right-14 w-10 h-10 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center shadow-md active:scale-95 transition" onclick="event.stopPropagation()">
                        <i class="fa-solid fa-square-parking text-xl"></i>
                    </a>`;
            }
            // â˜…â˜…â˜… çµæŸ â˜…â˜…â˜…

            return `
            <div class="bg-white border-2 border-orange-100 rounded-xl p-4 min-w-[85%] snap-center shadow-sm relative flex flex-col cursor-pointer active:scale-[0.98] transition" 
                 onclick="openDetailModal(${dayIdx}, ${evtIdx}, ${cIdx})">
                <div class="flex justify-between items-start mb-2 gap-2">
                    <h4 class="font-bold text-lg text-gray-800 line-clamp-1">${c.title}</h4>
                    <div class="flex gap-1 shrink-0">
                        ${travelTimeHtml}
                        <span class="text-xs px-2 py-1 rounded-full ${choiceTagClass} flex items-center">${choiceTagName}</span>
                    </div>
                </div>
                <p class="text-sm text-gray-600 mb-8 line-clamp-2">${c.guide}</p>
                <div class="mt-auto flex justify-between items-center">
                    <button class="text-blue-600 text-sm font-bold bg-blue-50 px-3 py-1.5 rounded-lg w-full text-left">æŸ¥çœ‹è©³æƒ…</button>
                    ${parkingBtn}
                    <a href="${targetUrl}" target="_blank" class="absolute bottom-3 right-3 w-10 h-10 rounded-full bg-blue-600 text-white flex items-center justify-center shadow-md active:scale-95 transition" onclick="event.stopPropagation()"><i class="fa-solid fa-location-arrow text-sm"></i></a>
                </div>
            </div>`;
        }).join('');

        return `
            <div class="overflow-hidden">
                <div class="flex items-start gap-3 mb-2 px-1">
                    <div class="min-w-[60px] flex flex-col items-center pt-1">${timeHtml}</div>
                    <h3 class="font-bold text-lg text-gray-800 pt-0.5">${event.title}</h3>
                </div>
                <div class="flex gap-4 overflow-x-auto snap-x-mandatory hide-scrollbar pb-4 px-1">
                    ${choicesHtml}
                </div>
            </div>`;
    }

    // 5. ä¸€èˆ¬è¡Œç¨‹ (Normal)
    
    let previewContent = '';
    if (currentRole === 'driver' && event.mapCode) previewContent = `<div class="mt-2 text-sm font-mono bg-gray-100 p-1 px-2 rounded inline-block text-gray-600"><i class="fa-solid fa-map-location-dot mr-1"></i> ${event.mapCode}</div>`;
    if (currentRole === 'admin' && event.bookingInfo) previewContent = `<div class="mt-2 text-xs text-red-500 font-bold"><i class="fa-solid fa-ticket mr-1"></i> ${event.bookingInfo.note}</div>`;
    
    if (event.frequency) {
        let timeLinkHtml = '';
        if (event.timetableUrl) {
            if (event.timetableUrl.includes('drive.google.com')) {
                timeLinkHtml = `<button onclick="openVoucherImage('${event.timetableUrl}'); event.stopPropagation();" class="ml-1 underline hover:text-blue-800 cursor-pointer pointer-events-auto text-blue-600">æ™‚åˆ»è¡¨</button>`;
            } else {
                timeLinkHtml = `<a href="${event.timetableUrl}" target="_blank" class="ml-1 underline pointer-events-auto" onclick="event.stopPropagation()">æ™‚åˆ»è¡¨</a>`;
            }
        }
        previewContent += `<div class="mt-2 text-xs text-blue-600 font-bold"><i class="fa-solid fa-clock"></i> ${event.frequency} ${timeLinkHtml}</div>`;
    }

    if (event.guide) {
        previewContent += `
            <div class="mt-2 text-sm text-gray-600 flex items-start leading-snug">
                <i class="fa-solid fa-circle-info text-orange-400 mr-1.5 mt-0.5 shrink-0 text-xs"></i>
                <span>${event.guide}</span>
            </div>`;
    }
    
    let voucherBtn = '';
    if (event.bookingInfo) {
        const btnClass = "mt-3 w-full text-center bg-red-50 text-red-600 py-2 rounded-lg text-xs font-bold border border-red-100 hover:bg-red-100 transition pointer-events-auto flex items-center justify-center gap-1 shadow-sm";
        if (event.bookingInfo.driveLink) {
            voucherBtn = `<button onclick="openVoucherImage('${event.bookingInfo.driveLink}'); event.stopPropagation();" class="${btnClass}"><i class="fa-solid fa-file-pdf"></i> é è¦½æ†‘è­‰ (PDF)</button>`;
        } else if (event.bookingInfo.voucherImg) {
            voucherBtn = `<button onclick="openVoucherImage('${event.bookingInfo.voucherImg}'); event.stopPropagation();" class="${btnClass}"><i class="fa-solid fa-image"></i> æŸ¥çœ‹æ†‘è­‰åœ–ç‰‡</button>`;
        } else if (event.bookingInfo.pdfContent) {
            voucherBtn = `<button onclick="openPdfModal('${encodeURIComponent(event.bookingInfo.pdfContent)}'); event.stopPropagation();" class="${btnClass}"><i class="fa-solid fa-file-lines"></i> é è¦½æ†‘è­‰å…§å®¹</button>`;
        }
    }

    // â˜…â˜…â˜… ä¿®æ”¹ï¼šåªæœ‰ç•¶è³‡æ–™æœ‰ parkingLink æ™‚æ‰é¡¯ç¤ºï¼Œå¦å‰‡éš±è— â˜…â˜…â˜…
    let parkingBtn = '';
    // åŠ å…¥ event.parkingLink çš„åˆ¤æ–·
    if (['spot', 'eat', 'hotel'].includes(event.type) && ['copilot', 'driver'].includes(currentRole) && event.parkingLink) {
        
        parkingBtn = `
            <a href="${event.parkingLink}" target="_blank" class="w-10 h-10 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center shadow-sm active:scale-95 transition pointer-events-auto shrink-0" onclick="event.stopPropagation()">
                <i class="fa-solid fa-square-parking text-xl"></i>
            </a>`;
    }
    // â˜…â˜…â˜… çµæŸ â˜…â˜…â˜…

    let navIconBtn = '';
    if (['spot', 'hotel', 'eat'].includes(event.type)) {
        const targetUrl = event.navLink ? event.navLink : `https://www.google.com/maps/search/?api=1&query=${event.title}+æ²–ç¹©`;
        navIconBtn = `<a href="${targetUrl}" target="_blank" class="w-10 h-10 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center shadow-sm active:scale-95 transition pointer-events-auto shrink-0" onclick="event.stopPropagation()"><i class="fa-solid fa-location-arrow text-sm"></i></a>`;
    }

    const hasHiddenDetails = event.title_detail || event.bookingInfo || event.multiMaps || event.mapCode || event.adminNote;
    
    let clickAction = '';
    let cursorClass = ''; 
    
    if (['eat', 'spot'].includes(event.type)) {
        clickAction = `onclick="openDetailModal(${dayIdx}, ${evtIdx})"`;
        cursorClass = 'cursor-pointer active:scale-[0.99] transition';
    } else if (hasHiddenDetails) {
        clickAction = `onclick="toggleCard(this)"`;
        cursorClass = 'cursor-pointer active:scale-[0.99] transition';
    }

    return `
        <div class="card p-4 ${cursorClass}" ${clickAction}>
            <div class="flex items-start gap-3 pointer-events-none">
                <div class="flex flex-col items-center min-w-[60px] pt-1 shrink-0">
                    ${timeHtml}
                    <span class="text-[10px] px-2 py-0.5 rounded-full ${tagClass} mt-2 w-full text-center truncate">${tagName}</span>
                </div>
                <div class="flex-1 min-w-0">
                    <div class="flex justify-between items-start gap-2">
                        <div class="min-w-0">
                            <h3 class="font-bold text-lg text-gray-800 leading-tight">${event.title}</h3>
                            ${event.appLink ? `<a href="${event.appLink.url}" class="mt-1 inline-block bg-black text-white px-2 py-1 rounded text-xs font-bold shadow active:scale-95 transition pointer-events-auto" onclick="event.stopPropagation()"><i class="${event.appLink.icon} mr-1"></i> ${event.appLink.text}</a>` : ''}
                        </div>
                        <div class="flex gap-2 shrink-0">
                            ${parkingBtn}
                            ${navIconBtn}
                        </div>
                    </div>
                    <div class="mt-3">
                        ${previewContent}
                        ${voucherBtn}
                    </div>
                </div>
            </div>
            ${hasHiddenDetails ? `
            <div class="details-content mt-4 pt-4 border-t border-gray-100 space-y-4">
                ${event.title_detail ? `<h4 class="font-bold text-gray-800 text-lg">${event.title_detail}</h4>` : ''}
                ${event.bookingInfo ? `<div class="ticket-box"><div class="text-sm opacity-70">é ç´„æ†‘è­‰ / è¨‚å–®è™Ÿ</div><div class="text-2xl font-bold font-mono my-1 select-all">${event.bookingInfo.code}</div><div class="text-sm flex justify-between"><span>${event.bookingInfo.note}</span><span>${event.bookingInfo.extra || ''}</span></div></div>` : ''}
                ${event.multiMaps ? `<div class="grid grid-cols-2 gap-3">${event.multiMaps.map(m => `<a href="https://www.google.com/maps/search/?api=1&query=${m.query}" target="_blank" class="bg-blue-50 text-blue-600 py-3 rounded-xl text-center font-bold shadow-sm border border-blue-100 active:scale-95 transition"><i class="fa-solid fa-location-arrow mr-1"></i> ${m.name}</a>`).join('')}</div>` : ''}
                ${event.mapCode ? `<div class="bg-gray-50 p-3 rounded-lg"><div class="flex justify-between items-center"><span class="text-sm font-bold text-gray-600">MapCode</span><div class="flex items-center gap-2"><span class="font-mono text-xl font-bold">${event.mapCode}</span><button onclick="copyText('${event.mapCode}', event)" class="text-orange-500"><i class="fa-regular fa-copy"></i></button></div></div>${event.parking ? `<div class="mt-2 text-xs text-gray-500"><i class="fa-solid fa-square-parking"></i> ${event.parking.info}</div>` : ''}</div>` : ''}
                ${event.adminNote ? `<div class="text-sm text-gray-600 bg-yellow-50 p-2 rounded border border-yellow-100"><i class="fa-solid fa-pen mr-1"></i> ç­†è¨˜: ${event.adminNote}</div>` : ''}
            </div>` : ''}
        </div>`;
}

        function getPackingListHTML() {
            const packingList = getPackingList();
            const doneCount = packingList.filter(i => i.done).length;
            const totalCount = packingList.length;
            const progressPercent = Math.round((doneCount / totalCount) * 100);
            const itemsHtml = packingList.map(item => {
                let badgeColor = "bg-gray-100 text-gray-500"; if(item.category === 'é‡è¦') badgeColor = "bg-red-100 text-red-600 font-bold";
                return `<div class="flex items-center gap-3 p-2 rounded hover:bg-teal-50 transition cursor-pointer border-b border-gray-50 last:border-0" onclick="togglePacking('${item.id}')"><div class="w-5 h-5 flex-shrink-0 rounded border-2 border-teal-400 flex items-center justify-center ${item.done ? 'bg-teal-400' : 'bg-white'}">${item.done ? '<i class="fa-solid fa-check text-white text-xs"></i>' : ''}</div><div class="flex-1"><span class="text-[10px] px-1.5 py-0.5 rounded ${badgeColor} mr-1">${item.category}</span><span class="text-sm ${item.done ? 'text-gray-400 line-through' : 'text-gray-700 font-medium'}">${item.text}</span></div></div>`;
            }).join('');
            return `<div class="card p-5 mb-6 border-l-4 border-teal-500 shadow-lg bg-white"><div class="flex justify-between items-end mb-2"><h3 class="font-bold text-teal-700"><i class="fa-solid fa-list-check mr-2"></i>è¡Œææ¸…å–®</h3><span class="text-xs font-bold text-teal-600">${doneCount}/${totalCount} (${progressPercent}%)</span></div><div class="w-full bg-gray-200 rounded-full h-2 mb-3"><div class="bg-teal-500 h-2 rounded-full transition-all duration-500" style="width: ${progressPercent}%"></div></div><div class="grid grid-cols-1 gap-2 max-h-[240px] overflow-y-auto pr-1">${itemsHtml}</div></div>`;
        }

        // --- Modals & Actions ---
        function openEditShopModal(key = null) {
            const isEdit = !!key;
            let item = {};
            if (isEdit) {
                if(db) {
                    db.ref('shoppingList/' + key).once('value').then(snapshot => { renderShopModalHTML(key, snapshot.val()); openModal('modal-shopping'); });
                    return;
                } else {
                    const index = parseInt(key.split('_')[1]);
                    const localData = JSON.parse(localStorage.getItem(SHOPPING_KEY));
                    item = localData[index];
                }
            }
            renderShopModalHTML(key, item);
            openModal('modal-shopping');
        }

        function renderShopModalHTML(key, item = {}) {
            const modalSheet = document.querySelector('#modal-shopping .modal-sheet');
            modalSheet.innerHTML = `<div class="flex justify-between items-center mb-4"><h3 class="text-xl font-bold text-gray-700" id="shop-modal-title">${key ? 'ç·¨è¼¯å•†å“' : 'æ–°å¢å¿…è²· & æ¯”åƒ¹'}</h3><button onclick="closeModal('modal-shopping')" class="text-gray-400"><i class="fa-solid fa-xmark text-xl"></i></button></div><input type="hidden" id="in-shop-key" value="${key || ''}"><input id="in-shop-img" placeholder="åœ–ç‰‡é€£çµ URL æˆ– æª”å (é¸å¡«)" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200 text-sm mb-2" value="${item.imgUrl || ''}"><div class="grid grid-cols-3 gap-2 mb-2">
            <select id="in-shop-cat" class="p-3 bg-white rounded-xl border border-orange-200 font-bold text-gray-700">
                ${['ğŸ’Šè—¥å¦','ğŸªé›¶é£Ÿ','ğŸŸï¸é–€ç¥¨','ğŸ”Œé›»å™¨','ğŸ‘šè¡£ç‰©','ğŸ§ºé›œè²¨'].map(c => `<option value="${c}" ${item.category===c?'selected':''}>${c}</option>`).join('')}
            </select>
            
            <div class="col-span-2 relative">
                <!-- å•†åº—åœ–ç¤º -->
                <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none text-gray-400">
                    <i class="fa-solid fa-store"></i>
                </div>
                <!-- è¼¸å…¥æ¡† (åŠ ä¸Š pl-10 ç•™ä½ç½®çµ¦åœ–ç¤º) -->
                <input id="in-shop-store" placeholder="å•†åº— (å¦‚: å¤§åœ‹)" class="w-full p-3 pl-10 bg-gray-50 rounded-xl border border-gray-200" value="${item.store || ''}">
            </div>
        </div><input id="in-shop-item" placeholder="å“å (å¦‚: åˆåˆ©ä»–å‘½)" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200 mb-2" value="${item.item || ''}"><div class="grid grid-cols-2 gap-3 bg-blue-50 p-3 rounded-xl border border-blue-100 mb-2"><div><label class="text-xs text-gray-500 font-bold">ğŸ‡¹ğŸ‡¼ å°ç£å”®åƒ¹</label><input id="in-shop-tw" type="number" placeholder="NT$" class="w-full p-2 bg-white rounded border border-blue-200 mt-1" value="${item.priceTw || ''}"></div><div><label class="text-xs text-gray-500 font-bold">ğŸ‡¯ğŸ‡µ æ—¥æœ¬å”®åƒ¹</label><input id="in-shop-jp" type="number" placeholder="Â¥" class="w-full p-2 bg-white rounded border border-blue-200 mt-1" value="${item.priceJp || ''}"></div><div class="col-span-2 text-center text-xs text-blue-500 pt-1">è¼¸å…¥æ—¥æœ¬åƒ¹æ ¼è‡ªå‹•è¨ˆç®—åŒ¯ç‡ (${JPY_RATE})</div></div><textarea id="in-shop-note" placeholder="å‚™è¨»ï¼šè¦æ ¼ã€ä»£è²·äººã€ç´°ç¯€ (ä¸æœƒé¡¯ç¤ºåœ¨å¡ç‰‡ä¸Š)" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200 text-sm h-20 mb-2 resize-none">${item.note || ''}</textarea><button onclick="saveShopItem()" class="w-full bg-pink-500 text-white font-bold py-3 rounded-xl shadow-lg mt-2">å„²å­˜</button>`;
        }

        function saveShopItem() {
            const key = document.getElementById('in-shop-key').value;
            const newItem = {
                imgUrl: document.getElementById('in-shop-img').value,
                category: document.getElementById('in-shop-cat').value,
                store: document.getElementById('in-shop-store').value,
                item: document.getElementById('in-shop-item').value,
                priceTw: document.getElementById('in-shop-tw').value,
                priceJp: document.getElementById('in-shop-jp').value,
                note: document.getElementById('in-shop-note').value,
                done: false, addedBy: currentRole, timestamp: Date.now()
            };
            
            if(!newItem.item) return alert("è«‹è‡³å°‘è¼¸å…¥å“å");

            if(db) {
                if(key) { delete newItem.done; db.ref('shoppingList/' + key).update(newItem); }
                else { db.ref('shoppingList').push(newItem); }
            } else {
                const localData = JSON.parse(localStorage.getItem(SHOPPING_KEY)) || [];
                if(key) { const index = parseInt(key.split('_')[1]); newItem.done = localData[index].done; localData[index] = { ...localData[index], ...newItem }; }
                else { localData.push(newItem); }
                localStorage.setItem(SHOPPING_KEY, JSON.stringify(localData));
                renderShopping();
            }
            closeModal('modal-shopping');
        }

        function updateShopPrice(key, newPrice) {
            if(db) { db.ref('shoppingList/' + key).update({ priceJp: newPrice }); } 
            else { const index = parseInt(key.split('_')[1]); const localData = JSON.parse(localStorage.getItem(SHOPPING_KEY)); localData[index].priceJp = newPrice; localStorage.setItem(SHOPPING_KEY, JSON.stringify(localData)); renderShopping(); }
        }

        function toggleShopItem(key) { 
            if(db) { db.ref('shoppingList/' + key).once('value').then(snapshot => { const current = snapshot.val().done; db.ref('shoppingList/' + key).update({ done: !current }); }); } 
            else { const index = parseInt(key.split('_')[1]); const localData = JSON.parse(localStorage.getItem(SHOPPING_KEY)); localData[index].done = !localData[index].done; localStorage.setItem(SHOPPING_KEY, JSON.stringify(localData)); renderShopping(); } 
        }

        function deleteShopItem(key) { 
            if(confirm("åˆªé™¤æ­¤é …ç›®ï¼Ÿ")) { 
                if(db) db.ref('shoppingList/' + key).remove(); 
                else { const index = parseInt(key.split('_')[1]); const localData = JSON.parse(localStorage.getItem(SHOPPING_KEY)); localData.splice(index, 1); localStorage.setItem(SHOPPING_KEY, JSON.stringify(localData)); renderShopping(); } 
            } 
        }

        // --- Budget Modal & Logic ---
        function openBudgetModal(key = null) {
            const isEdit = !!key;
            let editData = {};
            if (isEdit) {
                if(db) { db.ref('expenses/' + key).once('value').then(snapshot => { fillAndShowBudgetModal(key, snapshot.val()); }); return; }
                else { const index = parseInt(key.split('_')[1]); const localData = JSON.parse(localStorage.getItem(EXPENSE_KEY)); editData = localData[index]; fillAndShowBudgetModal(key, editData); return; }
            }
            const now = new Date(); now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            const defaultData = { fullTime: now.toISOString().slice(0,16), category: 'é£Ÿç‰©', payment: 'ç¾é‡‘', qty: 1, currency: 'JPY', payer: FAMILY_MEMBERS.find(m => m.id === currentRole)?.name || 'å§Šå§Š' };
            fillAndShowBudgetModal(null, defaultData);
        }

       function fillAndShowBudgetModal(key, data) {
    const modalSheet = document.querySelector('#modal-budget .modal-sheet');
    const splitMethod = data.splitMethod || 'equal';
    
    // â˜… é—œéµä¿®æ”¹ï¼šå¼·åˆ¶æ”¹è®Š Modal çš„ CSSï¼Œä½¿å…¶æ”¯æ´ã€Œç½®åº•å€å¡Šã€
    // ç§»é™¤é è¨­ paddingï¼Œæ”¹ç”±å…§éƒ¨å€å¡Šæ§åˆ¶ï¼Œä¸¦è¨­å®š Flex ä½ˆå±€
    modalSheet.style.padding = '0'; 
    modalSheet.style.display = 'flex';
    modalSheet.style.flexDirection = 'column';
    modalSheet.style.overflow = 'hidden'; // é˜²æ­¢å¤–å±¤æ²å‹•
    modalSheet.style.maxHeight = '90vh';  // é™åˆ¶é«˜åº¦

    modalSheet.innerHTML = `
        <!-- 1. å›ºå®šé é¦– (Header) -->
        <div class="px-5 pt-5 pb-2 flex justify-between items-center shrink-0 bg-white z-10">
            <h3 class="text-xl font-bold text-gray-700">${key ? 'ç·¨è¼¯æ”¯å‡º' : 'è¨˜ä¸€ç­†æ”¯å‡º'}</h3>
            <button onclick="closeModal('modal-budget')" class="text-gray-400"><i class="fa-solid fa-xmark text-xl"></i></button>
        </div>
        
        <input type="hidden" id="in-ex-key" value="${key || ''}">
        
        <!-- 2. å¯æ²å‹•å…§å®¹å€ (Body) -->
        <div class="flex-1 overflow-y-auto px-5 pb-4" style="overscroll-behavior: contain;">
            
            <div class="bg-gray-50 p-2 rounded-xl border border-gray-200 mb-3">
                <label class="text-xs text-gray-500 font-bold ml-1">æ—¥æœŸèˆ‡æ™‚é–“</label>
                <input id="in-ex-time" type="datetime-local" class="w-full bg-transparent font-bold text-gray-700 outline-none mt-1" value="${data.fullTime || ''}">
            </div>

            <div class="grid grid-cols-2 gap-2 mb-3">
                <select id="in-ex-category" class="p-3 bg-white rounded-xl border border-orange-200 text-gray-700 font-bold">
                    ${['é£Ÿç‰©','è³¼ç‰©','äº¤é€š','é–€ç¥¨','å…¶ä»–'].map(c => `<option value="${c}" ${data.category===c?'selected':''}>${c}</option>`).join('')}
                </select>
                <select id="in-ex-payer" class="p-3 bg-white rounded-xl border border-blue-200 text-blue-800 font-bold">
                    ${FAMILY_MEMBERS.map(m => `<option value="${m.name}" ${data.payer===m.name?'selected':''}>ä»˜æ¬¾: ${m.name}</option>`).join('')}
                </select>
            </div>

            <input id="in-ex-store" placeholder="å•†åº—/é¤å»³ (é¸å¡«)" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200 mb-2" value="${data.store || ''}">
            <input id="in-ex-item" placeholder="å“å/å…§å®¹" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200 mb-2" value="${data.item || ''}">

            <div class="grid grid-cols-3 gap-2 mb-2">
                <div class="col-span-2 relative">
                     <input id="in-ex-price" type="number" placeholder="å–®åƒ¹" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200 font-bold text-lg" value="${data.priceJp || ''}">
                     <span class="absolute right-3 top-3 text-gray-400 text-xs">å–®åƒ¹</span>
                </div>
                <select id="in-ex-currency" class="p-3 bg-gray-50 rounded-xl border border-gray-200 text-gray-700 font-bold">
                    <option value="JPY" ${data.currency!=='TWD'?'selected':''}>Â¥ JPY</option>
                    <option value="TWD" ${data.currency==='TWD'?'selected':''}>$ TWD</option>
                </select>
            </div>

            <div class="grid grid-cols-2 gap-3 mb-3">
                <div class="flex items-center gap-2">
                    <button class="qty-btn" onclick="adjustQty(-1)">-</button>
                    <input id="in-ex-qty" type="number" value="${data.qty || 1}" class="w-full p-3 text-center bg-gray-50 rounded-xl border border-gray-200" readonly>
                    <button class="qty-btn" onclick="adjustQty(1)">+</button>
                </div>
                <select id="in-ex-pay" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200 text-gray-700">
                    ${['ç¾é‡‘','ä¿¡ç”¨å¡','Suica/ICå¡'].map(p => `<option value="${p}" ${data.payment===p?'selected':''}>${p}</option>`).join('')}
                </select>
            </div>
            
            <div class="mb-2">
                <input id="in-ex-receipt" placeholder="æ†‘è­‰åœ–ç‰‡ç¶²å€ (URL)" class="w-full p-2 bg-gray-50 rounded-lg border border-gray-200 text-sm" value="${data.receiptUrl || ''}">
            </div>

            <div class="mb-3">
                 <textarea id="in-ex-note" placeholder="å‚™è¨»ï¼šç´°ç¯€ã€å¿ƒæƒ…" class="w-full p-3 bg-gray-50 rounded-xl border border-gray-200 text-sm h-16 resize-none">${data.note || ''}</textarea>
            </div>

            <div class="split-box mb-4">
                <div class="flex justify-between items-center mb-2">
                    <label class="font-bold text-gray-700 text-sm">åˆ†å¸³æ–¹å¼</label>
                    <select id="in-ex-split-method" onchange="renderSplitOptions()" class="text-xs border p-1 rounded bg-white">
                        <option value="equal" ${splitMethod==='equal'?'selected':''}>æŒ‰äººé ­å‡åˆ†</option>
                        <option value="amount" ${splitMethod==='amount'?'selected':''}>æŒ‡å®šé‡‘é¡</option>
                        <option value="none" ${splitMethod==='none'?'selected':''}>ä¸åˆ†å¸³(å€‹äºº)</option>
                    </select>
                </div>
                <div id="split-options-container" class="grid grid-cols-2 gap-2"></div>
            </div>
        </div>

        <!-- 3. å›ºå®šé å°¾ (Footer) - ç¸½é‡‘é¡èˆ‡æŒ‰éˆ• -->
        <div class="p-4 bg-white border-t border-gray-100 shrink-0 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] safe-area-bottom z-20">
            <div class="flex items-stretch gap-3">
                <!-- å·¦å´ï¼šç¸½é‡‘é¡é¡¯ç¤º -->
                <div class="flex-1 bg-orange-50 p-2 rounded-xl text-center border border-orange-100 flex flex-col justify-center">
                    <div class="text-[10px] text-gray-500 mb-0.5">ç¸½é‡‘é¡</div>
                    <div class="text-xl font-bold text-orange-600 leading-none">
                        <span id="lbl-currency">${data.currency==='TWD'?'$':'Â¥'}</span><span id="calc-total">0</span>
                    </div>
                    <div id="calc-convert-hint" class="text-[10px] font-bold text-blue-500 mt-0.5 ${data.currency==='TWD'?'hidden':''}">
                        â‰ˆ NT$<span id="calc-twd">0</span>
                    </div>
                </div>

                <!-- å³å´ï¼šå„²å­˜æŒ‰éˆ• -->
                <button onclick="saveExpense()" class="flex-1 bg-orange-500 text-white font-bold py-2 rounded-xl shadow-lg text-lg flex items-center justify-center active:scale-95 transition">
                    ${key ? 'æ›´æ–°ç´€éŒ„' : 'å„²å­˜ç´€éŒ„'}
                </button>
            </div>
        </div>
    `;

    openModal('modal-budget');
    
    // åˆå§‹åŒ–åˆ†å¸³ UI
    renderSplitOptions(data.splitDetails);
    
    // ç¶å®šäº‹ä»¶
    const priceEl = document.getElementById('in-ex-price');
    const qtyEl = document.getElementById('in-ex-qty');
    const currEl = document.getElementById('in-ex-currency');

    if (priceEl) priceEl.addEventListener('input', updateCalc);
    if (qtyEl) qtyEl.addEventListener('input', updateCalc);
    if (currEl) currEl.addEventListener('change', () => {
        document.getElementById('lbl-currency').innerText = currEl.value === 'TWD' ? '$' : 'Â¥';
        document.getElementById('calc-convert-hint').classList.toggle('hidden', currEl.value === 'TWD');
        updateCalc();
    });

    updateCalc();
}

// --- 2. è‡ªå‹•è¨ˆç®—ç¸½é¡ (ä¿®æ­£ç‰ˆ) ---
function updateCalc() {
    const priceEl = document.getElementById('in-ex-price');
    const qtyEl = document.getElementById('in-ex-qty');
    
    if (!priceEl || !qtyEl) return; // é˜²æ­¢å…ƒç´ æ‰¾ä¸åˆ°å ±éŒ¯

    const p = parseInt(priceEl.value) || 0;
    const q = parseInt(qtyEl.value) || 1;
    const total = p * q;
    
    const totalEl = document.getElementById('calc-total');
    if (totalEl) totalEl.innerText = total.toLocaleString();
    
    // åŒ¯ç‡æ›ç®—é¡¯ç¤º
    const currency = document.getElementById('in-ex-currency').value;
    if (currency !== 'TWD') {
        const twdEl = document.getElementById('calc-twd');
        if (twdEl) twdEl.innerText = Math.round(total * JPY_RATE).toLocaleString();
    }
}

// --- 3. èª¿æ•´æ•¸é‡æŒ‰éˆ• (ä¿®æ­£ç‰ˆ) ---
function adjustQty(delta) {
    const input = document.getElementById('in-ex-qty');
    if (!input) return;
    
    let val = parseInt(input.value) || 1;
    val += delta;
    if (val < 1) val = 1;
    input.value = val;
    
    // â˜… ç›´æ¥å‘¼å« updateCalcï¼Œæ¯” dispatchEvent æ›´ç©©å®š
    updateCalc();
}

        function saveExpense() {
            const key = document.getElementById('in-ex-key').value;
            const category = document.getElementById('in-ex-category').value;
            const payer = document.getElementById('in-ex-payer').value;
            const store = document.getElementById('in-ex-store').value;
            const item = document.getElementById('in-ex-item').value;
            const price = parseInt(document.getElementById('in-ex-price').value);
            const qty = parseInt(document.getElementById('in-ex-qty').value);
            const currency = document.getElementById('in-ex-currency').value;
            const payment = document.getElementById('in-ex-pay').value;
            const fullTime = document.getElementById('in-ex-time').value;
            const receiptUrl = document.getElementById('in-ex-receipt').value;
            const note = document.getElementById('in-ex-note').value; 
            const splitMethod = document.getElementById('in-ex-split-method').value;

            if(!item || isNaN(price)) return alert("è«‹è¼¸å…¥æ­£ç¢ºçš„å“åå’Œé‡‘é¡");

            const totalAmount = price * qty;
            let splitDetails = [];

            if (splitMethod === 'equal') {
                const checks = document.querySelectorAll('#split-options-container input[type="checkbox"]:checked');
                if (checks.length > 0) { const perPerson = Math.round(totalAmount / checks.length); checks.forEach(chk => splitDetails.push({ name: chk.value, amount: perPerson })); } else { splitDetails.push({ name: payer, amount: totalAmount }); }
            } else if (splitMethod === 'amount') {
                const inputs = document.querySelectorAll('.split-amount-input');
                inputs.forEach(inp => { const val = parseInt(inp.value) || 0; if (val > 0) splitDetails.push({ name: inp.dataset.name, amount: val }); });
            } else { splitDetails.push({ name: payer, amount: totalAmount }); }

            const expenseData = { category, store, item, payer, currency, payment, receiptUrl, note, splitMethod, splitDetails, priceJp: price, qty, amount: totalAmount, date: fullTime.split('T')[0].replace(/-/g, '/'), fullTime, timestamp: Date.now() };

            if(db) { if(key) db.ref('expenses/' + key).update(expenseData); else db.ref('expenses').push(expenseData); } 
            else { const localData = JSON.parse(localStorage.getItem(EXPENSE_KEY)) || []; if(key) { const index = parseInt(key.split('_')[1]); localData[index] = expenseData; } else { localData.push(expenseData); } localStorage.setItem(EXPENSE_KEY, JSON.stringify(localData)); renderBudget(); }
            closeModal('modal-budget');
        }

        function renderSplitOptions(savedDetails = null) {
            const method = document.getElementById('in-ex-split-method').value;
            const container = document.getElementById('split-options-container');
            let html = '';
            if (method === 'equal') {
                FAMILY_MEMBERS.forEach(m => { const isChecked = savedDetails ? savedDetails.some(d => d.name === m.name) : true; html += `<div class="member-check ${isChecked ? 'active' : ''}" onclick="this.classList.toggle('active'); this.querySelector('input').checked = !this.querySelector('input').checked;"><input type="checkbox" value="${m.name}" class="hidden" ${isChecked ? 'checked' : ''}><i class="fa-solid ${isChecked ? 'fa-circle-check' : 'fa-circle'} text-xs"></i> ${m.name}</div>`; });
            } else if (method === 'amount') {
                FAMILY_MEMBERS.forEach(m => { const savedVal = savedDetails ? (savedDetails.find(d => d.name === m.name)?.amount || 0) : 0; html += `<div class="flex items-center gap-2 bg-white p-2 rounded border"><span class="text-xs font-bold w-8">${m.name}</span><input type="number" data-name="${m.name}" value="${savedVal}" placeholder="é‡‘é¡" class="split-amount-input w-full text-sm border-b outline-none text-right"></div>`; });
            } else { html = `<div class="col-span-2 text-xs text-gray-400 text-center py-2">è²»ç”¨å°‡å…¨é¡æ­¸æ–¼ä»˜æ¬¾äºº</div>`; }
            container.innerHTML = html;
        }

        function adjustQty(delta) { const input = document.getElementById('in-ex-qty'); let val = parseInt(input.value) || 1; val += delta; if(val < 1) val = 1; input.value = val; input.dispatchEvent(new Event('input')); }
        function deleteExpense(key) { if(confirm("åˆªé™¤æ­¤ç´€éŒ„ï¼Ÿ")) { if(db) { db.ref('expenses/' + key).remove(); } else { const index = parseInt(key.split('_')[1]); const localData = JSON.parse(localStorage.getItem(EXPENSE_KEY)) || []; localData.splice(index, 1); localStorage.setItem(EXPENSE_KEY, JSON.stringify(localData)); renderBudget(); } } }
        
        function getPackingList() { const stored = localStorage.getItem(PACKING_KEY); if (!stored) { localStorage.setItem(PACKING_KEY, JSON.stringify(defaultPackingList)); return defaultPackingList; } return JSON.parse(stored); }
        function togglePacking(id) { const list = getPackingList(); const item = list.find(i => i.id === id); if(item) { item.done = !item.done; localStorage.setItem(PACKING_KEY, JSON.stringify(list)); if(currentTab === 'home') renderHome(); if(currentTab === 'vouchers') renderVouchers(); } }
        function switchTab(tab) { 
    currentTab = tab; 
    
    // æ›´æ–°åº•éƒ¨å°èˆªæ¨£å¼
    document.querySelectorAll('.nav-item').forEach(btn => { 
        btn.classList.remove('active', 'text-orange-500'); 
        btn.classList.add('text-gray-400'); 
    }); 
    if (tab !== 'home') document.getElementById(`btn-${tab}`).classList.replace('text-gray-400', 'text-orange-500'); 
    
    // æ¸²æŸ“å…§å®¹
    if (tab === 'home') renderHome(); 
    if (tab === 'schedule') renderSchedule(); 
    if (tab === 'shopping') renderShopping(); 
    if (tab === 'budget') renderBudget(); 
    if (tab === 'vouchers') renderVouchers(); 
    
    // â˜… ä¿®æ”¹ï¼šåªæœ‰åœ¨ã€Œæ‰‹å‹•é»æ“Šåˆ‡æ›ã€æ™‚æ‰æ²åˆ°é ‚éƒ¨
    // æˆ‘å€‘é€éæª¢æŸ¥ sessionStorage æ˜¯å¦æœ‰å€¼ä¾†åˆ¤æ–·é€™æ˜¯ä¸æ˜¯ã€Œåˆ·æ–°å¾Œçš„è‡ªå‹•è¼‰å…¥ã€
    // ä½†æœ€ç°¡å–®çš„æ–¹å¼æ˜¯ï¼šç›´æ¥åœ¨é€™è£¡å¼·åˆ¶æ²å‹•åˆ°é ‚éƒ¨å³å¯ï¼Œ
    // å› ç‚º init() è£¡é¢çš„ setTimeout æœƒåœ¨é€™ä¸€è¡Œä¹‹å¾ŒåŸ·è¡Œï¼Œä¸¦æŠŠä½ç½®è“‹éå» (æ¢å¾©åˆ°åŸæœ¬ä½ç½®)
    window.scrollTo(0, 0); 
}
        function changeDate(index) { selectedDateIndex = index; renderSchedule(); }
        function toggleCard(element) { const details = element.querySelector('.details-content'); if(details) { details.style.display = details.style.display==='block'?'none':'block'; element.classList.toggle('card-active'); } }
        function copyText(text, e) { if(e) e.stopPropagation(); navigator.clipboard.writeText(text).then(() => alert("å·²è¤‡è£½")); }
        function toggleDevMode() { currentSimulatedDate = currentSimulatedDate ? null : "2025/12/26"; alert(currentSimulatedDate ? "æ¨¡æ“¬: 12/26" : "å›åˆ°ç¾åœ¨"); renderHome(); }
        function openTranslation() { document.getElementById('trans-modal').classList.remove('hidden'); document.getElementById('trans-modal').classList.add('flex'); }
        function closeTranslation() { document.getElementById('trans-modal').classList.add('hidden'); document.getElementById('trans-modal').classList.remove('flex'); }
        function openModal(id) { document.getElementById(id).classList.add('open'); }
        function closeModal(id) { document.getElementById(id).classList.remove('open'); }
        function openPdfModal(encodedContent) { const content = decodeURIComponent(encodedContent); const modal = document.getElementById('modal-pdf'); const body = document.getElementById('pdf-content'); let html = `<div class="pdf-header border-b-2 border-gray-800 pb-2 mb-4 flex justify-between items-end"><h2 class="text-xl font-bold text-gray-800">BOOKING CONFIRMATION</h2><div class="text-right text-xs text-gray-500">2025/11/27</div></div>`; content.split('\n').forEach(line => { if(line.includes('ï¼š')) { const [key, val] = line.split('ï¼š'); html += `<div class="mb-2"><div class="text-[10px] text-gray-500 uppercase">${key}</div><div class="font-bold text-gray-900">${val}</div></div>`; } else if(line.trim() === '') html += `<div class="h-4"></div>`; else html += `<div class="text-sm text-gray-700 mb-1">${line}</div>`; }); body.innerHTML = html; modal.classList.add('open'); }
        function closePdfModal() { document.getElementById('modal-pdf').classList.remove('open'); }
        function closeDetailModal() { document.getElementById('modal-detail').classList.remove('open'); }
        
        // --- æ†‘è­‰é è¦½ (ä¸‰å±¤ä¸é‡ç–Šç‰ˆ) ---
        function openVoucherImage(imgSrc) {
            const modal = document.getElementById('modal-pdf');
            const body = document.getElementById('pdf-content');
            
            // æ¸…ç©ºèˆŠæŒ‰éˆ• (å¦‚æœæœ‰çš„è©±)
            const oldBtn = document.querySelector('#modal-pdf .pdf-sheet > button');
            if (oldBtn) oldBtn.remove(); 

            const isGoogleDrive = imgSrc.includes('drive.google.com');
            let innerContent = '';
            let footerContent = '';

            if (isGoogleDrive) {
                const previewUrl = getDrivePreviewUrl(imgSrc);
                const fallbackUrl = previewUrl.replace('/preview', '/view');
                innerContent = `<iframe src="${previewUrl}" class="w-full h-full border-0 bg-gray-100" allow="autoplay" referrerpolicy="no-referrer"></iframe>`;
                footerContent = `<div class="p-3 bg-white border-t border-gray-200 safe-area-bottom"><a href="${fallbackUrl}" target="_blank" class="block w-full text-center bg-blue-600 text-white py-3 rounded-xl text-sm font-bold shadow hover:bg-blue-700 transition"><i class="fa-solid fa-external-link-alt mr-1"></i> é–‹å•ŸåŸå§‹æª”æ¡ˆ</a></div>`;
            } else {
                const finalSrc = imgSrc.startsWith('http') ? imgSrc : `./${imgSrc}`;
                innerContent = `<div class="w-full h-full bg-black flex items-center justify-center"><img src="${finalSrc}" class="max-w-full max-h-full object-contain"></div>`;
            }

            const finalHtml = `<div class="h-[50px] bg-white border-b border-gray-200 flex justify-between items-center px-4 shrink-0"><span class="font-bold text-gray-700">æ†‘è­‰é è¦½</span><button onclick="closePdfModal()" class="w-8 h-8 flex items-center justify-center bg-gray-100 rounded-full text-gray-600 hover:bg-gray-200"><i class="fa-solid fa-xmark text-lg"></i></button></div><div class="flex-1 relative overflow-hidden">${innerContent}</div>${footerContent}`;

            body.style.width = '100%';
            body.style.height = '100%';
            body.style.padding = '0';
            body.style.display = 'flex';
            body.style.flexDirection = 'column';
            body.innerHTML = finalHtml;
            modal.classList.add('open');
        }

        function openDetailModal(dayIdx, eventIdx, choiceIdx = null) {
    const modal = document.getElementById('modal-detail');
    const content = document.getElementById('modal-detail-content');
    
    // 1. å–å¾—è³‡æ–™
    let event = tripData[dayIdx].events[eventIdx];
    if (choiceIdx !== null && event.choices) event = event.choices[choiceIdx];
    
    const img = event.imgUrl || 'https://via.placeholder.com/400x250?text=No+Image';
    const detail = event.detailInfo || {};
    
    // 2. æº–å‚™ HTML å…§å®¹è®Šæ•¸ (é€™äº›æ˜¯ä¹‹å‰å¯èƒ½éºå¤±çš„éƒ¨åˆ†)
    
    // æ¨™ç±¤
    let tagsHtml = ''; 
    if(detail.tags) detail.tags.forEach(t => tagsHtml += `<span class="bg-orange-100 text-orange-600 text-xs px-2 py-1 rounded-full mr-1">#${t}</span>`);
    
    // äº®é»
    let highlightHtml = ''; 
    if(detail.highlights) highlightHtml = `<div class="mt-4"><h4 class="font-bold text-gray-800 mb-2">âœ¨ å¿…çœ‹äº®é»</h4><ul class="list-disc list-inside text-sm text-gray-600 space-y-1">${detail.highlights.map(h => `<li>${h}</li>`).join('')}</ul></div>`;
    
    // èœå–®
    let menuHtml = '';
    if(detail.menu) {
        const menuItems = detail.menu.map(m => {
            const jpText = m.j ? m.j : m.n; 
            const clickAction = `onclick="openOrderCard('${m.n}', '${jpText}')"`;
            return `<div class="flex justify-between items-center bg-gray-50 p-3 rounded-lg active:bg-gray-200 transition cursor-pointer" ${clickAction}><div class="flex items-center gap-2 overflow-hidden"><i class="fa-regular fa-hand-pointer text-gray-300 text-xs shrink-0"></i><span class="font-bold text-gray-700 text-sm truncate">${m.n}</span></div><span class="text-orange-500 text-sm font-bold shrink-0">${m.p || ''}</span></div>`;
        }).join('');
        menuHtml = `<div class="mt-4"><h4 class="font-bold text-gray-800 mb-2">ğŸ‘©â€ğŸ³ æ¨è–¦èœå–® (é»æ“Šé¡¯ç¤ºæ—¥æ–‡)</h4><div class="grid grid-cols-1 gap-2">${menuItems}</div></div>`;
    }

    // æŒ‰éˆ•
    const reviewUrl = event.reviewLink || event.navLink || `https://www.google.com/maps/search/?api=1&query=${event.title}+æ²–ç¹©`;
    let infoBtnHtml = '';
    if (event.link) {
        const isTabelog = event.link.includes('tabelog');
        const btnText = isTabelog ? 'Tabelog é£Ÿè¨˜' : 'å®˜æ–¹ç¶²ç«™';
        const btnIcon = isTabelog ? 'fa-solid fa-utensils' : 'fa-solid fa-globe';
        const btnClasses = isTabelog ? 'bg-orange-500 text-white shadow-orange-200' : 'bg-gray-100 text-gray-700 border-gray-200';
        infoBtnHtml = `<a href="${event.link}" target="_blank" class="flex-1 ${btnClasses} py-3 rounded-xl font-bold shadow-lg active:scale-95 transition text-center flex items-center justify-center gap-2"><i class="${btnIcon}"></i> ${btnText}</a>`;
    } else {
        infoBtnHtml = `<div class="flex-1"></div>`; 
    }

    // 3. çµ„åˆ HTML (åŒ…å«ç½®é ‚ Header)
    content.innerHTML = `
        <!-- 1. ç½®é ‚å°è¦½åˆ— (é è¨­é€æ˜) -->
        <div id="detail-sticky-header" class="detail-sticky-header">
            <span class="detail-sticky-title">${event.title}</span>
        </div>

        <!-- 2. ä¸‹æ»‘æŠŠæ‰‹ -->
        <div class="detail-handle" onclick="closeDetailModal()"></div>
        
        <!-- 3. é—œé–‰æŒ‰éˆ• -->
        <button class="detail-close-btn" onclick="closeDetailModal()"><i class="fa-solid fa-xmark"></i></button>
        
        <!-- 4. å…§å®¹å€å¡Š (æ²å‹•å€) -->
        <div class="detail-body" id="detail-scroll-view">
            <!-- åœ–ç‰‡ (åœ¨æ²å‹•å€å…§) -->
            <img src="${img}" class="w-full h-[250px] object-cover block">
            
            <!-- æ–‡å­—å®¹å™¨ -->
            <div class="detail-text-container">
                <div class="flex items-center gap-2 mb-1">
                    ${tagsHtml}
                </div>
                <h2 class="text-2xl font-bold text-gray-800 mb-3">${event.title}</h2>
                
                <!-- â˜…â˜…â˜… ä¿®æ”¹é€™è£¡ï¼šåªé¡¯ç¤ºè©³ç´°ä»‹ç´¹ (detail.desc)ï¼Œä¸å†é¡¯ç¤º guide â˜…â˜…â˜… -->
                <!-- åŸæœ¬æ˜¯ï¼š<p ...>${detail.desc || event.guide || 'æš«ç„¡è©³ç´°ä»‹ç´¹'}</p> -->
                <!-- ç¾åœ¨æ”¹æˆï¼šå¦‚æœæœ‰è©³ç´°ä»‹ç´¹æ‰é¡¯ç¤ºï¼Œå¦å‰‡ç•™ç©º -->
                ${detail.desc ? `<p class="text-gray-600 text-sm leading-relaxed">${detail.desc}</p>` : ''}
                
                ${highlightHtml}
                ${menuHtml}
            </div>
        </div>

        <!-- 5. åº•éƒ¨æŒ‰éˆ•å€ -->
        <div class="p-4 bg-white border-t border-gray-100 shrink-0 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)] safe-area-bottom z-20">
            <div class="flex gap-3">
                ${infoBtnHtml}
                <a href="${reviewUrl}" target="_blank" class="flex-1 bg-blue-600 text-white py-3 rounded-xl text-center font-bold shadow-lg active:scale-95 transition flex items-center justify-center gap-2">
                    <i class="fa-solid fa-comments"></i> Google è©•è«–
                </a>
            </div>
        </div>`;
        
    // 4. é–‹å•Ÿè¦–çª—
    modal.classList.add('open');

    // 5. ç¶å®šæ²å‹•äº‹ä»¶ (Scroll Listener)
    const scrollView = document.getElementById('detail-scroll-view');
    const stickyHeader = document.getElementById('detail-sticky-header');
    const threshold = 190; // è§¸ç™¼é–€æª» (åœ–ç‰‡é«˜åº¦ - Headeré«˜åº¦)

    if (scrollView && stickyHeader) {
        scrollView.onscroll = function() {
            if (this.scrollTop > threshold) {
                stickyHeader.classList.add('visible');
            } else {
                stickyHeader.classList.remove('visible');
            }
        };
    }
}

// --- é–‹å•Ÿé»é¤å­—å¡ ---
function openOrderCard(cnName, jpName) {
    const modal = document.getElementById('modal-order-card');
    const elCn = document.getElementById('card-cn');
    const elJp = document.getElementById('card-jp');
    
    elCn.innerText = cnName;
    // å¦‚æœæ²’æœ‰æ—¥æ–‡ï¼Œå°±é¡¯ç¤ºä¸­æ–‡ (æˆ–é¡¯ç¤ºæç¤º)
    elJp.innerText = jpName || cnName;
    
    // å¦‚æœæ—¥æ–‡å¤ªé•·ï¼Œç¸®å°å­—é«”
    if (elJp.innerText.length > 10) {
        elJp.classList.replace('text-3xl', 'text-2xl');
    } else {
        elJp.classList.replace('text-2xl', 'text-3xl');
    }

    modal.classList.remove('hidden');
    modal.classList.add('flex');
}

function closeOrderCard() {
    const modal = document.getElementById('modal-order-card');
    modal.classList.add('hidden');
    modal.classList.remove('flex');
}

// --- æ›´æ–°å¤©æ°£è³‡è¨Š (ä¿®æ­£ç‰ˆï¼šè§£æ±ºæ™‚å€èˆ‡è·¨æ—¥å•é¡Œ) ---
async function updateWeatherUI() {
    const container = document.getElementById('weather-scroll'); 
    const sunsetEl = document.getElementById('sunset-time'); 
    if(!container) return;

    try {
        // 1. è«‹æ±‚ 2 å¤©çš„è³‡æ–™ä»¥å…è·¨æ—¥æ²’æ•¸æ“šï¼Œä¸¦æŒ‡å®šæ™‚å€ç‚ºæ±äº¬
        const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=26.2124&longitude=127.6809&current=temperature_2m,weather_code&hourly=temperature_2m,weather_code&daily=sunset&timezone=Asia%2FTokyo&forecast_days=2');
        
        if (!res.ok) throw new Error("Network response was not ok");

        const data = await res.json();

        // 2. æ—¥è½æ™‚é–“ (ç›´æ¥è§£æå­—ä¸²ï¼Œé¿å…æ™‚å€è½‰æ›èª¤å·®)
        if (data.daily && data.daily.sunset && data.daily.sunset[0]) {
            const sunsetRaw = data.daily.sunset[0];
            const sunsetTime = sunsetRaw.split('T')[1]; // å–å¾— "17:34"
            if(sunsetEl) sunsetEl.innerHTML = `<i class="fa-solid fa-cloud-sun"></i> æ—¥è½ ${sunsetTime}`;
        }

        // 3. å°‹æ‰¾èµ·å§‹æ™‚é–“ (ä½¿ç”¨ API çš„ current.time ä¾†å°æ‡‰ hourly)
        const currentIsoTime = data.current.time; // "2025-12-05T14:00"
        
        // æ‰¾ hourly é™£åˆ—ä¸­ç¬¦åˆç•¶å‰æ™‚é–“çš„ç´¢å¼•
        let startIndex = data.hourly.time.indexOf(currentIsoTime);

        // å¦‚æœå‰›å¥½æœ‰å¹¾åˆ†é˜èª¤å·®æ‰¾ä¸åˆ° (APIæœ‰æ™‚æœƒæœ‰é²å»¶)ï¼Œæ”¹ç”¨å°æ™‚å­—ä¸²æ¯”å°
        if (startIndex === -1) {
            const currentHourStr = currentIsoTime.substring(0, 13); // "2025-12-05T14"
            startIndex = data.hourly.time.findIndex(t => t.startsWith(currentHourStr));
        }

        // å¦‚æœé‚„æ˜¯æ‰¾ä¸åˆ° (æ¥µç«¯æƒ…æ³)ï¼Œé è¨­å¾é ­é–‹å§‹ï¼Œé¿å…ç¨‹å¼å´©æ½°
        if (startIndex === -1) startIndex = 0;

        let html = '';
        // é¡¯ç¤ºæœªä¾† 12 å°æ™‚
        for(let i = startIndex; i < startIndex + 12; i++) { 
            if(!data.hourly.time[i]) break;
            
            // ç›´æ¥åˆ‡å‰²å­—ä¸²å–å¾— "HH:00"
            const timeRaw = data.hourly.time[i]; // "2025-12-05T15:00"
            const timeDisplay = timeRaw.split('T')[1]; // "15:00"

            const temp = Math.round(data.hourly.temperature_2m[i]);
            const code = data.hourly.weather_code[i];
            
            // å¤©æ°£åœ–ç¤ºåˆ¤æ–·
            let icon = 'â˜€ï¸';
            if(code >= 1 && code <= 3) icon = 'â˜ï¸'; 
            else if(code >= 45 && code <= 48) icon = 'ğŸŒ«ï¸'; 
            else if(code >= 51 && code <= 67) icon = 'ğŸŒ§ï¸'; 
            else if(code >= 71 && code <= 77) icon = 'â„ï¸'; 
            else if(code >= 80 && code <= 82) icon = 'ğŸŒ¦ï¸'; 
            else if(code >= 95) icon = 'â›ˆï¸';

            html += `<div class="flex flex-col items-center min-w-[50px] snap-start">
                        <span class="text-xs text-gray-400">${timeDisplay}</span>
                        <span class="text-xl my-1">${icon}</span>
                        <span class="text-sm font-bold text-gray-700">${temp}Â°</span>
                     </div>`;
        }
        container.innerHTML = html;

    } catch(e) { 
        console.error("Weather Error:", e);
        container.innerHTML = '<div class="text-xs text-red-400 py-2">æš«æ™‚ç„¡æ³•å–å¾—å¤©æ°£</div>'; 
    }
}

        
        // --- ç›£è½é é¢åˆ·æ–°/é—œé–‰ï¼Œå„²å­˜ç•¶å‰ç‹€æ…‹ ---
window.addEventListener('beforeunload', () => {
    sessionStorage.setItem('lastTab', currentTab);
    sessionStorage.setItem('lastDateIdx', selectedDateIndex);
    sessionStorage.setItem('lastScrollY', window.scrollY);
});
        
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
